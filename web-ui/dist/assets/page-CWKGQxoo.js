import{r as i,R as Ya,j as e}from"./index-p-H4rLgw.js";import{c as ee,k as Za,G as q,i as me,P as en,B as tn,S as fo,d as go,b as v,M as wo,m as ns,h as nt,n as jo,l as kn,f as sn,F as rt}from"./Sidebar-Ch_JQZr9.js";import{C as vo,F as an,P as nn}from"./index-iGQCOOIm.js";import{C as ue}from"./circle-alert-lIw67IBz.js";import{L as yo}from"./layout-panel-left-Sq16s4zz.js";import{R as on}from"./refresh-cw-uy5mI12M.js";import{M as rn}from"./minimize-2-Duauih7z.js";import{E as ln}from"./external-link-RWChbr3S.js";import{L as C}from"./loader-circle-BoRSmyHv.js";import{C as Zt}from"./code-xml-z34C7C5b.js";import{X as cn}from"./x-BSsjDSLk.js";import{C as es}from"./chevron-down-Bdy6QuAS.js";import{C as Cn}from"./clock-sF8qgG2X.js";import{M as dn,r as xn}from"./index-CRZvwgZ2.js";import{h as mn}from"./prism-gWKxzDo9.js";import{E as No}from"./eye-DsXKYpZU.js";import{T as ko}from"./tag-DPvNJVhV.js";import{T as Co}from"./trash-2-DgLAXw8o.js";import{A as un}from"./arrow-up-right-oJ9AoX2G.js";import{C as lt}from"./circle-check-DvXbhfrb.js";import{C as Re}from"./circle-x-Bvc3LIQJ.js";/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],So=ee("clipboard",_o);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],ts=ee("git-commit-horizontal",$o);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],os=ee("git-merge",Po);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ss=ee("message-square",Ro);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],pn=ee("package-open",To);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],hn=ee("scale",Lo);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ot=ee("star",Bo),bn={'pre[class*="language-"]':{color:"#d4d4d4",fontSize:"13px",textShadow:"none",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",padding:"1em",margin:".5em 0",overflow:"auto",background:"#1e1e1e"},'code[class*="language-"]':{color:"#d4d4d4",fontSize:"13px",textShadow:"none",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]::selection':{textShadow:"none",background:"#264F78"},'code[class*="language-"]::selection':{textShadow:"none",background:"#264F78"},'pre[class*="language-"] *::selection':{textShadow:"none",background:"#264F78"},'code[class*="language-"] *::selection':{textShadow:"none",background:"#264F78"},':not(pre) > code[class*="language-"]':{padding:".1em .3em",borderRadius:".3em",color:"#db4c69",background:"#1e1e1e"},".namespace":{Opacity:".7"},"doctype.doctype-tag":{color:"#569CD6"},"doctype.name":{color:"#9cdcfe"},comment:{color:"#6a9955"},prolog:{color:"#6a9955"},punctuation:{color:"#d4d4d4"},".language-html .language-css .token.punctuation":{color:"#d4d4d4"},".language-html .language-javascript .token.punctuation":{color:"#d4d4d4"},property:{color:"#9cdcfe"},tag:{color:"#569cd6"},boolean:{color:"#569cd6"},number:{color:"#b5cea8"},constant:{color:"#9cdcfe"},symbol:{color:"#b5cea8"},inserted:{color:"#b5cea8"},unit:{color:"#b5cea8"},selector:{color:"#d7ba7d"},"attr-name":{color:"#9cdcfe"},string:{color:"#ce9178"},char:{color:"#ce9178"},builtin:{color:"#ce9178"},deleted:{color:"#ce9178"},".language-css .token.string.url":{textDecoration:"underline"},operator:{color:"#d4d4d4"},entity:{color:"#569cd6"},"operator.arrow":{color:"#569CD6"},atrule:{color:"#ce9178"},"atrule.rule":{color:"#c586c0"},"atrule.url":{color:"#9cdcfe"},"atrule.url.function":{color:"#dcdcaa"},"atrule.url.punctuation":{color:"#d4d4d4"},keyword:{color:"#569CD6"},"keyword.module":{color:"#c586c0"},"keyword.control-flow":{color:"#c586c0"},function:{color:"#dcdcaa"},"function.maybe-class-name":{color:"#dcdcaa"},regex:{color:"#d16969"},important:{color:"#569cd6"},italic:{fontStyle:"italic"},"class-name":{color:"#4ec9b0"},"maybe-class-name":{color:"#4ec9b0"},console:{color:"#9cdcfe"},parameter:{color:"#9cdcfe"},interpolation:{color:"#9cdcfe"},"punctuation.interpolation-punctuation":{color:"#569cd6"},variable:{color:"#9cdcfe"},"imports.maybe-class-name":{color:"#9cdcfe"},"exports.maybe-class-name":{color:"#9cdcfe"},escape:{color:"#d7ba7d"},"tag.punctuation":{color:"#808080"},cdata:{color:"#808080"},"attr-value":{color:"#ce9178"},"attr-value.punctuation":{color:"#ce9178"},"attr-value.punctuation.attr-equals":{color:"#d4d4d4"},namespace:{color:"#4ec9b0"},'pre[class*="language-javascript"]':{color:"#9cdcfe"},'code[class*="language-javascript"]':{color:"#9cdcfe"},'pre[class*="language-jsx"]':{color:"#9cdcfe"},'code[class*="language-jsx"]':{color:"#9cdcfe"},'pre[class*="language-typescript"]':{color:"#9cdcfe"},'code[class*="language-typescript"]':{color:"#9cdcfe"},'pre[class*="language-tsx"]':{color:"#9cdcfe"},'code[class*="language-tsx"]':{color:"#9cdcfe"},'pre[class*="language-css"]':{color:"#ce9178"},'code[class*="language-css"]':{color:"#ce9178"},'pre[class*="language-html"]':{color:"#d4d4d4"},'code[class*="language-html"]':{color:"#d4d4d4"},".language-regex .token.anchor":{color:"#dcdcaa"},".language-html .token.punctuation":{color:"#808080"},'pre[class*="language-"] > code[class*="language-"]':{position:"relative",zIndex:"1"},".line-highlight.line-highlight":{background:"#f7ebc6",boxShadow:"inset 5px 0 0 #f7d87c",zIndex:"0"}};function Mo(){var x;if(typeof window<"u"){const m=(x=window.__OPENCLAW_GITEA_URL__)==null?void 0:x.trim();return m||`${window.location.protocol}//${window.location.hostname}:3030`}return"http://localhost:3030"}function Ao(x){try{return new URL(x).hostname}catch{return typeof window<"u"?window.location.hostname:"localhost"}}function Eo(x){if(typeof window<"u"){const m=window.__OPENCLAW_GITEA_SSH_PORT__;if(m!=null){const u=Number(m);if(Number.isFinite(u)&&u>0)return u}}try{const m=new URL(x).hostname;if(m==="localhost"||m==="127.0.0.1")return 2222}catch{}return 22}const ct=Mo(),fn=Ao(ct),gn=Eo(ct);function Do(x){const m=x.split(`
`),u=[];let w=0,b=0;for(const j of m){if(j.startsWith("@@")){const P=j.match(/^@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@/);w=P?Number(P[1]):0,b=P?Number(P[2]):0,u.push({text:j,oldPosition:0,newPosition:0,kind:"hunk"});continue}if(j.startsWith("+")&&!j.startsWith("+++")){u.push({text:j,oldPosition:0,newPosition:b,kind:"add"}),b+=1;continue}if(j.startsWith("-")&&!j.startsWith("---")){u.push({text:j,oldPosition:w,newPosition:0,kind:"del"}),w+=1;continue}if(j.startsWith("diff --git")||j.startsWith("index ")||j.startsWith("--- ")||j.startsWith("+++ ")){u.push({text:j,oldPosition:0,newPosition:0,kind:"meta"});continue}if(w>0||b>0){u.push({text:j,oldPosition:w,newPosition:b,kind:"ctx"}),w+=1,b+=1;continue}u.push({text:j,oldPosition:0,newPosition:0,kind:"ctx"})}return u}function H(x){if(!x)return"—";const m=Date.now(),u=new Date(x).getTime(),w=m-u;if(w<0)return"soon";const b=Math.floor(w/1e3);if(b<60)return`${b}s ago`;const j=Math.floor(b/60);if(j<60)return`${j}m ago`;const P=Math.floor(j/60);return P<24?`${P}h ago`:`${Math.floor(P/24)}d ago`}function Fo(x){var u;const m=(u=x.split(".").pop())==null?void 0:u.toLowerCase();return m?["py"].includes(m)?rt:["ts","tsx","js","jsx","json","yml","yaml","toml","sh","html","css"].includes(m)?rt:["md","txt","csv","log"].includes(m)?kn:ns:ns}function as(x){var b;const m=((b=x.split(".").pop())==null?void 0:b.toLowerCase())||"",u=x.toLowerCase(),w={py:"python",ts:"typescript",tsx:"tsx",js:"javascript",jsx:"jsx",json:"json",yml:"yaml",yaml:"yaml",md:"markdown",mdx:"markdown",sh:"bash",bash:"bash",zsh:"bash",fish:"bash",sql:"sql",html:"html",htm:"html",css:"css",scss:"scss",less:"less",xml:"xml",svg:"xml",toml:"toml",ini:"ini",cfg:"ini",rs:"rust",go:"go",java:"java",kt:"kotlin",swift:"swift",rb:"ruby",php:"php",cs:"csharp",cpp:"cpp",c:"c",h:"c",r:"r",lua:"lua",perl:"perl",ps1:"powershell",dockerfile:"docker",makefile:"makefile",cmake:"cmake",graphql:"graphql",gql:"graphql",proto:"protobuf",tf:"hcl",hcl:"hcl",env:"bash"};return u==="dockerfile"||u.startsWith("dockerfile.")?"docker":u==="makefile"?"makefile":u===".gitignore"||u===".dockerignore"||u===".env"||u===".env.example"?"bash":w[m]||"text"}function wn(x){var u;const m=(u=x.split(".").pop())==null?void 0:u.toLowerCase();return m==="md"||m==="mdx"}function Io(x){var u;const m=(u=x.split(".").pop())==null?void 0:u.toLowerCase();return["png","jpg","jpeg","gif","svg","webp","ico","bmp"].includes(m||"")}function jn(x){var w;const m=(w=x.split(".").pop())==null?void 0:w.toLowerCase();return m&&{py:"#4e94c0",ts:"#4b8ec2",tsx:"#4b8ec2",js:"#b8a84e",jsx:"#b8a84e",json:"#8a9a6e",yml:"#8a6ea0",yaml:"#8a6ea0",md:"#6ea870",sh:"#6ea870",bash:"#6ea870",sql:"#82aaff",html:"#c07a60",css:"#6e6ea0",dockerfile:"#4e8a7e",gitignore:"#6c707e",env:"#6c707e"}[m]||"#6c707e"}function Uo(x){return x<1024?`${x} B`:x<1024*1024?`${(x/1024).toFixed(1)} KB`:`${(x/(1024*1024)).toFixed(1)} MB`}const Ho={Python:"#3572A5",TypeScript:"#3178c6",JavaScript:"#f1e05a",HTML:"#e34c26",CSS:"#563d7c",Shell:"#89e051",Go:"#00ADD8",Rust:"#dea584",Java:"#b07219",Ruby:"#701516",PHP:"#4F5D95",Swift:"#F05138",Kotlin:"#A97BFF","C#":"#178600",C:"#555555","C++":"#f34b7d",Dockerfile:"#384d54",YAML:"#cb171e",JSON:"#292929",Makefile:"#427819",SQL:"#e38c00",Lua:"#000080",R:"#198CE7",Scala:"#c22d40",HCL:"#844FBA",Perl:"#0298c3",Markdown:"#083fa1"};async function vn(x,m=1e4){const u=new AbortController,w=window.setTimeout(()=>u.abort(),m);try{const b=await fetch(x,{signal:u.signal});if(!b.ok)throw new Error(`${b.status} ${b.statusText}`);return await b.json()}finally{window.clearTimeout(w)}}function yn(x){const m=new TextEncoder().encode(x);let u="";const w=32768;for(let b=0;b<m.length;b+=w)u+=String.fromCharCode(...m.subarray(b,b+w));return btoa(u)}function dt(x){return(x||"unknown").toLowerCase()}function Pe(x){const m=dt(x);return m==="failure"||m==="error"||m==="failed"}function it(x){const m=dt(x);return m==="success"?{bg:"bg-obsidian-success/10",text:"text-obsidian-success",border:"border-obsidian-success/20"}:m==="pending"||m==="running"||m==="waiting"?{bg:"bg-obsidian-warning/10",text:"text-obsidian-warning",border:"border-obsidian-warning/20"}:Pe(m)?{bg:"bg-obsidian-danger/10",text:"text-obsidian-danger",border:"border-obsidian-danger/20"}:{bg:"bg-obsidian-border-active/30",text:"text-obsidian-muted",border:"border-white/10"}}function qo({status:x}){return x==="checking"?e.jsxs("div",{className:"flex items-center gap-1 text-obsidian-muted",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),e.jsx("span",{className:"text-[10px]",children:"Checking..."})]}):x==="online"?e.jsxs("div",{className:"flex items-center gap-1 text-obsidian-success",children:[e.jsx(lt,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[10px]",children:"Connected"})]}):e.jsxs("div",{className:"flex items-center gap-1 text-obsidian-danger",children:[e.jsx(ue,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[10px]",children:"Offline"})]})}function Nn({status:x,conclusion:m}){const u=m||x,w={success:{bg:"bg-obsidian-success/10",text:"text-obsidian-success",border:"border-obsidian-success/20",icon:lt},failure:{bg:"bg-obsidian-danger/10",text:"text-obsidian-danger",border:"border-obsidian-danger/20",icon:Re},running:{bg:"bg-obsidian-info/10",text:"text-obsidian-info",border:"border-obsidian-info/20",icon:C},waiting:{bg:"bg-obsidian-warning/10",text:"text-obsidian-warning",border:"border-obsidian-warning/20",icon:Cn},cancelled:{bg:"bg-obsidian-muted/10",text:"text-obsidian-muted",border:"border-obsidian-muted/20",icon:Re}},b=w[u]||w.waiting,j=b.icon;return e.jsxs("span",{className:v("inline-flex items-center gap-1.5 rounded-md px-2 py-0.5 text-[10px] font-medium border",b.bg,b.text,b.border),children:[e.jsx(j,{className:v("w-3 h-3",u==="running"&&"animate-spin")}),u.charAt(0).toUpperCase()+u.slice(1)]})}function Oo({pr:x}){return x.merged?e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md px-2 py-0.5 text-[10px] font-medium border bg-obsidian-primary/10 text-obsidian-primary border-obsidian-primary/20 transition-all active:scale-95",children:[e.jsx(os,{className:"w-3.5 h-3.5"})," Merged"]}):x.state==="closed"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md px-2 py-0.5 text-[10px] font-medium border bg-obsidian-danger/10 text-obsidian-danger border-obsidian-danger/20 transition-all active:scale-95",children:[e.jsx(Re,{className:"w-3.5 h-3.5"})," Closed"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md px-2 py-0.5 text-[10px] font-medium border bg-obsidian-success/10 text-obsidian-success border-obsidian-success/20 transition-all active:scale-95",children:[e.jsx(q,{className:"w-3.5 h-3.5"})," Open"]})}function zo({patch:x,filename:m}){if(!x)return e.jsx("div",{className:"px-4 py-2 text-[10px] text-obsidian-muted italic",children:"No diff available"});const u=x.split(`
`);return e.jsx("div",{className:"font-mono text-[11px] leading-[18px] overflow-x-auto",children:u.map((w,b)=>{let j="",P="#bcbec4";return w.startsWith("+")&&!w.startsWith("+++")?(j="bg-[#1a3a2a]",P="#6aab73"):w.startsWith("-")&&!w.startsWith("---")?(j="bg-[#3a1a1a]",P="#ff5261"):w.startsWith("@@")&&(j="bg-[#1a2a3a]",P="#3574f0"),e.jsx("div",{className:v("px-4 py-0 whitespace-pre",j),style:{color:P},children:w},`${m}-${b}`)})})}function pi(){var Ca,_a,Sa,$a,Pa,Ra,Ta,La,Ba,Ma,Aa,Ea,Da,Fa,Ia,Ua,Ha,qa,Oa,za,Wa,Ga,Ja,Va,Ka,Qa,Xa;const[x,m]=i.useState("checking"),[u,w]=i.useState(""),[b,j]=i.useState([]),[P,is]=i.useState(!0),[pe,xt]=i.useState(!0),[Wo,mt]=i.useState(null),[Te,_n]=i.useState(""),[rs,Sn]=i.useState(!1),[r,ls]=i.useState(null),[L,cs]=i.useState("files"),[F,ds]=i.useState([]),[M,xs]=i.useState([]),[$n,ut]=i.useState(1),[Pn,Le]=i.useState(!1),[pt,ms]=i.useState(!1),[ht,us]=i.useState([]),[Rn,ps]=i.useState(1),[Tn,bt]=i.useState(!1),[ft,hs]=i.useState(!1),[Be,Me]=i.useState(null),[bs,he]=i.useState([]),[Ln,fs]=i.useState(!1),[B,gs]=i.useState(null),[Bn,ws]=i.useState(!1),[N,js]=i.useState(""),[Go,vs]=i.useState(!1),[te,ys]=i.useState([]),[Mn,Ns]=i.useState(1),[An,gt]=i.useState(!1),[wt,ks]=i.useState(!1),[se,Ae]=i.useState({}),[O,jt]=i.useState(""),[Cs,vt]=i.useState(null),[S,V]=i.useState(null),[yt,K]=i.useState(""),[En,Ee]=i.useState(!1),[Nt,_s]=i.useState(!0),[kt,De]=i.useState(!1),[Ct,Ss]=i.useState(""),[be,$s]=i.useState(""),[Fe,Ps]=i.useState(""),[Rs,Ts]=i.useState(!1),[R,fe]=i.useState(null),[Dn,Ls]=i.useState(!1),[ae,_t]=i.useState(new Set),Fn=Ya.useRef(null),Bs=(t,a)=>{Fn.current=t,a.editor.defineTheme("obsidian",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"546e7a",fontStyle:"italic"},{token:"keyword",foreground:"c792ea",fontStyle:"bold"},{token:"string",foreground:"c3e88d"},{token:"number",foreground:"f78c6c"},{token:"operator",foreground:"89ddff"},{token:"identifier",foreground:"eeffff"},{token:"function",foreground:"82aaff"},{token:"class.identifier",foreground:"ffcb6b"},{token:"type.identifier",foreground:"ffcb6b"},{token:"delimiter",foreground:"eeffff"}],colors:{"editor.background":"#111113","editor.foreground":"#eeffff","editor.selectionBackground":"#2d4264","editor.lineHighlightBackground":"#1a1a1e","editorCursor.foreground":"#818cf8","editorWhitespace.foreground":"#2a2a30","editorIndentGuide.background1":"#2a2a30","editorLineNumber.foreground":"#3a3a4a","editorLineNumber.activeForeground":"#6b7280"}}),a.editor.setTheme("obsidian")},[Ie,Ms]=i.useState([]),[ne,In]=i.useState("all"),[Un,As]=i.useState(1),[Hn,St]=i.useState(!1),[$t,Es]=i.useState(!1),[Ds,Pt]=i.useState(!1),[oe,Rt]=i.useState(null),[A,ie]=i.useState(null),[qn,Fs]=i.useState(!1),[Ue,Is]=i.useState(""),[Us,Hs]=i.useState(""),[He,qs]=i.useState(""),[qe,Os]=i.useState(""),[z,Q]=i.useState("unknown"),[ge,X]=i.useState([]),[Tt,zs]=i.useState(!1),[Ws,we]=i.useState([]),[Gs,je]=i.useState([]),[Lt,Bt]=i.useState([]),[On,Js]=i.useState(!1),[Oe,re]=i.useState(null),[Mt,Vs]=i.useState(!1),[T,ve]=i.useState(null),[At,Ks]=i.useState(!1),[ze,Qs]=i.useState(!1),[We,Ge]=i.useState(!1),[Xs,Je]=i.useState(!1),[Ys,W]=i.useState(null),[$,D]=i.useState({enable_status_check:!0,status_check_contexts:[],required_approvals:1,dismiss_stale_approvals:!0,block_on_rejected_reviews:!0,block_on_outdated_branch:!0,block_on_official_review_requests:!1,enable_force_push:!1,require_signed_commits:!1}),[Zs,Et]=i.useState(""),[ye,Dt]=i.useState([]),[ea,ta]=i.useState("open"),[zn,sa]=i.useState(1),[Wn,Ft]=i.useState(!1),[It,aa]=i.useState(!1),[Ne,Ut]=i.useState([]),[Gn,na]=i.useState(1),[Jn,Ht]=i.useState(!1),[qt,oa]=i.useState(!1),[ia,ra]=i.useState(!1),[ke,la]=i.useState(""),[ca,Vn]=i.useState(""),[le,Ot]=i.useState(null),[zt,da]=i.useState(null),[I,E]=i.useState(null),[Y,Ve]=i.useState(null),[xa,Ce]=i.useState(""),[Wt,Gt]=i.useState({}),[ma,Jt]=i.useState([]),[ua,Kn]=i.useState(!1),[Qn,pa]=i.useState(null),_e=i.useRef(0),Ke=i.useRef(0);i.useEffect(()=>{if(!I)return;const t=window.setTimeout(()=>E(null),3500);return()=>window.clearTimeout(t)},[I]);const y=i.useCallback(t=>{E({tone:"error",message:t})},[]),Z=i.useCallback(t=>{E({tone:"success",message:t})},[]),Qe=i.useCallback(async()=>{m("checking");try{const t=await vn("/api/gitea/health",8e3);t.status==="online"?(m("online"),w(t.version||"")):m("offline")}catch(t){console.error("[CICD] health check failed:",t),m("offline")}},[]),Xe=i.useCallback(async()=>{xt(!0);try{const t=await vn("/api/gitea/repos?limit=50",1e4);j(t.repos||[]),mt(null)}catch(t){mt(t instanceof Error?t.message:"Failed to fetch repos")}finally{xt(!1)}},[]),Se=i.useCallback(async(t,a)=>{try{const o=await(await fetch(`/api/gitea/repos/${t}/${a}/branches`)).json();ds(o.branches||[])}catch(s){console.error("[CICD] fetchBranches failed:",s),ds([])}},[]),Vt=i.useCallback(async(t,a,s)=>{const o=(s==null?void 0:s.page)??1,n=!!(s!=null&&s.append),l=20;n&&ks(!0);try{const d=await(await fetch(`/api/gitea/repos/${t}/${a}/tags?limit=${l}&page=${o}`)).json(),f=Array.isArray(d)?d:d.tags||[];ys(p=>{if(!n)return f;const g=new Set(p.map(h=>h.name)),_=[...p];for(const h of f)g.has(h.name)||_.push(h);return _}),Ns(o),gt(Array.isArray(f)&&f.length===l)}catch(c){console.error("[CICD] fetchTags failed:",c),n||(ys([]),gt(!1))}finally{n&&ks(!1)}},[]),U=i.useCallback(async(t,a,s,o)=>{const n=(o==null?void 0:o.page)??1,l=!!(o!=null&&o.append),c=30;l&&ms(!0);try{const d=s?`&sha=${encodeURIComponent(s)}`:"",g=(await(await fetch(`/api/gitea/repos/${t}/${a}/commits?limit=${c}&page=${n}${d}`)).json()).commits||[];xs(_=>{if(!l)return g;const h=new Set(_.map(at=>at.sha)),k=[..._];for(const at of g)h.has(at.sha)||k.push(at);return k}),ut(n),Le(Array.isArray(g)&&g.length===c)}catch(d){console.error("[CICD] fetchCommits failed:",d),l||(xs([]),Le(!1))}finally{l&&ms(!1)}},[]),Ye=i.useCallback(async(t,a,s="open",o)=>{const n=(o==null?void 0:o.page)??1,l=!!(o!=null&&o.append),c=20;l&&aa(!0);try{const p=(await(await fetch(`/api/gitea/repos/${t}/${a}/issues?state=${s}&limit=${c}&page=${n}`)).json()).issues||[];Dt(g=>{if(!l)return p;const _=new Set(g.map(k=>k.number)),h=[...g];for(const k of p)_.has(k.number)||h.push(k);return h}),sa(n),Ft(Array.isArray(p)&&p.length===c)}catch(d){console.error("[CICD] fetchIssues failed:",d),l||(Dt([]),Ft(!1))}finally{l&&aa(!1)}},[]),Kt=i.useCallback(async(t,a,s)=>{const o=(s==null?void 0:s.page)??1,n=!!(s!=null&&s.append),l=20;n&&oa(!0);try{const f=(await(await fetch(`/api/gitea/repos/${t}/${a}/releases?limit=${l}&page=${o}`)).json()).releases||[];Ut(p=>{if(!n)return f;const g=new Set(p.map(h=>h.id)),_=[...p];for(const h of f)g.has(h.id)||_.push(h);return _}),na(o),Ht(Array.isArray(f)&&f.length===l)}catch(c){console.error("[CICD] fetchReleases failed:",c),n||(Ut([]),Ht(!1))}finally{n&&oa(!1)}},[]),ce=i.useCallback(async(t,a,s)=>{const o=(s==null?void 0:s.page)??1,n=!!(s!=null&&s.append),l=20;n&&hs(!0);try{const d=await(await fetch(`/api/gitea/repos/${t}/${a}/actions/runs?limit=${l}&page=${o}`)).json(),f=d.workflow_runs||d.tasks||d.task_list||[],p=Array.isArray(f)?f:[];us(g=>{if(!n)return p;const _=new Set(g.map(k=>k.id)),h=[...g];for(const k of p)_.has(k.id)||h.push(k);return h}),ps(o),bt(p.length===l),n||(Me(null),he([]))}catch(c){console.error("[CICD] fetchActions failed:",c),n||(us([]),bt(!1))}finally{n&&hs(!1)}},[]),Xn=i.useCallback(async(t,a,s)=>{fs(!0);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/actions/runs/${s}/jobs`)).json(),l=Array.isArray(n==null?void 0:n.jobs)?n.jobs:Array.isArray(n)?n:[n];he(l.filter(Boolean))}catch(o){console.error("[CICD] fetchActionRunJobs failed:",o),he([])}finally{fs(!1)}},[]),G=i.useCallback(async(t,a,s="all",o)=>{const n=(o==null?void 0:o.page)??1,l=!!(o!=null&&o.append),c=20;l&&Es(!0);try{const p=(await(await fetch(`/api/gitea/repos/${t}/${a}/pulls?state=${s}&limit=${c}&page=${n}`)).json()).pulls||[];Ms(g=>{if(!l)return p;const _=new Set(g.map(k=>k.number)),h=[...g];for(const k of p)_.has(k.number)||h.push(k);return h}),As(n),St(Array.isArray(p)&&p.length===c)}catch(d){console.error("[CICD] fetchPulls failed:",d),l||(Ms([]),St(!1))}finally{l&&Es(!1)}},[]),ha=i.useCallback(async(t,a,s)=>{if(!s){Q("unknown"),X([]);return}zs(!0);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/commits/${encodeURIComponent(s)}/status`)).json();Q(dt(n==null?void 0:n.state)),X(Array.isArray(n==null?void 0:n.statuses)?n.statuses:[])}catch(o){console.error("[CICD] fetchPRChecks failed:",o),Q("unknown"),X([])}finally{zs(!1)}},[]),Ze=i.useCallback(async(t,a,s)=>{var n,l,c,d,f;const o=++Ke.current;Fs(!0);try{const g=await(await fetch(`/api/gitea/repos/${t}/${a}/pulls/${s}`)).json();if(o!==Ke.current)return;ie(g),((n=g==null?void 0:g.pull)==null?void 0:n.mergeable)===!1?re({prNumber:s,message:"PR is not mergeable with current base. Update branch from base and retry."}):re(h=>(h==null?void 0:h.prNumber)===s?null:h);const _=((c=(l=g==null?void 0:g.pull)==null?void 0:l.head)==null?void 0:c.sha)||((f=(d=g==null?void 0:g.pull)==null?void 0:d.head)==null?void 0:f.ref)||"";ha(t,a,_)}catch(p){if(console.error("[CICD] fetchPRDetail failed:",p),o!==Ke.current)return;ie(null),Q("unknown"),X([])}finally{o===Ke.current&&Fs(!1)}},[ha]),de=i.useCallback(async(t,a,s)=>{Js(!0);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/pulls/${s}/activity`)).json();we(Array.isArray(n.comments)?n.comments:[]),je(Array.isArray(n.reviews)?n.reviews:[]),Bt(Array.isArray(n.inline_comments)?n.inline_comments:[])}catch(o){console.error("[CICD] fetchPRActivity failed:",o),we([]),je([]),Bt([])}finally{Js(!1)}},[]),J=i.useCallback(async(t,a,s="",o)=>{try{const n=o?`&ref=${encodeURIComponent(o)}`:"",c=await(await fetch(`/api/gitea/repos/${t}/${a}/tree?path=${encodeURIComponent(s)}${n}`)).json();Ae(d=>({...d,[s||"/"]:c.entries||[]}))}catch(n){console.error("[CICD] fetchTree failed:",n),Ae(l=>({...l,[s||"/"]:[]}))}},[]),Qt=i.useCallback(async(t,a,s,o)=>{const n=++_e.current;Ee(!0),V(s),De(!1);try{const l=o?`&ref=${encodeURIComponent(o)}`:"",c=await fetch(`/api/gitea/repos/${t}/${a}/file?path=${encodeURIComponent(s)}${l}`);if(!c.ok){const p=await c.json().catch(()=>({}));if(n!==_e.current)return;console.error("[CICD] fetchFileContent error:",c.status,p),K(`// Error ${c.status}: Could not load file "${s}"
// ${(p==null?void 0:p.detail)||"Unknown error"}`),Ps("");return}const d=await c.json();if(n!==_e.current)return;const f=d.content??"";console.log("[CICD] File loaded:",s,"length:",f.length),K(f),Ps(d.sha||"")}catch(l){if(n!==_e.current)return;console.error("[CICD] fetchFileContent exception:",l),K(`// Error loading file "${s}"`)}finally{n===_e.current&&Ee(!1)}},[]),Yn=i.useCallback(async(t,a,s)=>{Ls(!0);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/commits/${s}`)).json();fe(n),_t(new Set)}catch(o){console.error("[CICD] fetchCommitDetail failed:",o),fe(null)}finally{Ls(!1)}},[]),ba=i.useCallback(async(t,a)=>{try{const s=await fetch(`/api/gitea/repos/${t}/${a}/languages`);if(s.ok){const o=await s.json();Gt(o||{})}}catch(s){console.error("[CICD] fetchLanguages failed:",s),Gt({})}},[]),fa=i.useCallback(async(t,a)=>{try{const s=await fetch(`/api/gitea/repos/${t}/${a}/topics`);if(s.ok){const o=await s.json();Jt((o==null?void 0:o.topics)||[])}}catch(s){console.error("[CICD] fetchTopics failed:",s),Jt([])}},[]),Xt=i.useCallback(async t=>{const a=t.default_branch||"main";ls(t),cs("files"),ws(!0),jt(""),V(null),K(""),fe(null),Ae({}),Gt({}),Jt([]),js(a),vs(!1),Rt(null),ie(null),we([]),je([]),Bt([]),ve(null),re(null),Q("unknown"),X([]),ta("open"),Dt([]),Ut([]),ut(1),Ns(1),sa(1),na(1),As(1),ps(1),Le(!1),gt(!1),Ft(!1),Ht(!1),St(!1),bt(!1),Me(null),he([]);const[s,o]=t.full_name.split("/");try{await Promise.all([J(s,o,"",a),Se(s,o),U(s,o,a,{page:1}),G(s,o,"all",{page:1}),ce(s,o,{page:1}),Vt(s,o,{page:1}),Ye(s,o,"open",{page:1}),Kt(s,o,{page:1}),ba(s,o),fa(s,o)])}finally{ws(!1)}},[J,Se,U,G,ce,Vt,Ye,Kt,ba,fa]),et=i.useCallback(async t=>{if(!r)return;const[a,s]=r.full_name.split("/");js(t),vs(!1),jt(""),V(null),K(""),Ae({}),ut(1),Le(!1),fe(null),await Promise.all([J(a,s,"",t),U(a,s,t,{page:1})])},[r,J,U]),Zn=i.useCallback(async t=>{if(!r)return;const[a,s]=r.full_name.split("/");console.log("Deleting branch:",a,s,t),da(t);try{const o=await fetch(`/api/gitea/repos/${a}/${s}/branches?branch=${encodeURIComponent(t)}`,{method:"DELETE"});if(!o.ok){const n=await o.json().catch(()=>({detail:o.statusText}));E({tone:"error",message:`Failed to delete branch: ${n.detail||o.statusText}`});return}N===t&&await et(r.default_branch||"main"),Se(a,s),E({tone:"success",message:`Branch "${t}" deleted`})}catch(o){console.error("[CICD] handleDeleteBranch failed:",o),E({tone:"error",message:`Failed to delete branch: ${o instanceof Error?o.message:"Unknown error"}`})}finally{da(o=>o===t?null:o)}},[r,N,et,Se]),eo=i.useCallback(async()=>{if(!r||!S||!be)return;const[t,a]=r.full_name.split("/");Ts(!0);try{const s=await fetch(`/api/gitea/repos/${t}/${a}/file`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:S,content:yn(Ct),message:be,sha:Fe,branch:N})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to save: ${o.detail||s.statusText}`);return}De(!1),$s(""),await Qt(t,a,S,N),await U(t,a,N)}catch(s){y(`Failed to save: ${s instanceof Error?s.message:"Unknown error"}`)}finally{Ts(!1)}},[r,S,Ct,be,Fe,N,Qt,U,y]),to=i.useCallback(async()=>{if(!r||!S||!confirm(`Delete file "${S}"? This cannot be undone.`))return;const[t,a]=r.full_name.split("/");Ee(!0);try{const s=await fetch(`/api/gitea/repos/${t}/${a}/file`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:S,message:`Delete ${S}`,sha:Fe,branch:N})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to delete file: ${o.detail||s.statusText}`);return}V(null),K(""),await J(t,a,"",N),await U(t,a,N)}catch(s){y(`Failed to delete file: ${s instanceof Error?s.message:"Unknown error"}`)}finally{Ee(!1)}},[r,S,Fe,N,J,U,y]);i.useEffect(()=>{Qe(),Xe()},[Qe,Xe]),i.useEffect(()=>{if(!pe&&x!=="checking")return;const t=window.setTimeout(()=>{xt(!1),m(a=>a==="checking"?"offline":a),mt(a=>a??"Request timeout while loading repositories")},12e3);return()=>window.clearTimeout(t)},[pe,x]),i.useEffect(()=>{const t=a=>{const s=a.detail;if(s!=null&&s.repo){const o=b.find(n=>n.full_name===s.repo);o&&Xt(o)}};return window.addEventListener("openclaw:select-repo",t),()=>window.removeEventListener("openclaw:select-repo",t)},[b,Xt]),i.useEffect(()=>{if(!r)return;const[t,a]=r.full_name.split("/"),s=setInterval(()=>ce(t,a,{page:1}),15e3);return()=>clearInterval(s)},[r,ce]);const tt=async t=>{if(r&&(jt(t),V(null),!se[t])){const[a,s]=r.full_name.split("/");await J(a,s,t,N)}},so=t=>{if(!r)return;const[a,s]=r.full_name.split("/");Qt(a,s,t,N)},ao=t=>{if(!r)return;const[a,s]=r.full_name.split("/");Yn(a,s,t)},no=t=>{if(!r)return;const[a,s]=r.full_name.split("/"),o=oe===t?null:t;Rt(o),ie(null),we([]),je([]),Q("unknown"),X([]),o!==null&&(Ze(a,s,o),de(a,s,o))},oo=async()=>{if(!r||!ke)return;const[t,a]=r.full_name.split("/");try{const s=await fetch(`/api/gitea/repos/${t}/${a}/branches`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({new_branch_name:ke,old_branch_name:ca||r.default_branch})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to create branch: ${o.detail||s.statusText}`);return}la(""),ra(!1),Z(`Branch '${ke}' created`),Se(t,a)}catch(s){y(`Failed to create branch: ${s instanceof Error?s.message:"Unknown error"}`)}},io=async()=>{if(!r||!Ue||!He||!qe)return;const[t,a]=r.full_name.split("/");try{const s=await fetch(`/api/gitea/repos/${t}/${a}/pulls`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:Ue,body:Us,head:He,base:qe})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to create PR: ${o.detail||s.statusText}`);return}Is(""),Hs(""),qs(""),Os(""),Pt(!1),Z("Pull request created"),G(t,a,ne,{page:1})}catch(s){y(`Failed to create PR: ${s instanceof Error?s.message:"Unknown error"}`)}},Yt=async(t,a="merge")=>{if(!r)return;const[s,o]=r.full_name.split("/"),n=a.charAt(0).toUpperCase()+a.slice(1);if(window.confirm(`Merge PR #${t} using "${n}" strategy?`))try{const l=await fetch(`/api/gitea/repos/${s}/${o}/pulls/${t}/merge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({merge_message_field_style:a,delete_branch_after_merge:!1})});if(!l.ok){const c=await l.json().catch(()=>({detail:l.statusText})),d=String(c.detail||l.statusText||"merge failed"),f=d.toLowerCase();(l.status===409||f.includes("conflict")||f.includes("not mergeable"))&&re({prNumber:t,message:d}),y(`Failed to merge PR: ${d}`);return}re(null),Z(`PR #${t} merged successfully`),Ze(s,o,t),de(s,o,t),G(s,o,ne,{page:1})}catch(l){y(`Failed to merge PR: ${l instanceof Error?l.message:"Unknown error"}`)}},ro=async t=>{if(!r)return;const[a,s]=r.full_name.split("/");if(window.confirm(`Close PR #${t}?`))try{const o=await fetch(`/api/gitea/repos/${a}/${s}/pulls/${t}/close`,{method:"PATCH"});if(!o.ok){const l=await o.json().catch(()=>({detail:o.statusText}));y(`Failed to close PR: ${l.detail||o.statusText}`);return}const n=await o.json();Z(`PR #${t} closed`),ie(l=>l?{...l,pull:n.pull}:null),de(a,s,t),G(a,s,ne,{page:1})}catch(o){y(`Failed to close PR: ${o instanceof Error?o.message:"Unknown error"}`)}},ga=async(t,a,s)=>{if(!r)return;const[o,n]=r.full_name.split("/");try{const l=await fetch(`/api/gitea/repos/${o}/${n}/pulls/${t}/reviews`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:a,body:s})});if(!l.ok){const d=await l.json().catch(()=>({detail:l.statusText||"unknown error"}));y(`Failed to submit review: ${d.detail||l.statusText}`);return}Z(`PR #${t} ${a==="APPROVED"?"approved":a==="REQUEST_CHANGES"?"requested changes on":"commented on"}`),Ze(o,n,t),de(o,n,t)}catch(l){y(`Failed to submit review: ${l instanceof Error?l.message:"Unknown error"}`)}},wa=async(t,a)=>{if(!r)return;const[s,o]=r.full_name.split("/");Vs(!0);try{const n=await fetch(`/api/gitea/repos/${s}/${o}/pulls/${t}/update?style=${a}`,{method:"POST"});if(!n.ok){const l=await n.json().catch(()=>({detail:n.statusText}));y(`Failed to update PR branch: ${l.detail||n.statusText}`);return}re(null),E({tone:"success",message:`PR #${t} branch updated with ${a}`}),Ze(s,o,t),de(s,o,t),G(s,o,ne,{page:1})}catch(n){y(`Failed to update PR branch: ${n instanceof Error?n.message:"Unknown error"}`)}finally{Vs(!1)}},lo=async t=>{var n,l;if(!r||!T)return;const[a,s]=r.full_name.split("/"),o=T.body.trim();if(o){Ks(!0);try{const c=await fetch(`/api/gitea/repos/${a}/${s}/pulls/${t}/inline-comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:T.path,new_position:T.newPosition,old_position:T.oldPosition,body:o,commit_id:((l=(n=A==null?void 0:A.pull)==null?void 0:n.head)==null?void 0:l.sha)||""})});if(!c.ok){const d=await c.json().catch(()=>({detail:c.statusText}));y(`Failed to add inline comment: ${d.detail||c.statusText}`);return}E({tone:"success",message:"Inline comment added"}),ve(null),de(a,s,t)}catch(c){y(`Failed to add inline comment: ${c instanceof Error?c.message:"Unknown error"}`)}finally{Ks(!1)}}},ja=async(t,a)=>{if(!r)return;const[s,o]=r.full_name.split("/");gs({runId:t,action:a});try{const n=await fetch(`/api/gitea/repos/${s}/${o}/actions/runs/${t}/${a}`,{method:"POST"});if(!n.ok){const l=await n.json().catch(()=>({detail:n.statusText}));y(`Failed to ${a} run #${t}: ${l.detail||n.statusText}`);return}E({tone:"success",message:a==="rerun"?`Run #${t} rerun dispatched`:`Run #${t} cancelled`}),ce(s,o,{page:1})}catch(n){y(`Failed to ${a} run #${t}: ${n instanceof Error?n.message:"Unknown error"}`)}finally{gs(null)}},co=async t=>{await ga(t,"APPROVED","LGTM ✅")},xo=async t=>{Ve({prNumber:t,event:"REQUEST_CHANGES",title:`Request changes on PR #${t}`,placeholder:"Please address review feedback."}),Ce("Please address review feedback.")},mo=async t=>{Ve({prNumber:t,event:"COMMENT",title:`Add review comment to PR #${t}`,placeholder:"Write a comment..."}),Ce("")},uo=async()=>{if(!Y)return;const t=xa.trim();if(Y.event==="COMMENT"&&!t){y("Comment cannot be empty");return}await ga(Y.prNumber,Y.event,t),Ve(null),Ce("")},$e=i.useCallback(async(t,a,s)=>{Qs(!0),W(null);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/branch-protections`)).json(),c=(Array.isArray(n.protections)?n.protections:[]).find(d=>d.rule_name===s||d.branch_name===s);if(!c){Je(!1),D({branch_name:s,rule_name:s,enable_status_check:!0,status_check_contexts:[],required_approvals:1,dismiss_stale_approvals:!0,block_on_rejected_reviews:!0,block_on_outdated_branch:!0,block_on_official_review_requests:!1,enable_force_push:!1,require_signed_commits:!1}),Et("");return}Je(!0),D({branch_name:s,rule_name:c.rule_name||c.branch_name||s,enable_status_check:!!c.enable_status_check,status_check_contexts:Array.isArray(c.status_check_contexts)?c.status_check_contexts:[],required_approvals:Number(c.required_approvals??1),dismiss_stale_approvals:!!c.dismiss_stale_approvals,block_on_rejected_reviews:!!c.block_on_rejected_reviews,block_on_outdated_branch:!!c.block_on_outdated_branch,block_on_official_review_requests:!!c.block_on_official_review_requests,enable_force_push:!!c.enable_force_push,require_signed_commits:!!c.require_signed_commits}),Et((Array.isArray(c.status_check_contexts)?c.status_check_contexts:[]).join(", "))}catch(o){W(o instanceof Error?o.message:"Failed to load branch protection")}finally{Qs(!1)}},[]),po=async()=>{if(!r)return;const[t,a]=r.full_name.split("/"),s=r.default_branch||"main",o=Zs.split(",").map(n=>n.trim()).filter(Boolean);Ge(!0),W(null);try{const n={branch_name:s,rule_name:$.rule_name||s,enable_status_check:!!$.enable_status_check,status_check_contexts:o,required_approvals:Math.max(0,Number($.required_approvals??0)),dismiss_stale_approvals:!!$.dismiss_stale_approvals,block_on_rejected_reviews:!!$.block_on_rejected_reviews,block_on_outdated_branch:!!$.block_on_outdated_branch,block_on_official_review_requests:!!$.block_on_official_review_requests,enable_force_push:!!$.enable_force_push,require_signed_commits:!!$.require_signed_commits},l=await fetch(`/api/gitea/repos/${t}/${a}/branch-protections/${encodeURIComponent(s)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!l.ok){const c=await l.json().catch(()=>({detail:l.statusText}));W(c.detail||l.statusText);return}Je(!0),E({tone:"success",message:`Branch protection saved for ${s}`}),await $e(t,a,s)}catch(n){W(n instanceof Error?n.message:"Failed to save branch protection")}finally{Ge(!1)}},ho=async()=>{if(!r)return;const[t,a]=r.full_name.split("/"),s=r.default_branch||"main";Ge(!0),W(null);try{const o=await fetch(`/api/gitea/repos/${t}/${a}/branch-protections/${encodeURIComponent(s)}`,{method:"DELETE"});if(!o.ok){const n=await o.json().catch(()=>({detail:o.statusText}));W(n.detail||o.statusText);return}Je(!1),Z(`Branch protection removed for ${s}`),await $e(t,a,s)}catch(o){W(o instanceof Error?o.message:"Failed to delete branch protection")}finally{Ge(!1)}};i.useEffect(()=>{if(!r||L!=="security")return;const[t,a]=r.full_name.split("/"),s=r.default_branch||"main";$e(t,a,s)},[r,L,$e]);const va=b.filter(t=>!Te||t.full_name.toLowerCase().includes(Te.toLowerCase())||(t.description||"").toLowerCase().includes(Te.toLowerCase()));i.useEffect(()=>{(async()=>{if(!r)return;const s=(se[O||"/"]||[]).find(o=>o.name.toLowerCase()==="readme.md"&&o.type==="file");if(s){const[o,n]=r.full_name.split("/"),l=N?`&ref=${encodeURIComponent(N)}`:"";try{const d=await(await fetch(`/api/gitea/repos/${o}/${n}/file?path=${encodeURIComponent(s.path)}${l}`)).json();vt(d.content||"")}catch(c){console.error("[CICD] README load failed:",c),vt(null)}}else vt(null)})()},[se,O,r,N]);const bo=[{key:"files",label:"Files",icon:Za},{key:"commits",label:"Commits",icon:ts,count:M.length},{key:"pulls",label:"PRs",icon:q,count:Ie.length},{key:"issues",label:"Issues",icon:ue,count:ye.length},{key:"branches",label:"Branches",icon:me,count:F.length},{key:"tags",label:"Tags",icon:ot,count:te.length},{key:"releases",label:"Releases",icon:pn,count:Ne.length},{key:"actions",label:"Actions",icon:en,count:ht.length},{key:"security",label:"Security",icon:hn},{key:"insights",label:"Insights",icon:tn}],[ya,st]=i.useState(!1),[xe,Na]=i.useState(""),ka=async()=>{if(!r||!xe)return;const[t,a]=r.full_name.split("/");try{const s=await fetch(`/api/gitea/repos/${t}/${a}/file`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:xe,content:yn(""),message:`Create ${xe}`,sha:"",branch:N})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to create file: ${o.detail||s.statusText}`);return}Z(`File '${xe}' created`),st(!1),Na(""),await J(t,a,"",N)}catch(s){y(`Failed to create file: ${s instanceof Error?s.message:"Unknown error"}`)}};return e.jsxs("div",{className:"flex h-screen bg-[#09090b] text-foreground font-sans overflow-hidden relative",style:{fontFamily:"'Inter', -apple-system, sans-serif"},children:[e.jsx("div",{className:"absolute top-0 left-0 w-[800px] h-[800px] bg-purple-500/5 rounded-full blur-[120px] pointer-events-none -translate-x-1/4 -translate-y-1/4 z-0"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[600px] h-[600px] bg-sky-500/5 rounded-full blur-[100px] pointer-events-none translate-x-1/4 -translate-y-1/4 z-0"}),e.jsx("div",{className:"relative z-10 shrink-0",children:e.jsx(fo,{})}),P&&e.jsxs("div",{className:v("w-[260px] bg-black/20 backdrop-blur-xl border-r border-white/5 shrink-0 flex flex-col z-10 relative shadow-[4px_0_24px_rgba(0,0,0,0.4)] transition-all",r?"hidden md:flex":"flex"),children:[e.jsx("div",{className:"h-10 border-b border-white/5 flex items-center justify-between px-4 shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-3.5 h-3.5 text-sky-400 opacity-80"}),e.jsx("span",{className:"text-xs font-semibold text-white/90 tracking-wide",children:"Repositories"})]})}),e.jsx("div",{className:"p-2 border-b border-white/5",children:e.jsxs("div",{className:"relative",children:[e.jsx(go,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3 h-3 text-obsidian-muted"}),e.jsx("input",{type:"text",placeholder:"Search...",className:"w-full bg-black/20 border border-white/10 focus:border-obsidian-info shadow-sm rounded pl-7 pr-2 py-1 text-[11px] text-foreground placeholder-obsidian-muted outline-none transition-all",value:Te,onChange:t=>_n(t.target.value)})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:pe?e.jsx("div",{className:"p-4 text-center text-obsidian-muted text-[11px]",children:"Loading repositories..."}):va.length===0?e.jsx("div",{className:"p-4 text-center text-obsidian-muted text-[11px]",children:"No repositories found."}):va.map(t=>e.jsxs("div",{className:v("flex flex-col gap-1 px-4 py-2.5 border-b border-white/5 cursor-pointer transition-colors",(r==null?void 0:r.id)===t.id?"bg-white/[0.04]":"hover:bg-white/[0.02]"),onClick:()=>{Xt(t)},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-3.5 h-3.5 text-obsidian-info shrink-0"}),e.jsx("span",{className:"text-[12px] text-foreground font-medium truncate",children:t.full_name})]}),t.description&&e.jsx("p",{className:"text-[10px] text-obsidian-muted line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-obsidian-muted mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ot,{className:"w-2.5 h-2.5"}),t.stars_count]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-2.5 h-2.5"}),t.default_branch]}),e.jsx("span",{className:"ml-auto",children:H(t.updated_at)})]})]},t.id))})]}),e.jsxs("main",{className:"flex-1 flex flex-col min-w-0 min-h-0 bg-transparent relative z-10",children:[e.jsxs("header",{className:"flex items-center px-4 justify-between h-12 bg-black/40 backdrop-blur-md border-b border-white/5 shrink-0 z-20",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-obsidian-info/30 to-transparent opacity-50"}),e.jsxs("div",{className:"flex items-center gap-3 text-[12px]",children:[e.jsx("button",{onClick:()=>is(!P),className:"p-1.5 hover:bg-white/10 rounded-md text-obsidian-muted hover:text-white transition-all active:scale-95 border border-transparent hover:border-obsidian-border/50",title:"Toggle Repositories Panel",children:e.jsx(yo,{className:"w-4 h-4 drop-shadow-[0_0_8px_rgba(255,255,255,0.2)]"})}),e.jsx("div",{className:"w-[1px] h-4 bg-obsidian-border/50"}),e.jsx(q,{className:"w-3.5 h-3.5",style:{color:"#a78bfa"}}),e.jsx("span",{className:"text-foreground font-medium",children:"Source Control"}),e.jsx("span",{className:"text-obsidian-muted",children:"·"}),e.jsxs("span",{className:"text-obsidian-muted",children:["Gitea ",u&&`v${u}`]}),e.jsx("span",{className:"text-obsidian-muted",children:"·"}),e.jsx(qo,{status:x}),e.jsx("span",{className:"text-obsidian-muted",children:"·"}),e.jsxs("span",{className:"text-[10px] text-obsidian-muted",children:[b.length," repos"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>{Qe(),Xe()},className:"p-1 hover:bg-obsidian-border-active rounded text-obsidian-muted hover:text-foreground transition-colors",title:"Refresh",children:e.jsx(on,{className:v("w-3.5 h-3.5",pe&&"animate-spin")})}),e.jsx("button",{onClick:()=>Sn(!rs),className:"p-1 hover:bg-obsidian-border-active rounded text-obsidian-muted hover:text-foreground transition-colors",children:rs?e.jsx(rn,{className:"w-3.5 h-3.5"}):e.jsx(wo,{className:"w-3.5 h-3.5"})}),e.jsx("a",{href:ct,target:"_blank",rel:"noopener noreferrer",className:"p-1 hover:bg-obsidian-border-active rounded text-obsidian-muted hover:text-foreground transition-colors",title:"Open Gitea",children:e.jsx(ln,{className:"w-3.5 h-3.5"})})]})]}),e.jsx("div",{className:"flex-1 flex min-h-0 overflow-hidden bg-transparent",children:e.jsx("div",{className:v("flex-1 min-h-0 flex flex-col min-w-0 bg-transparent",r?"flex":"hidden md:flex"),children:r?e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col min-w-0 bg-transparent",children:[e.jsxs("div",{className:"bg-black/20 backdrop-blur-md border-b border-white/5 shrink-0 flex flex-col pt-4",children:[e.jsxs("div",{className:"flex items-start justify-between px-6 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(q,{className:"w-5 h-5 shrink-0",style:{color:"#a78bfa"}}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[18px] text-foreground truncate",children:[e.jsx("span",{className:"text-obsidian-info hover:underline cursor-pointer",children:r.owner.login}),e.jsx("span",{className:"text-obsidian-muted",children:"/"}),e.jsx("span",{className:"font-bold text-obsidian-info hover:underline cursor-pointer",children:r.name})]}),e.jsx("span",{className:"border border-obsidian-border text-obsidian-muted text-[10px] px-2 py-0.5 rounded-full font-medium ml-2",children:"Public"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r.html_url+".git")},className:"p-1.5 hover:bg-obsidian-border-active rounded-md text-obsidian-muted hover:text-foreground transition-colors",title:"Copy clone URL",children:e.jsx(Zt,{className:"w-3.5 h-3.5"})}),e.jsx("a",{href:r.html_url,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 hover:bg-obsidian-border-active rounded-md text-obsidian-muted hover:text-foreground transition-colors",children:e.jsx(ln,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>{ls(null),V(null),K(""),fe(null)},className:"p-1.5 hover:bg-obsidian-danger/20 rounded-md text-obsidian-muted hover:text-obsidian-danger transition-colors ml-1",children:e.jsx(cn,{className:"w-4 h-4"})})]})})]}),e.jsx("div",{className:"flex px-4 overflow-x-auto no-scrollbar",children:bo.map(t=>e.jsxs("button",{onClick:()=>cs(t.key),className:v("flex items-center gap-1.5 px-4 py-2.5 text-[12px] font-medium transition-colors border-b-2 whitespace-nowrap",L===t.key?"text-foreground border-obsidian-info bg-white/[0.04]":"text-obsidian-muted border-transparent hover:text-foreground hover:bg-white/[0.02] hover:border-white/5"),children:[e.jsx(t.icon,{className:"w-4 h-4"}),t.label,t.count!==void 0&&t.count>0&&e.jsx("span",{className:"text-[10px] bg-white/5 rounded-full px-2 py-0.5 text-obsidian-muted font-semibold transition-all active:scale-95",children:t.count})]},t.key))})]}),e.jsx("div",{className:"flex-1 flex overflow-hidden",children:Bn?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(C,{className:"w-6 h-6 text-obsidian-info animate-spin"})}):L==="files"?e.jsx("div",{className:"flex-1 flex flex-col overflow-auto items-center py-6 backdrop-blur-sm",children:e.jsx("div",{className:"w-full max-w-[1240px] px-6",children:S?e.jsx("div",{className:"flex flex-col border border-white/5 shadow-sm rounded-lg bg-black/20 backdrop-blur-md overflow-hidden",style:{minHeight:"calc(100vh - 120px)"},children:En?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(C,{className:"w-6 h-6 text-obsidian-info animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-black/20 border-b border-white/5 flex items-center px-4 py-2.5 justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"flex items-center gap-1.5 border border-white/10 shadow-sm rounded-md bg-white/[0.02] hover:bg-white/[0.05] px-2.5 py-1 text-[11px] font-medium text-obsidian-muted hover:text-foreground transition-colors",onClick:()=>V(null),children:[e.jsx(nt,{className:"w-3.5 h-3.5 rotate-180"})," Back"]}),e.jsx("div",{className:"w-px h-4 bg-white/10 mx-1"}),e.jsx(rt,{className:"w-4 h-4 ml-1",style:{color:jn(S)}}),e.jsx("div",{className:"text-[13px] font-mono font-medium text-foreground",children:S.split("/").pop()}),e.jsx("span",{className:"text-[9px] text-obsidian-muted font-bold font-mono uppercase bg-white/5 px-1.5 py-0.5 rounded ml-2 border border-white/5",children:as(S)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[wn(S)&&!kt&&e.jsxs("div",{className:"flex rounded-md overflow-hidden bg-black/20 border border-white/10 text-[11px] font-medium transition-colors mr-2",children:[e.jsx("button",{onClick:()=>_s(!0),className:v("px-3 py-1.5 transition-colors",Nt?"bg-white/10 text-foreground":"text-obsidian-muted hover:text-foreground"),children:"Preview"}),e.jsx("div",{className:"w-px bg-white/10"}),e.jsxs("button",{onClick:()=>_s(!1),className:v("px-3 py-1.5 transition-colors flex items-center gap-1",Nt?"text-obsidian-muted hover:text-foreground":"bg-white/10 text-foreground"),children:[e.jsx(Zt,{className:"w-3.5 h-3.5"})," Source"]})]}),N===((r==null?void 0:r.default_branch)||"main")?e.jsx("span",{className:"text-[10px] text-obsidian-muted bg-white/[0.02] border border-white/10 px-2.5 py-1.5 rounded-md font-medium",children:"🔒 Protected Branch"}):kt?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-[11px] mr-2 text-obsidian-warning font-medium flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-obsidian-warning animate-pulse"}),"Editing"]}),e.jsx("button",{onClick:()=>De(!1),className:"text-[11px] font-medium border border-obsidian-border bg-obsidian-bg text-obsidian-muted hover:text-foreground px-3 py-1.5 rounded-md shadow-sm hover:bg-obsidian-border-active transition-colors active:scale-95",children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{Ss(yt),De(!0)},className:"flex items-center gap-2 px-3 py-1.5 text-[11px] font-medium border border-white/10 bg-white/[0.02] text-foreground rounded-md shadow-sm hover:bg-white/[0.05] transition-colors active:scale-95",children:"✏️ Edit"}),e.jsx("button",{onClick:to,className:"flex items-center gap-1 p-1.5 border border-white/10 text-[11px] font-medium bg-white/[0.02] text-obsidian-danger rounded-md shadow-sm hover:bg-obsidian-danger/20 transition-colors active:scale-95",title:"Delete file",children:e.jsx(Co,{className:"w-3.5 h-3.5"})})]})]})]}),kt?e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("div",{style:{height:"calc(100vh - 260px)",minHeight:"400px"},children:e.jsx(an,{height:"100%",width:"100%",language:as(S),value:Ct,theme:"obsidian",onChange:t=>Ss(t||""),onMount:Bs,options:{readOnly:!1,domReadOnly:!1,minimap:{enabled:!1},fontSize:14,fontFamily:"JetBrains Mono, Fira Code, DM Mono, Menlo, monospace",fontLigatures:!0,lineHeight:24,scrollBeyondLastLine:!1,automaticLayout:!0,padding:{top:16,bottom:16},renderLineHighlight:"all"}})}),e.jsxs("div",{className:"border-t border-white/5 bg-black/40 p-3.5 flex items-center gap-3 shrink-0",children:[e.jsx("input",{type:"text",placeholder:"Commit message...",value:be,onChange:t=>$s(t.target.value),className:"flex-1 bg-black/20 border border-white/10 focus:border-obsidian-info shadow-sm rounded-md px-3 py-2 text-[12px] text-foreground placeholder-obsidian-muted outline-none transition-all"}),e.jsxs("button",{onClick:eo,disabled:!be||Rs,className:"px-4 py-2 bg-[#238636] border border-[rgba(240,246,252,0.1)] text-white rounded-md text-[12px] font-bold hover:bg-[#2ea043] shadow-sm disabled:opacity-40 flex items-center gap-1.5 transition-all active:scale-95",children:[Rs&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Commit changes"]})]})]}):e.jsx("div",{className:"flex-1 flex flex-col overflow-auto bg-transparent",children:wn(S)&&Nt?e.jsx("div",{className:"px-10 py-10 max-w-[900px] mx-auto prose prose-invert max-w-none prose-a:text-obsidian-info hover:prose-a:underline prose-headings:border-b prose-headings:border-obsidian-border prose-headings:pb-2",children:e.jsx(dn,{remarkPlugins:[xn],components:{code({node:t,inline:a,className:s,children:o,...n}){const l=/language-(\w+)/.exec(s||"");return!a&&l?e.jsxs("div",{className:"not-prose rounded-md overflow-hidden my-6 border border-white/10 shadow-[0_4px_24px_rgba(0,0,0,0.2)]",children:[e.jsxs("div",{className:"bg-black/40 px-4 py-2 text-[11px] font-mono text-obsidian-muted border-b border-white/5 flex items-center justify-between",children:[e.jsx("span",{children:l[1]}),e.jsx("button",{className:"hover:text-foreground transition-colors",onClick:()=>navigator.clipboard.writeText(String(o).replace(/\n$/,"")),children:e.jsx(sn,{className:"w-3.5 h-3.5"})})]}),e.jsx(mn,{...n,style:bn,language:l[1],PreTag:"div",className:"!m-0 !bg-[#0b0c0f] !text-[13px] !p-4 !overflow-x-auto",children:String(o).replace(/\n$/,"")})]}):e.jsx("code",{...n,className:v(s,"bg-white/[0.04] px-1.5 py-0.5 rounded text-[13px] font-mono border border-white/5 text-obsidian-info before:content-hidden after:content-hidden"),children:o})}},children:yt})}):Io(S)?e.jsx("div",{className:"flex items-center justify-center h-full p-8 bg-[#0d1117]",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] text-obsidian-muted mb-3",children:"Image preview not available via API"})})}):e.jsx("div",{style:{height:"calc(100vh - 200px)",minHeight:"500px"},children:e.jsx(an,{height:"100%",width:"100%",language:as(S),value:yt,theme:"obsidian",onMount:Bs,options:{readOnly:!0,domReadOnly:!0,minimap:{enabled:!1},fontSize:14,fontFamily:"JetBrains Mono, Fira Code, DM Mono, Menlo, monospace",fontLigatures:!0,lineHeight:24,scrollBeyondLastLine:!1,automaticLayout:!0,padding:{top:16,bottom:16},renderLineHighlight:"none"}})})})]})}):e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center text-[14px] font-bold text-obsidian-info",children:[e.jsx("span",{className:"hover:underline cursor-pointer",onClick:()=>tt(""),children:r.name}),O.split("/").filter(Boolean).map((t,a,s)=>{const o=s.slice(0,a+1).join("/");return e.jsxs(Ya.Fragment,{children:[e.jsx("span",{className:"text-obsidian-muted px-1.5 font-normal",children:"/"}),e.jsx("span",{className:"hover:underline cursor-pointer",onClick:()=>tt(o),children:t})]},o)})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex items-center bg-white/[0.02] border border-white/10 rounded-md px-3 py-1.5 transition-colors shadow-sm hover:border-obsidian-info/50 group",children:[e.jsx(me,{className:"w-3.5 h-3.5 text-obsidian-muted mr-2 group-hover:text-obsidian-info transition-colors"}),e.jsx("select",{className:"bg-transparent text-[11px] font-medium text-foreground outline-none cursor-pointer appearance-none pr-5 min-w-[70px]",value:N||"",onChange:t=>et(t.target.value),children:F.map(t=>e.jsx("option",{value:t.name,className:"bg-obsidian-panel",children:t.name},t.name))}),e.jsx(es,{className:"w-3 h-3 text-obsidian-muted absolute right-2.5 pointer-events-none group-hover:text-obsidian-info transition-colors"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>st(!ya),className:"px-3 py-1.5 text-[11px] font-medium text-foreground bg-white/[0.02] border border-white/10 rounded-md hover:bg-white/[0.05] transition-all active:scale-95 flex items-center gap-1.5 shadow-sm",children:["Add file ",e.jsx(es,{className:"w-3 h-3 opacity-60 ml-0.5"})]}),ya&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 w-[240px] bg-[#1a1b1e]/90 backdrop-blur-xl border border-white/10 shadow-2xl rounded-md z-20 p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-black/20 border border-obsidian-info/50 rounded px-1.5 py-1 mb-2",children:[e.jsx(ns,{className:"w-3.5 h-3.5 text-obsidian-muted shrink-0"}),e.jsx("input",{autoFocus:!0,type:"text",placeholder:"name.txt",className:"w-full bg-transparent text-[11px] outline-none text-foreground",value:xe,onChange:t=>Na(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ka(),t.key==="Escape"&&st(!1)}})]}),e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx("button",{onClick:()=>st(!1),className:"text-[10px] px-2 py-1 text-obsidian-muted hover:text-foreground rounded hover:bg-obsidian-border-active transition-colors",children:"Cancel"}),e.jsx("button",{onClick:ka,disabled:!xe,className:"text-[10px] px-2 py-1 bg-obsidian-info/20 text-obsidian-info rounded hover:bg-obsidian-info/30 disabled:opacity-50 transition-colors",children:"Create"})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>Kn(!ua),className:"px-3 py-1.5 bg-obsidian-success text-white rounded-md text-[11px] font-medium hover:bg-obsidian-success/90 transition-all active:scale-95 flex items-center gap-1.5",children:[e.jsx(Zt,{className:"w-3.5 h-3.5"}),"Code",e.jsx(es,{className:"w-3 h-3 opacity-60 ml-0.5"})]}),ua&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-[340px] bg-[#1a1b1e]/90 backdrop-blur-xl border border-white/10 rounded-lg shadow-2xl z-50 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2.5 border-b border-white/5",children:e.jsx("span",{className:"text-[12px] font-semibold text-foreground",children:"Clone"})}),["HTTPS","SSH"].map(t=>{const a=t==="HTTPS"?`${ct}/${r.full_name}.git`:gn===22?`git@${fn}:${r.full_name}.git`:`ssh://git@${fn}:${gn}/${r.full_name}.git`;return e.jsxs("div",{className:"px-3 py-2 border-b border-white/5 last:border-b-0",children:[e.jsx("div",{className:"text-[11px] font-medium text-obsidian-muted mb-1.5",children:t}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{readOnly:!0,value:a,className:"flex-1 bg-black/20 border border-white/10 rounded px-2 py-1.5 text-[11px] font-mono text-obsidian-muted outline-none select-all"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(a),pa(t),setTimeout(()=>pa(null),2e3)},className:"p-1.5 border border-white/10 rounded hover:bg-white/[0.05] transition-colors",children:Qn===t?e.jsx(vo,{className:"w-3.5 h-3.5 text-obsidian-success"}):e.jsx(So,{className:"w-3.5 h-3.5 text-obsidian-muted"})})]})]},t)})]})]})]})]}),e.jsxs("div",{className:"border border-white/5 rounded-lg bg-black/20 backdrop-blur-md overflow-hidden mt-4 shadow-sm",children:[e.jsxs("div",{className:"bg-black/20 px-4 py-2.5 flex items-center justify-between border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2.5 min-w-0",children:[e.jsx("img",{src:((_a=(Ca=M[0])==null?void 0:Ca.author)==null?void 0:_a.avatar_url)||`https://ui-avatars.com/api/?name=${((Pa=($a=(Sa=M[0])==null?void 0:Sa.commit)==null?void 0:$a.author)==null?void 0:Pa.name)||"U"}&background=1a1a2e&color=58a6ff&size=24&font-size=0.45&bold=true`,alt:"",className:"w-5 h-5 rounded-full border border-white/10 shrink-0"}),e.jsx("span",{className:"text-[12px] font-semibold text-foreground shrink-0",children:((La=(Ta=(Ra=M[0])==null?void 0:Ra.commit)==null?void 0:Ta.author)==null?void 0:La.name)||"admin"}),e.jsx("span",{className:"text-[12px] text-obsidian-muted truncate hover:text-obsidian-info hover:underline transition-colors cursor-pointer",children:((Aa=(Ma=(Ba=M[0])==null?void 0:Ba.commit)==null?void 0:Ma.message)==null?void 0:Aa.split(`
`)[0])||"Initial commit"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-[12px] text-obsidian-muted shrink-0 ml-4",children:[e.jsx("code",{className:"text-[11px] font-mono font-medium text-obsidian-info hover:underline cursor-pointer bg-obsidian-info/10 px-1.5 py-0.5 rounded",children:((Da=(Ea=M[0])==null?void 0:Ea.sha)==null?void 0:Da.slice(0,7))||"0000000"}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Cn,{className:"w-3 h-3 opacity-60"}),H((Ua=(Ia=(Fa=M[0])==null?void 0:Fa.commit)==null?void 0:Ia.author)==null?void 0:Ua.date)]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-obsidian-muted border border-white/5 rounded-md px-2 py-0.5 text-[11px] font-medium hover:text-foreground hover:border-white/20 cursor-pointer transition-colors",children:[e.jsx(ts,{className:"w-3 h-3"}),M.length," commits"]})]})]}),e.jsx("table",{className:"w-full text-left border-collapse",children:e.jsxs("tbody",{children:[O!==""&&e.jsx("tr",{className:"border-t border-white/5 hover:bg-white/[0.02] transition-colors group",children:e.jsx("td",{colSpan:3,className:"px-4 py-2.5",children:e.jsxs("div",{className:"text-[12px] text-obsidian-info font-bold cursor-pointer hover:text-white transition-colors flex items-center gap-2 w-fit px-2 py-0.5 rounded-md hover:bg-obsidian-info/20",onClick:()=>{const t=O.split("/");t.pop(),tt(t.join("/"))},children:[e.jsx(nt,{className:"w-4 h-4 rotate-180"}),e.jsx("span",{className:"tracking-widest",children:".."})]})})}),(se[O||"/"]||[]).sort((t,a)=>t.type!==a.type?t.type==="dir"?-1:1:t.name.localeCompare(a.name)).map(t=>{const a=t.type==="dir",s=a?Za:Fo(t.name),o=a?"#6895a8":jn(t.name);return e.jsxs("tr",{className:"border-t border-white/5 hover:bg-white/[0.02] transition-colors group cursor-pointer",onClick:()=>a?tt(t.path):so(t.path),children:[e.jsx("td",{className:"px-4 py-3 w-8",children:e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center group-hover:bg-white/5 transition-colors border border-transparent group-hover:border-white/10",children:e.jsx(s,{className:"w-4 h-4",style:{color:o}})})}),e.jsx("td",{className:"px-1 py-3",children:e.jsx("span",{className:v("text-[13px] transition-colors",a?"font-medium text-foreground group-hover:text-obsidian-info":"text-obsidian-muted group-hover:text-foreground"),children:t.name})}),e.jsx("td",{className:"px-5 py-3 text-right w-24",children:!a&&t.size>0&&e.jsx("span",{className:"text-[11px] text-obsidian-muted font-mono",children:Uo(t.size)})})]},t.path)}),(!se[O||"/"]||se[O||"/"].length===0)&&e.jsx("tr",{className:"border-t border-white/5",children:e.jsxs("td",{colSpan:3,className:"px-4 py-12 text-center flex flex-col items-center justify-center gap-3",children:[e.jsx(jo,{className:"w-10 h-10 text-obsidian-muted opacity-30"}),e.jsx("span",{className:"text-[13px] text-obsidian-muted font-medium",children:"This directory is empty"})]})})]})})]}),Cs&&e.jsxs("div",{className:"border border-white/5 rounded-lg bg-black/20 backdrop-blur-md mt-6 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"bg-black/20 border-b border-white/5 px-4 py-3 flex items-center gap-2",children:[e.jsx(kn,{className:"w-4 h-4 text-obsidian-muted"}),e.jsx("span",{className:"text-[13px] font-semibold text-foreground",children:"README.md"})]}),e.jsx("div",{className:"p-8 prose prose-invert prose-obsidian max-w-none prose-a:text-obsidian-info hover:prose-a:underline prose-headings:border-b prose-headings:border-white/10 prose-headings:pb-2 prose-img:inline prose-img:m-0.5 prose-p:leading-relaxed [&_p:has(img)]:text-center [&_p:has(img)]:leading-loose",children:e.jsx(dn,{remarkPlugins:[xn],components:{code({node:t,inline:a,className:s,children:o,...n}){const l=/language-(\w+)/.exec(s||"");return!a&&l?e.jsxs("div",{className:"not-prose rounded-md overflow-hidden my-6 border border-white/10 shadow-[0_4px_24px_rgba(0,0,0,0.2)]",children:[e.jsxs("div",{className:"bg-black/40 px-4 py-2 text-[11px] font-mono text-obsidian-muted border-b border-white/5 flex items-center justify-between",children:[e.jsx("span",{children:l[1]}),e.jsx("button",{className:"hover:text-foreground transition-colors",onClick:()=>navigator.clipboard.writeText(String(o).replace(/\n$/,"")),children:e.jsx(sn,{className:"w-3.5 h-3.5"})})]}),e.jsx(mn,{...n,style:bn,language:l[1],PreTag:"div",className:"!m-0 !bg-obsidian-bg !text-[13px] !p-4 !overflow-x-auto",children:String(o).replace(/\n$/,"")})]}):e.jsx("code",{...n,className:v(s,"bg-obsidian-panel px-1.5 py-0.5 rounded text-[13px] font-mono border border-obsidian-border text-obsidian-info before:content-hidden after:content-hidden"),children:o})}},children:Cs})})]})]}),e.jsx("div",{className:"w-[280px] shrink-0 hidden xl:block",children:e.jsxs("div",{className:"sticky top-6 flex flex-col gap-5 bg-black/20 backdrop-blur-md border border-white/5 rounded-lg p-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-[12px] font-semibold text-foreground mb-3",children:"About"}),r.description?e.jsx("p",{className:"text-[13px] text-obsidian-muted leading-relaxed mb-3",children:r.description}):e.jsx("p",{className:"text-[12px] text-obsidian-muted/50 italic mb-3",children:"No description provided."}),ma.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:ma.map(t=>e.jsx("span",{className:"text-[11px] font-medium text-obsidian-info bg-obsidian-info/15 px-2.5 py-0.5 rounded-full hover:bg-obsidian-info/25 cursor-pointer transition-colors",children:t},t))}),e.jsxs("div",{className:"flex flex-col gap-2 text-[12px] text-obsidian-muted",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"w-3.5 h-3.5"})," ",r.stars_count," stars"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(No,{className:"w-3.5 h-3.5"})," ",r.forks_count," forks"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-3.5 h-3.5"})," ",F.length," branches"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ko,{className:"w-3.5 h-3.5"})," ",te.length," tags"]})]})]}),e.jsx("div",{className:"border-t border-white/5"}),Object.keys(Wt).length>0&&(()=>{const t=Object.values(Wt).reduce((s,o)=>s+o,0),a=Object.entries(Wt).sort((s,o)=>o[1]-s[1]).map(([s,o])=>({name:s,bytes:o,pct:o/t*100,color:Ho[s]||"#6c707e"}));return e.jsxs("div",{children:[e.jsx("h3",{className:"text-[12px] font-semibold text-foreground mb-3",children:"Languages"}),e.jsx("div",{className:"flex h-2 rounded-full overflow-hidden mb-3",children:a.map(s=>e.jsx("div",{style:{width:`${s.pct}%`,backgroundColor:s.color},title:`${s.name} ${s.pct.toFixed(1)}%`},s.name))}),e.jsx("div",{className:"flex flex-wrap gap-x-4 gap-y-1.5",children:a.map(s=>e.jsxs("div",{className:"flex items-center gap-1.5 text-[11px]",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:s.color}}),e.jsx("span",{className:"font-medium text-foreground",children:s.name}),e.jsxs("span",{className:"text-obsidian-muted",children:[s.pct.toFixed(1),"%"]})]},s.name))})]})})()]})})]})})}):L==="commits"?e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:v("overflow-auto shrink-0 py-1",R?"w-[300px] border-r border-white/5":"flex-1"),children:[M.length===0?e.jsx("div",{className:"text-center py-8 text-obsidian-muted text-[11px]",children:"No commits"}):M.map(t=>{var a,s,o,n,l,c,d;return e.jsx("div",{onClick:()=>ao(t.sha),className:v("px-4 py-2.5 cursor-pointer transition-colors border-b border-white/5",(R==null?void 0:R.sha)===t.sha?"bg-white/[0.04]":"hover:bg-white/[0.02]"),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ts,{className:"w-3.5 h-3.5 text-obsidian-info shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[11px] text-foreground truncate leading-relaxed",children:(s=(a=t.commit)==null?void 0:a.message)==null?void 0:s.split(`
`)[0]}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 text-[10px] text-obsidian-muted",children:[e.jsx("code",{className:"text-obsidian-danger font-mono",children:(o=t.sha)==null?void 0:o.slice(0,7)}),e.jsx("span",{children:(l=(n=t.commit)==null?void 0:n.author)==null?void 0:l.name}),e.jsx("span",{className:"ml-auto",children:H((d=(c=t.commit)==null?void 0:c.author)==null?void 0:d.date)})]})]})]})},t.sha)}),Pn&&e.jsx("div",{className:"px-4 py-3 flex justify-center border-b border-white/5",children:e.jsxs("button",{onClick:()=>{if(!r||pt)return;const[t,a]=r.full_name.split("/");U(t,a,N,{page:$n+1,append:!0})},disabled:pt,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[pt&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more commits"]})})]}),R&&e.jsx("div",{className:"flex-1 overflow-y-auto px-2 py-2 space-y-1 custom-scrollbar",children:Dn?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(C,{className:"w-5 h-5 text-obsidian-info animate-spin"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 bg-black/20 backdrop-blur-md transition-all active:scale-95",children:[e.jsx("p",{className:"text-[13px] text-foreground font-medium mb-2",children:(qa=(Ha=R.commit)==null?void 0:Ha.message)==null?void 0:qa.split(`
`)[0]}),((za=(Oa=R.commit)==null?void 0:Oa.message)==null?void 0:za.split(`
`).slice(1).join(`
`).trim())&&e.jsx("p",{className:"text-[11px] text-obsidian-muted mb-2 whitespace-pre-wrap",children:R.commit.message.split(`
`).slice(1).join(`
`).trim()}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-obsidian-muted",children:[e.jsx("code",{className:"text-obsidian-danger font-mono",children:(Wa=R.sha)==null?void 0:Wa.slice(0,7)}),e.jsx("span",{children:(Ja=(Ga=R.commit)==null?void 0:Ga.author)==null?void 0:Ja.name}),e.jsx("span",{children:H((Ka=(Va=R.commit)==null?void 0:Va.author)==null?void 0:Ka.date)})]}),R.stats&&e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-[10px]",children:[e.jsxs("span",{className:"text-obsidian-success",children:["+",R.stats.additions]}),e.jsxs("span",{className:"text-obsidian-danger",children:["-",R.stats.deletions]}),e.jsxs("span",{className:"text-obsidian-muted",children:[((Qa=R.files)==null?void 0:Qa.length)||0," files changed"]})]})]}),(Xa=R.files)==null?void 0:Xa.map(t=>{var a;return e.jsxs("div",{className:"border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-white/[0.01] cursor-pointer hover:bg-white/[0.03] transition-all active:scale-95",onClick:()=>{const s=new Set(ae);s.has(t.filename)?s.delete(t.filename):s.add(t.filename),_t(s)},children:[e.jsx(nt,{className:v("w-3 h-3 text-obsidian-muted transition-transform",ae.has(t.filename)&&"rotate-90")}),e.jsx("span",{className:v("text-[9px] px-1 py-0.5 rounded font-semibold uppercase",t.status==="added"?"bg-obsidian-success/15 text-obsidian-success":t.status==="removed"?"bg-obsidian-danger/15 text-obsidian-danger":"bg-obsidian-warning/15 text-obsidian-warning"),children:((a=t.status)==null?void 0:a[0])||"M"}),e.jsx("span",{className:"text-[11px] text-foreground font-mono truncate",children:t.filename}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] shrink-0",children:[t.additions>0&&e.jsxs("span",{className:"text-obsidian-success",children:["+",t.additions]}),t.deletions>0&&e.jsxs("span",{className:"text-obsidian-danger",children:["-",t.deletions]})]})]}),ae.has(t.filename)&&e.jsx(zo,{patch:t.patch||"",filename:t.filename})]},t.filename)})]})})]}):L==="pulls"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-md transition-all active:scale-95",children:[["all","open","closed"].map(t=>e.jsx("button",{onClick:()=>{if(In(t),Rt(null),ie(null),we([]),je([]),Q("unknown"),X([]),r){const[a,s]=r.full_name.split("/");G(a,s,t,{page:1})}},className:v("px-2 py-1 rounded text-[10px] font-medium transition-all",ne===t?"bg-obsidian-info/20 text-obsidian-info":"text-obsidian-muted hover:text-foreground"),children:t.charAt(0).toUpperCase()+t.slice(1)},t)),e.jsxs("button",{onClick:()=>Pt(!Ds),className:"ml-auto flex items-center gap-1 px-2 py-1 bg-obsidian-success/15 text-obsidian-success rounded text-[10px] font-medium hover:bg-obsidian-success/25 transition-all active:scale-95",children:[e.jsx(nn,{className:"w-3.5 h-3.5"})," New PR"]})]}),Ds&&e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 bg-black/40 backdrop-blur-md space-y-2 transition-all active:scale-95",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:He,onChange:t=>qs(t.target.value),className:"flex-1 bg-black/20 border border-white/10 rounded px-2 py-1 text-[11px] text-foreground outline-none transition-all active:scale-95",children:[e.jsx("option",{value:"",children:"Head branch..."}),F.map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))]}),e.jsx(un,{className:"w-4 h-4 text-obsidian-muted shrink-0 self-center"}),e.jsxs("select",{value:qe,onChange:t=>Os(t.target.value),className:"flex-1 bg-black/20 border border-white/10 rounded px-2 py-1 text-[11px] text-foreground outline-none transition-all active:scale-95",children:[e.jsx("option",{value:"",children:"Base branch..."}),F.map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))]})]}),e.jsx("input",{type:"text",placeholder:"PR title...",value:Ue,onChange:t=>Is(t.target.value),className:"w-full bg-black/20 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground placeholder-obsidian-muted outline-none transition-all active:scale-95"}),e.jsx("textarea",{placeholder:"Description (optional)...",value:Us,onChange:t=>Hs(t.target.value),rows:3,className:"w-full bg-black/20 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground placeholder-obsidian-muted outline-none resize-none transition-all active:scale-95"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:io,disabled:!Ue||!He||!qe,className:"px-3 py-1 bg-obsidian-success text-white rounded text-[10px] font-medium hover:bg-obsidian-success disabled:opacity-40 transition-all active:scale-95",children:"Create"}),e.jsx("button",{onClick:()=>Pt(!1),className:"px-3 py-1 text-obsidian-muted text-[10px] hover:text-foreground transition-all active:scale-95",children:"Cancel"})]})]}),Ie.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-obsidian-muted gap-2",children:[e.jsx(q,{className:"w-8 h-8 opacity-30"}),e.jsx("span",{className:"text-[12px]",children:"No pull requests"}),e.jsx("span",{className:"text-[10px]",children:"Create a PR to merge changes between branches"})]}):Ie.map(t=>{var a,s,o;return e.jsxs("div",{className:"border-b border-white/5",children:[e.jsx("div",{onClick:()=>no(t.number),className:v("px-4 py-3 cursor-pointer transition-colors",oe===t.number?"bg-white/[0.04]":"hover:bg-white/[0.02]"),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Oo,{pr:t}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[12px] text-foreground font-medium truncate",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-obsidian-muted",children:[e.jsxs("span",{children:["#",t.number]}),e.jsx("span",{children:(a=t.user)==null?void 0:a.login}),e.jsx("span",{className:"font-mono text-obsidian-info",children:(s=t.head)==null?void 0:s.ref}),e.jsx(un,{className:"w-2.5 h-2.5"}),e.jsx("span",{className:"font-mono text-obsidian-success",children:(o=t.base)==null?void 0:o.ref}),e.jsx("span",{className:"ml-auto",children:H(t.updated_at)})]})]}),t.comments>0&&e.jsxs("div",{className:"flex items-center gap-0.5 text-[10px] text-obsidian-muted shrink-0",children:[e.jsx(ss,{className:"w-3.5 h-3.5"}),t.comments]})]})}),oe===t.number&&e.jsxs("div",{className:"px-4 pb-3 pt-2 bg-white/[0.01] flex items-center gap-2 flex-wrap border-b border-white/5",children:[e.jsxs("div",{className:"w-full mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[e.jsx("span",{className:"text-obsidian-muted font-medium",children:"Checks"}),e.jsx("span",{className:v("px-2 py-0.5 rounded border font-medium",it(z).bg,it(z).text,it(z).border),children:Tt?"loading...":z}),!Tt&&ge.length>0&&e.jsxs("span",{className:"text-obsidian-muted",children:[ge.length," context",ge.length!==1?"s":""]}),Pe(z)&&e.jsx("span",{className:"text-obsidian-danger ml-auto",children:"Merge is blocked by failing checks"})]}),!Tt&&ge.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5",children:ge.slice(0,8).map((n,l)=>{const c=it(n.state),d=n.context||`check-${l+1}`,f=e.jsxs("span",{className:v("px-2 py-0.5 rounded border text-[9px] font-medium",c.bg,c.text,c.border),children:[d,": ",dt(n.state)]});return n.target_url?e.jsx("a",{href:n.target_url,target:"_blank",rel:"noopener noreferrer",onClick:p=>p.stopPropagation(),children:f},`${d}-${l}`):e.jsx("span",{children:f},`${d}-${l}`)})})]}),(Oe==null?void 0:Oe.prNumber)===t.number&&e.jsxs("div",{className:"w-full mb-2 rounded-md border border-obsidian-warning/30 bg-obsidian-warning/10 px-3 py-2 text-[10px] text-obsidian-warning",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Merge conflict detected"}),e.jsx("div",{className:"text-obsidian-muted mb-2",children:Oe.message}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),wa(t.number,"rebase")},disabled:Mt,className:"px-2 py-1 rounded border border-obsidian-info/30 bg-obsidian-info/10 text-obsidian-info hover:bg-obsidian-info/20 disabled:opacity-50",children:Mt?"Updating...":"Update Branch (Rebase)"}),e.jsx("button",{onClick:n=>{n.stopPropagation(),wa(t.number,"merge")},disabled:Mt,className:"px-2 py-1 rounded border border-white/20 bg-white/[0.05] text-foreground hover:bg-white/[0.1] disabled:opacity-50",children:"Update Branch (Merge)"})]})]}),!t.merged&&t.state==="open"?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:n=>{n.stopPropagation(),co(t.number)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-success/10 text-obsidian-success border border-obsidian-success/20 rounded-md text-[11px] font-medium hover:bg-obsidian-success/20 transition-colors active:scale-95",children:[e.jsx(lt,{className:"w-3.5 h-3.5"})," Approve"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),xo(t.number)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-warning/10 text-obsidian-warning border border-obsidian-warning/20 rounded-md text-[11px] font-medium hover:bg-obsidian-warning/20 transition-colors active:scale-95",children:[e.jsx(ue,{className:"w-3.5 h-3.5"})," Request changes"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),mo(t.number)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-white/[0.02] text-foreground border border-white/10 rounded-md text-[11px] font-medium hover:bg-white/[0.06] transition-colors active:scale-95",children:[e.jsx(ss,{className:"w-3.5 h-3.5"})," Comment"]}),e.jsx("div",{className:"w-px h-4 bg-obsidian-border-active/50 mx-1"}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),Yt(t.number,"merge")},disabled:Pe(z),className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-info/10 text-obsidian-info border border-obsidian-info/20 rounded-md text-[11px] font-medium hover:bg-obsidian-info/20 transition-colors active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed",children:[e.jsx(os,{className:"w-3.5 h-3.5"})," Merge"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),Yt(t.number,"squash")},disabled:Pe(z),className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-warning/10 text-obsidian-warning border border-obsidian-warning/20 rounded-md text-[11px] font-medium hover:bg-obsidian-warning/20 transition-colors active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed",children:[e.jsx(rn,{className:"w-3.5 h-3.5"})," Squash"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),Yt(t.number,"rebase")},disabled:Pe(z),title:"Rebase and Merge",className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-warning/10 text-obsidian-warning border border-obsidian-warning/20 rounded-md text-[11px] font-medium hover:bg-obsidian-warning/20 transition-colors active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed",children:[e.jsx(on,{className:"w-3.5 h-3.5"})," Rebase"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),ro(t.number)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-danger/10 text-obsidian-danger border border-obsidian-danger/20 rounded-md text-[11px] font-medium hover:bg-obsidian-danger/20 transition-colors ml-auto active:scale-95",children:[e.jsx(Re,{className:"w-3.5 h-3.5"})," Close"]})]}):e.jsxs("div",{className:v("flex items-center gap-2 px-3 py-1.5 rounded-md border text-[11px] font-medium",t.merged?"bg-obsidian-primary/10 text-obsidian-primary border-obsidian-primary/20":"bg-obsidian-border-active/30 text-obsidian-muted border-obsidian-border/50"),children:[t.merged?e.jsx(os,{className:"w-3.5 h-3.5"}):e.jsx(Re,{className:"w-3.5 h-3.5"}),t.merged?"Merged":"Closed"]})]}),oe===t.number&&qn&&e.jsxs("div",{className:"px-4 py-3 flex items-center gap-2 text-obsidian-muted text-[11px]",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin text-obsidian-info"}),"Loading changed files..."]}),oe===t.number&&A&&A.files&&A.files.length>0&&e.jsxs("div",{className:"border-t border-obsidian-border/50",children:[e.jsxs("div",{className:"px-4 py-2 text-[10px] text-obsidian-muted font-medium border-b border-obsidian-border/30 flex items-center gap-2 bg-obsidian-panel/40 transition-all active:scale-95",children:[e.jsx(rt,{className:"w-3.5 h-3.5"}),A.files.length," changed file",A.files.length!==1?"s":"",e.jsxs("span",{className:"text-obsidian-success ml-auto",children:["+",A.files.reduce((n,l)=>n+(l.additions||0),0)]}),e.jsxs("span",{className:"text-obsidian-danger ml-1",children:["-",A.files.reduce((n,l)=>n+(l.deletions||0),0)]})]}),A.files.map((n,l)=>{const c=Lt.filter(d=>d.path===n.filename);return e.jsxs("div",{className:"border-b border-obsidian-border/20",children:[e.jsxs("div",{className:"px-4 py-1.5 flex items-center gap-2 cursor-pointer hover:bg-obsidian-panel/60 bg-obsidian-bg/30 transition-all active:scale-95",onClick:d=>{d.stopPropagation(),_t(f=>{const p=new Set(f);return p.has(n.filename)?p.delete(n.filename):p.add(n.filename),p})},children:[e.jsx(nt,{className:"w-3 h-3 text-obsidian-muted shrink-0 transition-transform"+(ae.has(n.filename)?" rotate-90":"")}),e.jsx("span",{className:"text-[9px] px-1 rounded font-mono shrink-0 "+(n.status==="added"?"bg-obsidian-success/15 text-obsidian-success":n.status==="removed"?"bg-obsidian-danger/15 text-obsidian-danger":"bg-obsidian-warning/15 text-obsidian-warning"),children:(n.status||"M").slice(0,1).toUpperCase()}),e.jsx("span",{className:"font-mono text-[11px] text-foreground truncate flex-1",children:n.filename}),c.length>0&&e.jsxs("span",{className:"text-[9px] text-obsidian-info shrink-0",children:[c.length," inline comment",c.length===1?"":"s"]}),e.jsxs("span",{className:"text-[9px] text-obsidian-success shrink-0",children:["+",n.additions||0]}),e.jsxs("span",{className:"text-[9px] text-obsidian-danger shrink-0 ml-1",children:["-",n.deletions||0]})]}),ae.has(n.filename)&&n.patch&&e.jsx("div",{className:"overflow-x-auto text-[11px] font-mono leading-5",style:{fontFamily:"JetBrains Mono,Menlo,Monaco,Consolas,monospace"},children:Do(n.patch).map((d,f)=>{let p="transparent",g="#bcbec4";d.kind==="add"?(p="#1a3a2a",g="#6aab73"):d.kind==="del"?(p="#3a1a1a",g="#ff5261"):d.kind==="hunk"&&(p="#1a2a3a",g="#3574f0");const _=c.filter(h=>d.newPosition>0&&h.new_position===d.newPosition||d.oldPosition>0&&h.old_position===d.oldPosition);return e.jsxs("div",{children:[e.jsxs("div",{className:"px-2 py-0 whitespace-pre flex items-center gap-2",style:{backgroundColor:p,color:g},children:[e.jsx("span",{className:"w-10 text-right text-[9px] text-obsidian-muted/80",children:d.oldPosition>0?d.oldPosition:""}),e.jsx("span",{className:"w-10 text-right text-[9px] text-obsidian-muted/80",children:d.newPosition>0?d.newPosition:""}),e.jsx("span",{className:"flex-1",children:d.text}),(d.newPosition>0||d.oldPosition>0)&&e.jsx("button",{onClick:h=>{h.stopPropagation(),ve({path:n.filename,newPosition:d.newPosition,oldPosition:d.oldPosition,body:""})},className:"px-1.5 py-0.5 rounded border border-obsidian-info/30 bg-obsidian-info/10 text-obsidian-info text-[9px] hover:bg-obsidian-info/20",children:"Comment"})]}),_.length>0&&e.jsx("div",{className:"px-4 py-1.5 bg-black/20 border-t border-white/5 space-y-1",children:_.map(h=>{var k;return e.jsxs("div",{className:"text-[10px] text-foreground/90",children:[e.jsx("span",{className:"text-obsidian-info",children:((k=h.user)==null?void 0:k.login)||"unknown"}),e.jsxs("span",{className:"text-obsidian-muted",children:[" · line ",h.new_position||h.old_position||"-"]}),e.jsx("div",{className:"text-[11px] mt-0.5 whitespace-pre-wrap",children:h.body||""})]},`${h.id}-${h.review_id||0}`)})})]},`${n.filename}-${f}`)})}),ae.has(n.filename)&&(T==null?void 0:T.path)===n.filename&&e.jsxs("div",{className:"px-4 py-3 bg-black/20 border-t border-white/10 space-y-2",children:[e.jsxs("div",{className:"text-[10px] text-obsidian-muted",children:["Inline comment on ",e.jsx("span",{className:"font-mono text-foreground",children:T.path})," ","line ",e.jsx("span",{className:"text-obsidian-info",children:T.newPosition||T.oldPosition})]}),e.jsx("textarea",{rows:3,value:T.body,onChange:d=>ve(f=>f&&{...f,body:d.target.value}),placeholder:"Write inline review comment...",className:"w-full bg-black/30 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground placeholder-obsidian-muted outline-none resize-y"}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>ve(null),disabled:At,className:"px-3 py-1.5 rounded text-[10px] border border-white/10 text-obsidian-muted hover:text-foreground",children:"Cancel"}),e.jsxs("button",{onClick:()=>lo(t.number),disabled:At||!T.body.trim(),className:"px-3 py-1.5 rounded text-[10px] border border-obsidian-info/30 bg-obsidian-info/20 text-obsidian-info hover:bg-obsidian-info/30 disabled:opacity-50 inline-flex items-center gap-1.5",children:[At&&e.jsx(C,{className:"w-3 h-3 animate-spin"}),"Submit Comment"]})]})]})]},l)})]}),oe===t.number&&e.jsxs("div",{className:"border-t border-white/5 bg-black/10 px-4 py-3",children:[e.jsx("div",{className:"text-[11px] font-semibold text-foreground mb-2",children:"Conversation"}),On?e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-obsidian-muted",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin text-obsidian-info"}),"Loading comments and reviews..."]}):Ws.length===0&&Gs.length===0&&Lt.length===0?e.jsx("div",{className:"text-[11px] text-obsidian-muted",children:"No comments or reviews yet."}):e.jsx("div",{className:"space-y-2",children:[...Ws.map(n=>{var l;return{kind:"comment",at:n.created_at||"",by:((l=n.user)==null?void 0:l.login)||"unknown",body:n.body||""}}),...Gs.map(n=>{var l;return{kind:"review",at:n.submitted_at||"",by:((l=n.user)==null?void 0:l.login)||"unknown",body:n.body||"",state:n.state||"REVIEWED"}}),...Lt.map(n=>{var l;return{kind:"inline",at:n.created_at||"",by:((l=n.user)==null?void 0:l.login)||"unknown",body:n.body||"",state:`INLINE ${n.path||""}:${n.new_position||n.old_position||"-"}`.trim()}})].sort((n,l)=>new Date(n.at).getTime()-new Date(l.at).getTime()).map((n,l)=>e.jsxs("div",{className:"rounded-md border border-white/10 bg-white/[0.02] p-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-obsidian-muted mb-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:n.by}),e.jsx("span",{children:n.kind==="review"?n.state||"REVIEWED":n.kind==="inline"?n.state||"INLINE":"COMMENTED"}),e.jsx("span",{className:"ml-auto",children:H(n.at)})]}),n.body?e.jsx("div",{className:"text-[11px] text-foreground/90 whitespace-pre-wrap",children:n.body}):e.jsx("div",{className:"text-[11px] text-obsidian-muted italic",children:"No message"})]},`${n.kind}-${l}`))})]})]},t.id)}),Hn&&e.jsx("div",{className:"px-4 py-3 flex justify-center border-b border-white/5",children:e.jsxs("button",{onClick:()=>{if(!r||$t)return;const[t,a]=r.full_name.split("/");G(t,a,ne,{page:Un+1,append:!0})},disabled:$t,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[$t&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more PRs"]})})]}):L==="issues"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-md",children:[["open","closed","all"].map(t=>e.jsx("button",{onClick:()=>{if(ta(t),!r)return;const[a,s]=r.full_name.split("/");Ye(a,s,t,{page:1})},className:v("px-2 py-1 rounded text-[10px] font-medium transition-all",ea===t?"bg-obsidian-info/20 text-obsidian-info":"text-obsidian-muted hover:text-foreground"),children:t.charAt(0).toUpperCase()+t.slice(1)},t)),e.jsxs("span",{className:"ml-auto text-[11px] text-obsidian-muted",children:[ye.length," issues"]})]}),ye.length===0?e.jsx("div",{className:"text-center py-10 text-obsidian-muted text-[11px]",children:"No issues"}):e.jsxs(e.Fragment,{children:[ye.map(t=>{var a;return e.jsx("div",{className:"px-4 py-3 border-b border-white/5 hover:bg-white/[0.02] transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ue,{className:v("w-4 h-4 mt-0.5",t.state==="open"?"text-obsidian-success":"text-obsidian-muted")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-[12px] font-medium text-foreground truncate",children:["#",t.number," ",t.title]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-obsidian-muted",children:[e.jsx("span",{children:t.state}),e.jsx("span",{children:((a=t.user)==null?void 0:a.login)||"unknown"}),e.jsx("span",{children:H(t.updated_at||t.created_at)}),(t.comments||0)>0&&e.jsxs("span",{className:"ml-auto flex items-center gap-1",children:[e.jsx(ss,{className:"w-3 h-3"}),t.comments]})]}),Array.isArray(t.labels)&&t.labels.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.labels.slice(0,4).map(s=>e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded font-medium",style:{backgroundColor:`#${s.color||"6c707e"}33`,color:`#${s.color||"6c707e"}`},children:s.name},s.id))})]})]})},t.id)}),Wn&&e.jsx("div",{className:"px-4 py-3 flex justify-center",children:e.jsxs("button",{onClick:()=>{if(!r||It)return;const[t,a]=r.full_name.split("/");Ye(t,a,ea,{page:zn+1,append:!0})},disabled:It,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[It&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more issues"]})})]})]}):L==="releases"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-md text-[11px] text-obsidian-muted",children:[Ne.length," release",Ne.length!==1?"s":""]}),Ne.length===0?e.jsx("div",{className:"text-center py-10 text-obsidian-muted text-[11px]",children:"No releases"}):e.jsxs(e.Fragment,{children:[Ne.map(t=>e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 hover:bg-white/[0.02] transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"w-4 h-4 text-obsidian-info"}),e.jsx("span",{className:"text-[12px] font-medium text-foreground",children:t.name||t.tag_name}),e.jsx("span",{className:"text-[10px] text-obsidian-muted font-mono",children:t.tag_name}),t.prerelease&&e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-obsidian-warning/15 text-obsidian-warning",children:"prerelease"}),t.draft&&e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-obsidian-border-active/30 text-obsidian-muted",children:"draft"}),e.jsx("span",{className:"ml-auto text-[10px] text-obsidian-muted",children:H(t.published_at||t.created_at||null)})]}),t.body&&e.jsx("p",{className:"mt-2 text-[11px] text-obsidian-muted whitespace-pre-wrap line-clamp-3",children:t.body})]},t.id)),Jn&&e.jsx("div",{className:"px-4 py-3 flex justify-center",children:e.jsxs("button",{onClick:()=>{if(!r||qt)return;const[t,a]=r.full_name.split("/");Kt(t,a,{page:Gn+1,append:!0})},disabled:qt,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[qt&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more releases"]})})]})]}):L==="branches"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-md transition-all active:scale-95",children:[e.jsxs("span",{className:"text-[11px] text-obsidian-muted",children:[F.length," branches"]}),e.jsxs("button",{onClick:()=>ra(!ia),className:"ml-auto flex items-center gap-1 px-2 py-1 bg-obsidian-info/15 text-obsidian-info rounded text-[10px] font-medium hover:bg-obsidian-info/25 transition-all active:scale-95",children:[e.jsx(nn,{className:"w-3.5 h-3.5"})," New Branch"]})]}),ia&&e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 bg-black/40 backdrop-blur-md space-y-2 transition-all active:scale-95",children:[e.jsx("input",{type:"text",placeholder:"Branch name...",value:ke,onChange:t=>la(t.target.value),className:"w-full bg-black/20 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground placeholder-obsidian-muted outline-none transition-all active:scale-95"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-obsidian-muted",children:"from"}),e.jsxs("select",{value:ca,onChange:t=>Vn(t.target.value),className:"flex-1 bg-black/20 border border-white/10 rounded px-2 py-1 text-[11px] text-foreground outline-none transition-all active:scale-95",children:[e.jsx("option",{value:"",children:(r==null?void 0:r.default_branch)||"main"}),F.map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))]}),e.jsx("button",{onClick:oo,disabled:!ke,className:"px-3 py-1 bg-obsidian-info text-white rounded text-[10px] font-medium hover:bg-obsidian-info disabled:opacity-40 transition-all active:scale-95",children:"Create"})]})]}),F.length===0?e.jsx("div",{className:"text-center py-8 text-obsidian-muted text-[11px]",children:"No branches"}):F.map(t=>{var a,s,o,n;return e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 hover:bg-white/[0.02] transition-all active:scale-95",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-3.5 h-3.5 text-obsidian-success shrink-0"}),e.jsx("span",{className:"text-[12px] text-foreground font-mono",children:t.name}),t.name===(r==null?void 0:r.default_branch)&&e.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded bg-obsidian-info/15 text-obsidian-info font-semibold uppercase transition-all active:scale-95",children:"default"}),t.protected&&e.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded bg-obsidian-warning/15 text-obsidian-warning font-semibold uppercase transition-all active:scale-95",children:"protected"})]}),e.jsxs("div",{className:"mt-1 text-[10px] text-obsidian-muted pl-5 truncate",children:[(s=(a=t.commit)==null?void 0:a.id)==null?void 0:s.slice(0,7)," — ",(n=(o=t.commit)==null?void 0:o.message)==null?void 0:n.split(`
`)[0]]}),e.jsxs("div",{className:"mt-1.5 flex items-center gap-1.5 pl-5",children:[e.jsx("button",{onClick:()=>et(t.name),disabled:N===t.name,className:"flex items-center gap-1 px-2 py-0.5 text-[9px] bg-obsidian-border-active text-foreground rounded hover:bg-obsidian-info/20 hover:text-obsidian-info disabled:opacity-40 disabled:cursor-default transition-colors active:scale-95",children:N===t.name?"✓ Active":"⇄ Switch"}),t.name!==(r==null?void 0:r.default_branch)&&!t.protected&&e.jsx("button",{onClick:()=>Ot(t.name),className:"flex items-center gap-1 px-2 py-0.5 text-[9px] bg-obsidian-danger/10 text-obsidian-danger rounded hover:bg-obsidian-danger/20 transition-colors active:scale-95",children:"🗑 Delete"})]})]},t.name)})]}):L==="tags"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-xl flex items-center justify-between shrink-0 overflow-x-auto custom-scrollbar",children:[te.length," tag",te.length!==1?"s":""]}),te.length===0?e.jsx("div",{className:"text-center py-8 text-obsidian-muted text-[11px]",children:"No tags"}):te.map(t=>{var a,s;return e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 hover:bg-white/[0.02] flex items-center gap-2 transition-all active:scale-95",children:[e.jsx(ot,{className:"w-3.5 h-3.5 text-obsidian-warning shrink-0"}),e.jsx("span",{className:"text-[12px] font-mono text-foreground",children:t.name}),e.jsx("span",{className:"ml-2 text-[10px] text-obsidian-muted font-mono",children:(s=(a=t.commit)==null?void 0:a.sha)==null?void 0:s.slice(0,7)}),t.tarball_url&&e.jsx("a",{href:t.tarball_url,className:"ml-auto text-[9px] text-obsidian-info hover:underline",download:!0,children:"↓ tarball"})]},t.name)}),An&&e.jsx("div",{className:"px-4 py-3 flex justify-center border-b border-white/5",children:e.jsxs("button",{onClick:()=>{if(!r||wt)return;const[t,a]=r.full_name.split("/");Vt(t,a,{page:Mn+1,append:!0})},disabled:wt,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[wt&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more tags"]})})]}):L==="actions"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[ht.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-obsidian-muted gap-2",children:[e.jsx(en,{className:"w-8 h-8 opacity-30"}),e.jsx("span",{className:"text-[12px]",children:"No workflow runs"})]}):ht.map(t=>e.jsxs("div",{className:"border-b border-white/5",children:[e.jsxs("div",{className:v("px-4 py-2.5 hover:bg-white/[0.02] transition-all active:scale-95 cursor-pointer",Be===t.id&&"bg-white/[0.03]"),onClick:()=>{if(!r)return;const[a,s]=r.full_name.split("/");if(Be===t.id){Me(null),he([]);return}Me(t.id),Xn(a,s,t.id)},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(Nn,{status:t.status||"unknown",conclusion:t.conclusion}),e.jsx("span",{className:"text-[11px] text-foreground font-medium truncate",children:t.name||`Run #${t.id}`})]}),e.jsx("span",{className:"text-[10px] text-obsidian-muted shrink-0 ml-2",children:H(t.updated_at||t.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-obsidian-muted pl-1",children:[t.head_branch&&e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx(me,{className:"w-2.5 h-2.5"}),t.head_branch]}),t.run_number&&e.jsxs("span",{children:["#",t.run_number]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1.5",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),ja(t.id,"rerun")},disabled:!!(B&&B.runId===t.id),className:"px-2 py-0.5 rounded border border-obsidian-info/30 bg-obsidian-info/10 text-obsidian-info hover:bg-obsidian-info/20 disabled:opacity-50 text-[9px]",children:(B==null?void 0:B.runId)===t.id&&B.action==="rerun"?"Running...":"Re-run"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),ja(t.id,"cancel")},disabled:!!(B&&B.runId===t.id),className:"px-2 py-0.5 rounded border border-obsidian-danger/30 bg-obsidian-danger/10 text-obsidian-danger hover:bg-obsidian-danger/20 disabled:opacity-50 text-[9px]",children:(B==null?void 0:B.runId)===t.id&&B.action==="cancel"?"Cancelling...":"Cancel"}),e.jsx("span",{className:"text-[9px] text-obsidian-info",children:Be===t.id?"Hide details":"View details"})]})]})]}),Be===t.id&&e.jsx("div",{className:"px-4 pb-3 bg-white/[0.01] border-t border-white/5",children:Ln?e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-obsidian-muted py-2",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin text-obsidian-info"}),"Loading run details..."]}):bs.length===0?e.jsx("div",{className:"text-[11px] text-obsidian-muted py-2",children:"No job details returned by Gitea for this run."}):e.jsx("div",{className:"space-y-2 pt-2",children:bs.map((a,s)=>e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsx("span",{className:"font-medium text-foreground",children:a.name||`Job ${s+1}`}),e.jsx(Nn,{status:a.status||"unknown",conclusion:a.conclusion}),a.runner_name&&e.jsx("span",{className:"ml-auto text-[10px] text-obsidian-muted",children:a.runner_name})]}),Array.isArray(a.steps)&&a.steps.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:a.steps.map((o,n)=>e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-obsidian-muted",children:[e.jsx("span",{className:"w-4 text-right",children:o.number??n+1}),e.jsx("span",{className:"text-foreground/90",children:o.name||`Step ${n+1}`}),e.jsx("span",{className:"ml-auto",children:o.conclusion||o.status||"unknown"})]},`${o.number||n}`))})]},`${a.id||s}`))})})]},t.id)),Tn&&e.jsx("div",{className:"px-4 py-3 flex justify-center",children:e.jsxs("button",{onClick:()=>{if(!r||ft)return;const[t,a]=r.full_name.split("/");ce(t,a,{page:Rn+1,append:!0})},disabled:ft,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[ft&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more runs"]})})]}):L==="security"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"px-4 py-3 border-b border-white/5 bg-black/20 backdrop-blur-md",children:e.jsxs("div",{className:"text-[12px] font-semibold text-foreground flex items-center gap-2",children:[e.jsx(hn,{className:"w-4 h-4 text-obsidian-warning"}),"Branch Protection"]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[12px] text-foreground font-medium mb-1",children:"Target Branch"}),e.jsxs("div",{className:"text-[11px] text-obsidian-muted",children:["Default branch:",e.jsx("span",{className:"font-mono text-foreground ml-1",children:(r==null?void 0:r.default_branch)||"main"}),e.jsx("span",{className:"ml-2 text-obsidian-info",children:Xs?"(existing rule)":"(new rule)"})]})]}),ze?e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4 text-[11px] text-obsidian-muted flex items-center gap-2",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin text-obsidian-info"}),"Loading branch protection..."]}):e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4 space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!$.enable_status_check,onChange:t=>D(a=>({...a,enable_status_check:t.target.checked}))}),"Enable required status checks"]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted",children:"Status check contexts (comma separated)"}),e.jsx("input",{value:Zs,onChange:t=>Et(t.target.value),placeholder:"build, test, lint",className:"w-full bg-black/30 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted",children:"Required approvals"}),e.jsx("input",{type:"number",min:0,value:$.required_approvals??1,onChange:t=>D(a=>({...a,required_approvals:Number(t.target.value||0)})),className:"w-full bg-black/30 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground outline-none"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground mt-5",children:[e.jsx("input",{type:"checkbox",checked:!!$.dismiss_stale_approvals,onChange:t=>D(a=>({...a,dismiss_stale_approvals:t.target.checked}))}),"Dismiss stale approvals"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!$.block_on_rejected_reviews,onChange:t=>D(a=>({...a,block_on_rejected_reviews:t.target.checked}))}),"Block on rejected reviews"]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!$.block_on_outdated_branch,onChange:t=>D(a=>({...a,block_on_outdated_branch:t.target.checked}))}),"Block on outdated branch"]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!$.enable_force_push,onChange:t=>D(a=>({...a,enable_force_push:t.target.checked}))}),"Allow force push"]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!$.require_signed_commits,onChange:t=>D(a=>({...a,require_signed_commits:t.target.checked}))}),"Require signed commits"]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!$.block_on_official_review_requests,onChange:t=>D(a=>({...a,block_on_official_review_requests:t.target.checked}))}),"Block on official review requests"]})]}),Ys&&e.jsx("div",{className:"rounded border border-obsidian-danger/30 bg-obsidian-danger/10 px-2 py-1.5 text-[11px] text-obsidian-danger",children:Ys}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-1",children:[e.jsx("button",{onClick:()=>{if(!r)return;const[t,a]=r.full_name.split("/");$e(t,a,r.default_branch||"main")},disabled:ze||We,className:"px-3 py-1.5 rounded-md text-[11px] border border-white/10 text-obsidian-muted hover:text-foreground hover:bg-white/[0.04] disabled:opacity-50",children:"Reload"}),Xs&&e.jsx("button",{onClick:ho,disabled:ze||We,className:"px-3 py-1.5 rounded-md text-[11px] border border-obsidian-danger/30 bg-obsidian-danger/10 text-obsidian-danger hover:bg-obsidian-danger/20 disabled:opacity-50",children:"Delete Rule"}),e.jsxs("button",{onClick:po,disabled:ze||We,className:"px-3 py-1.5 rounded-md text-[11px] border border-obsidian-info/30 bg-obsidian-info/20 text-obsidian-info hover:bg-obsidian-info/30 disabled:opacity-50 inline-flex items-center gap-1.5",children:[We&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Save Rules"]})]})]}),e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[12px] text-foreground font-medium mb-1",children:"PR Conflict Handling"}),e.jsx("div",{className:"text-[11px] text-obsidian-muted",children:'PR detayında merge conflict olursa "Update Branch (rebase/merge)" aksiyonları aktif.'})]})]})]}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"px-4 py-3 border-b border-white/5 bg-black/20 backdrop-blur-md",children:e.jsxs("div",{className:"text-[12px] font-semibold text-foreground flex items-center gap-2",children:[e.jsx(tn,{className:"w-4 h-4 text-obsidian-info"}),"Repository Insights"]})}),e.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted mb-1",children:"COMMITS (LOADED)"}),e.jsx("div",{className:"text-[20px] font-semibold text-foreground",children:M.length})]}),e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted mb-1",children:"OPEN PRs"}),e.jsx("div",{className:"text-[20px] font-semibold text-foreground",children:Ie.filter(t=>t.state==="open"&&!t.merged).length})]}),e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted mb-1",children:"OPEN ISSUES"}),e.jsx("div",{className:"text-[20px] font-semibold text-foreground",children:ye.filter(t=>t.state==="open").length})]})]})]})})]}):e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center gap-4 text-obsidian-muted",children:x==="offline"?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(q,{className:"w-12 h-12 opacity-40",style:{color:"#a78bfa"}}),e.jsx("p",{className:"text-[13px] text-obsidian-muted",children:"Gitea is not running"}),e.jsx("code",{className:"text-[10px] text-obsidian-danger font-mono bg-obsidian-panel rounded px-3 py-1.5 transition-all active:scale-95",children:"docker compose up -d gitea"}),e.jsx("button",{onClick:()=>{Qe(),Xe()},className:"px-4 py-1.5 bg-obsidian-danger/15 text-obsidian-danger rounded text-[11px] font-medium hover:bg-obsidian-danger/25 transition-all active:scale-95",children:"Retry"})]}):pe?e.jsx(C,{className:"w-6 h-6 text-obsidian-danger animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-12 h-12 opacity-20"}),e.jsx("p",{className:"text-[14px] text-obsidian-muted font-medium",children:"Select a repository"}),e.jsx("p",{className:"text-[11px] max-w-[280px] text-center leading-relaxed",children:"Choose a repository from the sidebar to browse files, view commits, manage branches, and track CI/CD runs."})]})})})})]}),le&&e.jsx("div",{className:"absolute inset-0 z-[120] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-xl border border-white/10 bg-[#101114] shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-white/10",children:[e.jsx("div",{className:"text-[13px] font-semibold text-foreground",children:"Delete branch?"}),e.jsxs("div",{className:"text-[11px] text-obsidian-muted mt-1",children:["Branch ",e.jsx("span",{className:"font-mono text-foreground",children:le})," kalici olarak silinecek."]})]}),e.jsxs("div",{className:"px-4 py-3 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>Ot(null),disabled:zt===le,className:"px-3 py-1.5 rounded-md text-[11px] border border-white/10 text-obsidian-muted hover:text-foreground hover:bg-white/[0.04] disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{onClick:async()=>{const t=le;Ot(null),t&&await Zn(t)},disabled:zt===le,className:"px-3 py-1.5 rounded-md text-[11px] border border-obsidian-danger/40 bg-obsidian-danger/20 text-obsidian-danger hover:bg-obsidian-danger/30 disabled:opacity-50 inline-flex items-center gap-1.5",children:[zt===le&&e.jsx(C,{className:"w-3 h-3 animate-spin"}),"Delete Branch"]})]})]})}),Y&&e.jsx("div",{className:"absolute inset-0 z-[125] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-lg rounded-xl border border-white/10 bg-[#101114] shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-white/10",children:e.jsx("div",{className:"text-[13px] font-semibold text-foreground",children:Y.title})}),e.jsx("div",{className:"p-4",children:e.jsx("textarea",{value:xa,onChange:t=>Ce(t.target.value),placeholder:Y.placeholder,className:"w-full h-36 bg-black/30 border border-white/10 rounded px-3 py-2 text-[11px] text-foreground outline-none resize-none"})}),e.jsxs("div",{className:"px-4 py-3 border-t border-white/10 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>{Ve(null),Ce("")},className:"px-3 py-1.5 rounded-md text-[11px] border border-white/10 text-obsidian-muted hover:text-foreground hover:bg-white/[0.04]",children:"Cancel"}),e.jsx("button",{onClick:uo,className:"px-3 py-1.5 rounded-md text-[11px] border border-obsidian-info/30 bg-obsidian-info/20 text-obsidian-info hover:bg-obsidian-info/30",children:"Submit Review"})]})]})}),I&&e.jsx("div",{className:"absolute right-4 bottom-4 z-[130] max-w-md",children:e.jsxs("div",{className:v("flex items-start gap-2 rounded-lg border px-3 py-2 shadow-2xl backdrop-blur-md",I.tone==="success"&&"border-obsidian-success/40 bg-obsidian-success/15 text-obsidian-success",I.tone==="error"&&"border-obsidian-danger/40 bg-obsidian-danger/15 text-obsidian-danger",I.tone==="info"&&"border-obsidian-info/40 bg-obsidian-info/15 text-obsidian-info"),children:[I.tone==="success"?e.jsx(lt,{className:"w-4 h-4 mt-0.5 shrink-0"}):I.tone==="error"?e.jsx(ue,{className:"w-4 h-4 mt-0.5 shrink-0"}):e.jsx(ue,{className:"w-4 h-4 mt-0.5 shrink-0"}),e.jsx("div",{className:"text-[11px] leading-5",children:I.message}),e.jsx("button",{onClick:()=>E(null),className:"ml-1 text-current/80 hover:text-current","aria-label":"Dismiss notification",children:e.jsx(cn,{className:"w-3.5 h-3.5"})})]})})]})}export{pi as default};
