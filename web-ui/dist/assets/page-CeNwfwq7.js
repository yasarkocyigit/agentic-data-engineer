import{r as i,R as Qa,j as e}from"./index-CcXpoZej.js";import{c as te,k as Xa,G as X,i as be,P as Ya,B as Za,S as ho,e as v,M as bo,b as fo,m as ns,h as it,n as go,l as yn,f as en,F as ct}from"./Sidebar--sQWCiQF.js";import{C as wo,F as tn,P as sn}from"./index-w8aIcREP.js";import{C as fe}from"./circle-alert-CXBOc5pp.js";import{L as jo}from"./layout-panel-left-Dg980y9u.js";import{R as an}from"./refresh-cw-CXkMaxss.js";import{M as nn}from"./minimize-2-BgC8Kc6L.js";import{E as on}from"./external-link-CeIcI3rx.js";import{L as C}from"./loader-circle-DTiCSUKX.js";import{C as Zt}from"./code-xml-BImr0CmV.js";import{X as rn}from"./x-Bvf5J2ZL.js";import{C as es}from"./chevron-down-B_PkHte5.js";import{C as Nn}from"./clock-dthER2hL.js";import{M as ln,r as cn}from"./index-CCMhwwuo.js";import{h as dn}from"./prism-BwnlqzRt.js";import{E as vo}from"./eye-q8FvYjmY.js";import{T as yo}from"./tag-WcJ0EJgB.js";import{T as No}from"./trash-2-B4G_OQpN.js";import{A as xn}from"./arrow-up-right-BdoiDzJe.js";import{C as dt}from"./circle-check-D8kGCXJg.js";import{C as Re}from"./circle-x-CMb7SxeV.js";/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],Co=te("clipboard",ko);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],ts=te("git-commit-horizontal",_o);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],os=te("git-merge",So);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ss=te("message-square",$o);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],mn=te("package-open",Po);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],un=te("scale",Ro);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],rt=te("star",To),pn={'pre[class*="language-"]':{color:"#d4d4d4",fontSize:"13px",textShadow:"none",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",padding:"1em",margin:".5em 0",overflow:"auto",background:"#1e1e1e"},'code[class*="language-"]':{color:"#d4d4d4",fontSize:"13px",textShadow:"none",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]::selection':{textShadow:"none",background:"#264F78"},'code[class*="language-"]::selection':{textShadow:"none",background:"#264F78"},'pre[class*="language-"] *::selection':{textShadow:"none",background:"#264F78"},'code[class*="language-"] *::selection':{textShadow:"none",background:"#264F78"},':not(pre) > code[class*="language-"]':{padding:".1em .3em",borderRadius:".3em",color:"#db4c69",background:"#1e1e1e"},".namespace":{Opacity:".7"},"doctype.doctype-tag":{color:"#569CD6"},"doctype.name":{color:"#9cdcfe"},comment:{color:"#6a9955"},prolog:{color:"#6a9955"},punctuation:{color:"#d4d4d4"},".language-html .language-css .token.punctuation":{color:"#d4d4d4"},".language-html .language-javascript .token.punctuation":{color:"#d4d4d4"},property:{color:"#9cdcfe"},tag:{color:"#569cd6"},boolean:{color:"#569cd6"},number:{color:"#b5cea8"},constant:{color:"#9cdcfe"},symbol:{color:"#b5cea8"},inserted:{color:"#b5cea8"},unit:{color:"#b5cea8"},selector:{color:"#d7ba7d"},"attr-name":{color:"#9cdcfe"},string:{color:"#ce9178"},char:{color:"#ce9178"},builtin:{color:"#ce9178"},deleted:{color:"#ce9178"},".language-css .token.string.url":{textDecoration:"underline"},operator:{color:"#d4d4d4"},entity:{color:"#569cd6"},"operator.arrow":{color:"#569CD6"},atrule:{color:"#ce9178"},"atrule.rule":{color:"#c586c0"},"atrule.url":{color:"#9cdcfe"},"atrule.url.function":{color:"#dcdcaa"},"atrule.url.punctuation":{color:"#d4d4d4"},keyword:{color:"#569CD6"},"keyword.module":{color:"#c586c0"},"keyword.control-flow":{color:"#c586c0"},function:{color:"#dcdcaa"},"function.maybe-class-name":{color:"#dcdcaa"},regex:{color:"#d16969"},important:{color:"#569cd6"},italic:{fontStyle:"italic"},"class-name":{color:"#4ec9b0"},"maybe-class-name":{color:"#4ec9b0"},console:{color:"#9cdcfe"},parameter:{color:"#9cdcfe"},interpolation:{color:"#9cdcfe"},"punctuation.interpolation-punctuation":{color:"#569cd6"},variable:{color:"#9cdcfe"},"imports.maybe-class-name":{color:"#9cdcfe"},"exports.maybe-class-name":{color:"#9cdcfe"},escape:{color:"#d7ba7d"},"tag.punctuation":{color:"#808080"},cdata:{color:"#808080"},"attr-value":{color:"#ce9178"},"attr-value.punctuation":{color:"#ce9178"},"attr-value.punctuation.attr-equals":{color:"#d4d4d4"},namespace:{color:"#4ec9b0"},'pre[class*="language-javascript"]':{color:"#9cdcfe"},'code[class*="language-javascript"]':{color:"#9cdcfe"},'pre[class*="language-jsx"]':{color:"#9cdcfe"},'code[class*="language-jsx"]':{color:"#9cdcfe"},'pre[class*="language-typescript"]':{color:"#9cdcfe"},'code[class*="language-typescript"]':{color:"#9cdcfe"},'pre[class*="language-tsx"]':{color:"#9cdcfe"},'code[class*="language-tsx"]':{color:"#9cdcfe"},'pre[class*="language-css"]':{color:"#ce9178"},'code[class*="language-css"]':{color:"#ce9178"},'pre[class*="language-html"]':{color:"#d4d4d4"},'code[class*="language-html"]':{color:"#d4d4d4"},".language-regex .token.anchor":{color:"#dcdcaa"},".language-html .token.punctuation":{color:"#808080"},'pre[class*="language-"] > code[class*="language-"]':{position:"relative",zIndex:"1"},".line-highlight.line-highlight":{background:"#f7ebc6",boxShadow:"inset 5px 0 0 #f7d87c",zIndex:"0"}};function Lo(){var x;if(typeof window<"u"){const m=(x=window.__OPENCLAW_GITEA_URL__)==null?void 0:x.trim();return m||`${window.location.protocol}//${window.location.hostname}:3030`}return"http://localhost:3030"}function Bo(x){try{return new URL(x).hostname}catch{return typeof window<"u"?window.location.hostname:"localhost"}}function Mo(x){if(typeof window<"u"){const m=window.__OPENCLAW_GITEA_SSH_PORT__;if(m!=null){const u=Number(m);if(Number.isFinite(u)&&u>0)return u}}try{const m=new URL(x).hostname;if(m==="localhost"||m==="127.0.0.1")return 2222}catch{}return 22}const xt=Lo(),hn=Bo(xt),bn=Mo(xt);function Eo(x){const m=x.split(`
`),u=[];let w=0,b=0;for(const j of m){if(j.startsWith("@@")){const _=j.match(/^@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@/);w=_?Number(_[1]):0,b=_?Number(_[2]):0,u.push({text:j,oldPosition:0,newPosition:0,kind:"hunk"});continue}if(j.startsWith("+")&&!j.startsWith("+++")){u.push({text:j,oldPosition:0,newPosition:b,kind:"add"}),b+=1;continue}if(j.startsWith("-")&&!j.startsWith("---")){u.push({text:j,oldPosition:w,newPosition:0,kind:"del"}),w+=1;continue}if(j.startsWith("diff --git")||j.startsWith("index ")||j.startsWith("--- ")||j.startsWith("+++ ")){u.push({text:j,oldPosition:0,newPosition:0,kind:"meta"});continue}if(w>0||b>0){u.push({text:j,oldPosition:w,newPosition:b,kind:"ctx"}),w+=1,b+=1;continue}u.push({text:j,oldPosition:0,newPosition:0,kind:"ctx"})}return u}function H(x){if(!x)return"—";const m=Date.now(),u=new Date(x).getTime(),w=m-u;if(w<0)return"soon";const b=Math.floor(w/1e3);if(b<60)return`${b}s ago`;const j=Math.floor(b/60);if(j<60)return`${j}m ago`;const _=Math.floor(j/60);return _<24?`${_}h ago`:`${Math.floor(_/24)}d ago`}function Ao(x){var u;const m=(u=x.split(".").pop())==null?void 0:u.toLowerCase();return m?["py"].includes(m)?ct:["ts","tsx","js","jsx","json","yml","yaml","toml","sh","html","css"].includes(m)?ct:["md","txt","csv","log"].includes(m)?yn:ns:ns}function as(x){var b;const m=((b=x.split(".").pop())==null?void 0:b.toLowerCase())||"",u=x.toLowerCase(),w={py:"python",ts:"typescript",tsx:"tsx",js:"javascript",jsx:"jsx",json:"json",yml:"yaml",yaml:"yaml",md:"markdown",mdx:"markdown",sh:"bash",bash:"bash",zsh:"bash",fish:"bash",sql:"sql",html:"html",htm:"html",css:"css",scss:"scss",less:"less",xml:"xml",svg:"xml",toml:"toml",ini:"ini",cfg:"ini",rs:"rust",go:"go",java:"java",kt:"kotlin",swift:"swift",rb:"ruby",php:"php",cs:"csharp",cpp:"cpp",c:"c",h:"c",r:"r",lua:"lua",perl:"perl",ps1:"powershell",dockerfile:"docker",makefile:"makefile",cmake:"cmake",graphql:"graphql",gql:"graphql",proto:"protobuf",tf:"hcl",hcl:"hcl",env:"bash"};return u==="dockerfile"||u.startsWith("dockerfile.")?"docker":u==="makefile"?"makefile":u===".gitignore"||u===".dockerignore"||u===".env"||u===".env.example"?"bash":w[m]||"text"}function fn(x){var u;const m=(u=x.split(".").pop())==null?void 0:u.toLowerCase();return m==="md"||m==="mdx"}function Do(x){var u;const m=(u=x.split(".").pop())==null?void 0:u.toLowerCase();return["png","jpg","jpeg","gif","svg","webp","ico","bmp"].includes(m||"")}function gn(x){var w;const m=(w=x.split(".").pop())==null?void 0:w.toLowerCase();return m&&{py:"#4e94c0",ts:"#4b8ec2",tsx:"#4b8ec2",js:"#b8a84e",jsx:"#b8a84e",json:"#8a9a6e",yml:"#8a6ea0",yaml:"#8a6ea0",md:"#6ea870",sh:"#6ea870",bash:"#6ea870",sql:"#82aaff",html:"#c07a60",css:"#6e6ea0",dockerfile:"#4e8a7e",gitignore:"#6c707e",env:"#6c707e"}[m]||"#6c707e"}function Fo(x){return x<1024?`${x} B`:x<1024*1024?`${(x/1024).toFixed(1)} KB`:`${(x/(1024*1024)).toFixed(1)} MB`}const Io={Python:"#3572A5",TypeScript:"#3178c6",JavaScript:"#f1e05a",HTML:"#e34c26",CSS:"#563d7c",Shell:"#89e051",Go:"#00ADD8",Rust:"#dea584",Java:"#b07219",Ruby:"#701516",PHP:"#4F5D95",Swift:"#F05138",Kotlin:"#A97BFF","C#":"#178600",C:"#555555","C++":"#f34b7d",Dockerfile:"#384d54",YAML:"#cb171e",JSON:"#292929",Makefile:"#427819",SQL:"#e38c00",Lua:"#000080",R:"#198CE7",Scala:"#c22d40",HCL:"#844FBA",Perl:"#0298c3",Markdown:"#083fa1"};async function wn(x,m=1e4){const u=new AbortController,w=window.setTimeout(()=>u.abort(),m);try{const b=await fetch(x,{signal:u.signal});if(!b.ok)throw new Error(`${b.status} ${b.statusText}`);return await b.json()}finally{window.clearTimeout(w)}}function jn(x){const m=new TextEncoder().encode(x);let u="";const w=32768;for(let b=0;b<m.length;b+=w)u+=String.fromCharCode(...m.subarray(b,b+w));return btoa(u)}function mt(x){return(x||"unknown").toLowerCase()}function Pe(x){const m=mt(x);return m==="failure"||m==="error"||m==="failed"}function lt(x){const m=mt(x);return m==="success"?{bg:"bg-obsidian-success/10",text:"text-obsidian-success",border:"border-obsidian-success/20"}:m==="pending"||m==="running"||m==="waiting"?{bg:"bg-obsidian-warning/10",text:"text-obsidian-warning",border:"border-obsidian-warning/20"}:Pe(m)?{bg:"bg-obsidian-danger/10",text:"text-obsidian-danger",border:"border-obsidian-danger/20"}:{bg:"bg-obsidian-border-active/30",text:"text-obsidian-muted",border:"border-white/10"}}function Uo({status:x}){return x==="checking"?e.jsxs("div",{className:"flex items-center gap-1 text-obsidian-muted",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),e.jsx("span",{className:"text-[10px]",children:"Checking..."})]}):x==="online"?e.jsxs("div",{className:"flex items-center gap-1 text-obsidian-success",children:[e.jsx(dt,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[10px]",children:"Connected"})]}):e.jsxs("div",{className:"flex items-center gap-1 text-obsidian-danger",children:[e.jsx(fe,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[10px]",children:"Offline"})]})}function vn({status:x,conclusion:m}){const u=m||x,w={success:{bg:"bg-obsidian-success/10",text:"text-obsidian-success",border:"border-obsidian-success/20",icon:dt},failure:{bg:"bg-obsidian-danger/10",text:"text-obsidian-danger",border:"border-obsidian-danger/20",icon:Re},running:{bg:"bg-obsidian-info/10",text:"text-obsidian-info",border:"border-obsidian-info/20",icon:C},waiting:{bg:"bg-obsidian-warning/10",text:"text-obsidian-warning",border:"border-obsidian-warning/20",icon:Nn},cancelled:{bg:"bg-obsidian-muted/10",text:"text-obsidian-muted",border:"border-obsidian-muted/20",icon:Re}},b=w[u]||w.waiting,j=b.icon;return e.jsxs("span",{className:v("inline-flex items-center gap-1.5 rounded-md px-2 py-0.5 text-[10px] font-medium border",b.bg,b.text,b.border),children:[e.jsx(j,{className:v("w-3 h-3",u==="running"&&"animate-spin")}),u.charAt(0).toUpperCase()+u.slice(1)]})}function Ho({pr:x}){return x.merged?e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md px-2 py-0.5 text-[10px] font-medium border bg-obsidian-primary/10 text-obsidian-primary border-obsidian-primary/20 transition-all active:scale-95",children:[e.jsx(os,{className:"w-3.5 h-3.5"})," Merged"]}):x.state==="closed"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md px-2 py-0.5 text-[10px] font-medium border bg-obsidian-danger/10 text-obsidian-danger border-obsidian-danger/20 transition-all active:scale-95",children:[e.jsx(Re,{className:"w-3.5 h-3.5"})," Closed"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-md px-2 py-0.5 text-[10px] font-medium border bg-obsidian-success/10 text-obsidian-success border-obsidian-success/20 transition-all active:scale-95",children:[e.jsx(X,{className:"w-3.5 h-3.5"})," Open"]})}function qo({patch:x,filename:m}){if(!x)return e.jsx("div",{className:"px-4 py-2 text-[10px] text-obsidian-muted italic",children:"No diff available"});const u=x.split(`
`);return e.jsx("div",{className:"font-mono text-[11px] leading-[18px] overflow-x-auto",children:u.map((w,b)=>{let j="",_="#bcbec4";return w.startsWith("+")&&!w.startsWith("+++")?(j="bg-[#1a3a2a]",_="#6aab73"):w.startsWith("-")&&!w.startsWith("---")?(j="bg-[#3a1a1a]",_="#ff5261"):w.startsWith("@@")&&(j="bg-[#1a2a3a]",_="#3574f0"),e.jsx("div",{className:v("px-4 py-0 whitespace-pre",j),style:{color:_},children:w},`${m}-${b}`)})})}function mi(){var Na,ka,Ca,_a,Sa,$a,Pa,Ra,Ta,La,Ba,Ma,Ea,Aa,Da,Fa,Ia,Ua,Ha,qa,Oa,za,Wa,Ga,Ja,Va,Ka;const[x,m]=i.useState("checking"),[u,w]=i.useState(""),[b,j]=i.useState([]),[_,Te]=i.useState(!0),[Oo,ut]=i.useState(null),[Le,kn]=i.useState(""),[is,Cn]=i.useState(!1),[r,pt]=i.useState(null),[L,ht]=i.useState("files"),[F,rs]=i.useState([]),[M,ls]=i.useState([]),[_n,bt]=i.useState(1),[Sn,Be]=i.useState(!1),[ft,cs]=i.useState(!1),[gt,ds]=i.useState([]),[$n,xs]=i.useState(1),[Pn,wt]=i.useState(!1),[jt,ms]=i.useState(!1),[Me,ge]=i.useState(null),[us,se]=i.useState([]),[Rn,ps]=i.useState(!1),[B,hs]=i.useState(null),[Tn,bs]=i.useState(!1),[N,fs]=i.useState(""),[zo,gs]=i.useState(!1),[ae,ws]=i.useState([]),[Ln,js]=i.useState(1),[Bn,vt]=i.useState(!1),[yt,vs]=i.useState(!1),[ne,Ee]=i.useState({}),[q,Ae]=i.useState(""),[ys,Nt]=i.useState(null),[$,O]=i.useState(null),[kt,z]=i.useState(""),[Mn,De]=i.useState(!1),[Ct,Ns]=i.useState(!0),[_t,Fe]=i.useState(!1),[St,ks]=i.useState(""),[we,Cs]=i.useState(""),[Ie,_s]=i.useState(""),[Ss,$s]=i.useState(!1),[R,oe]=i.useState(null),[En,Ps]=i.useState(!1),[ie,$t]=i.useState(new Set),An=Qa.useRef(null),Rs=(t,a)=>{An.current=t,a.editor.defineTheme("obsidian",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"546e7a",fontStyle:"italic"},{token:"keyword",foreground:"c792ea",fontStyle:"bold"},{token:"string",foreground:"c3e88d"},{token:"number",foreground:"f78c6c"},{token:"operator",foreground:"89ddff"},{token:"identifier",foreground:"eeffff"},{token:"function",foreground:"82aaff"},{token:"class.identifier",foreground:"ffcb6b"},{token:"type.identifier",foreground:"ffcb6b"},{token:"delimiter",foreground:"eeffff"}],colors:{"editor.background":"#111113","editor.foreground":"#eeffff","editor.selectionBackground":"#2d4264","editor.lineHighlightBackground":"#1a1a1e","editorCursor.foreground":"#818cf8","editorWhitespace.foreground":"#2a2a30","editorIndentGuide.background1":"#2a2a30","editorLineNumber.foreground":"#3a3a4a","editorLineNumber.activeForeground":"#6b7280"}}),a.editor.setTheme("obsidian")},[Ue,Ts]=i.useState([]),[re,Dn]=i.useState("all"),[Fn,Ls]=i.useState(1),[In,Pt]=i.useState(!1),[Rt,Bs]=i.useState(!1),[Ms,Tt]=i.useState(!1),[le,He]=i.useState(null),[E,Y]=i.useState(null),[Un,Es]=i.useState(!1),[qe,As]=i.useState(""),[Ds,Fs]=i.useState(""),[Oe,Is]=i.useState(""),[ze,Us]=i.useState(""),[W,G]=i.useState("unknown"),[je,J]=i.useState([]),[Lt,Hs]=i.useState(!1),[qs,ce]=i.useState([]),[Os,de]=i.useState([]),[Bt,Mt]=i.useState([]),[Hn,zs]=i.useState(!1),[We,xe]=i.useState(null),[Et,Ws]=i.useState(!1),[T,ve]=i.useState(null),[At,Gs]=i.useState(!1),[Ge,Js]=i.useState(!1),[Je,Ve]=i.useState(!1),[Vs,Ke]=i.useState(!1),[Ks,V]=i.useState(null),[P,D]=i.useState({enable_status_check:!0,status_check_contexts:[],required_approvals:1,dismiss_stale_approvals:!0,block_on_rejected_reviews:!0,block_on_outdated_branch:!0,block_on_official_review_requests:!1,enable_force_push:!1,require_signed_commits:!1}),[Qs,Dt]=i.useState(""),[ye,Ft]=i.useState([]),[Xs,Ys]=i.useState("open"),[qn,Zs]=i.useState(1),[On,It]=i.useState(!1),[Ut,ea]=i.useState(!1),[Ne,Ht]=i.useState([]),[zn,ta]=i.useState(1),[Wn,qt]=i.useState(!1),[Ot,sa]=i.useState(!1),[aa,na]=i.useState(!1),[ke,oa]=i.useState(""),[ia,Gn]=i.useState(""),[me,zt]=i.useState(null),[Wt,ra]=i.useState(null),[I,A]=i.useState(null),[Z,Qe]=i.useState(null),[la,Ce]=i.useState(""),[Gt,Jt]=i.useState({}),[ca,Vt]=i.useState([]),[da,Jn]=i.useState(!1),[Vn,xa]=i.useState(null),_e=i.useRef(0),Xe=i.useRef(0);i.useEffect(()=>{if(!I)return;const t=window.setTimeout(()=>A(null),3500);return()=>window.clearTimeout(t)},[I]);const y=i.useCallback(t=>{A({tone:"error",message:t})},[]),ee=i.useCallback(t=>{A({tone:"success",message:t})},[]),Ye=i.useCallback(async()=>{m("checking");try{const t=await wn("/api/gitea/health",8e3);t.status==="online"?(m("online"),w(t.version||"")):m("offline")}catch(t){console.error("[CICD] health check failed:",t),m("offline")}},[]),Ze=i.useCallback(async()=>{Te(!0);try{const t=await wn("/api/gitea/repos?limit=50",1e4);j(t.repos||[]),ut(null)}catch(t){ut(t instanceof Error?t.message:"Failed to fetch repos")}finally{Te(!1)}},[]),Se=i.useCallback(async(t,a)=>{try{const o=await(await fetch(`/api/gitea/repos/${t}/${a}/branches`)).json();rs(o.branches||[])}catch(s){console.error("[CICD] fetchBranches failed:",s),rs([])}},[]),Kt=i.useCallback(async(t,a,s)=>{const o=(s==null?void 0:s.page)??1,n=!!(s!=null&&s.append),l=20;n&&vs(!0);try{const d=await(await fetch(`/api/gitea/repos/${t}/${a}/tags?limit=${l}&page=${o}`)).json(),f=Array.isArray(d)?d:d.tags||[];ws(p=>{if(!n)return f;const g=new Set(p.map(h=>h.name)),S=[...p];for(const h of f)g.has(h.name)||S.push(h);return S}),js(o),vt(Array.isArray(f)&&f.length===l)}catch(c){console.error("[CICD] fetchTags failed:",c),n||(ws([]),vt(!1))}finally{n&&vs(!1)}},[]),U=i.useCallback(async(t,a,s,o)=>{const n=(o==null?void 0:o.page)??1,l=!!(o!=null&&o.append),c=30;l&&cs(!0);try{const d=s?`&sha=${encodeURIComponent(s)}`:"",g=(await(await fetch(`/api/gitea/repos/${t}/${a}/commits?limit=${c}&page=${n}${d}`)).json()).commits||[];ls(S=>{if(!l)return g;const h=new Set(S.map(ot=>ot.sha)),k=[...S];for(const ot of g)h.has(ot.sha)||k.push(ot);return k}),bt(n),Be(Array.isArray(g)&&g.length===c)}catch(d){console.error("[CICD] fetchCommits failed:",d),l||(ls([]),Be(!1))}finally{l&&cs(!1)}},[]),et=i.useCallback(async(t,a,s="open",o)=>{const n=(o==null?void 0:o.page)??1,l=!!(o!=null&&o.append),c=20;l&&ea(!0);try{const p=(await(await fetch(`/api/gitea/repos/${t}/${a}/issues?state=${s}&limit=${c}&page=${n}`)).json()).issues||[];Ft(g=>{if(!l)return p;const S=new Set(g.map(k=>k.number)),h=[...g];for(const k of p)S.has(k.number)||h.push(k);return h}),Zs(n),It(Array.isArray(p)&&p.length===c)}catch(d){console.error("[CICD] fetchIssues failed:",d),l||(Ft([]),It(!1))}finally{l&&ea(!1)}},[]),Qt=i.useCallback(async(t,a,s)=>{const o=(s==null?void 0:s.page)??1,n=!!(s!=null&&s.append),l=20;n&&sa(!0);try{const f=(await(await fetch(`/api/gitea/repos/${t}/${a}/releases?limit=${l}&page=${o}`)).json()).releases||[];Ht(p=>{if(!n)return f;const g=new Set(p.map(h=>h.id)),S=[...p];for(const h of f)g.has(h.id)||S.push(h);return S}),ta(o),qt(Array.isArray(f)&&f.length===l)}catch(c){console.error("[CICD] fetchReleases failed:",c),n||(Ht([]),qt(!1))}finally{n&&sa(!1)}},[]),ue=i.useCallback(async(t,a,s)=>{const o=(s==null?void 0:s.page)??1,n=!!(s!=null&&s.append),l=20;n&&ms(!0);try{const d=await(await fetch(`/api/gitea/repos/${t}/${a}/actions/runs?limit=${l}&page=${o}`)).json(),f=d.workflow_runs||d.tasks||d.task_list||[],p=Array.isArray(f)?f:[];ds(g=>{if(!n)return p;const S=new Set(g.map(k=>k.id)),h=[...g];for(const k of p)S.has(k.id)||h.push(k);return h}),xs(o),wt(p.length===l),n||(ge(null),se([]))}catch(c){console.error("[CICD] fetchActions failed:",c),n||(ds([]),wt(!1))}finally{n&&ms(!1)}},[]),Kn=i.useCallback(async(t,a,s)=>{ps(!0);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/actions/runs/${s}/jobs`)).json(),l=Array.isArray(n==null?void 0:n.jobs)?n.jobs:Array.isArray(n)?n:[n];se(l.filter(Boolean))}catch(o){console.error("[CICD] fetchActionRunJobs failed:",o),se([])}finally{ps(!1)}},[]),K=i.useCallback(async(t,a,s="all",o)=>{const n=(o==null?void 0:o.page)??1,l=!!(o!=null&&o.append),c=20;l&&Bs(!0);try{const p=(await(await fetch(`/api/gitea/repos/${t}/${a}/pulls?state=${s}&limit=${c}&page=${n}`)).json()).pulls||[];Ts(g=>{if(!l)return p;const S=new Set(g.map(k=>k.number)),h=[...g];for(const k of p)S.has(k.number)||h.push(k);return h}),Ls(n),Pt(Array.isArray(p)&&p.length===c)}catch(d){console.error("[CICD] fetchPulls failed:",d),l||(Ts([]),Pt(!1))}finally{l&&Bs(!1)}},[]),ma=i.useCallback(async(t,a,s)=>{if(!s){G("unknown"),J([]);return}Hs(!0);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/commits/${encodeURIComponent(s)}/status`)).json();G(mt(n==null?void 0:n.state)),J(Array.isArray(n==null?void 0:n.statuses)?n.statuses:[])}catch(o){console.error("[CICD] fetchPRChecks failed:",o),G("unknown"),J([])}finally{Hs(!1)}},[]),tt=i.useCallback(async(t,a,s)=>{var n,l,c,d,f;const o=++Xe.current;Es(!0);try{const g=await(await fetch(`/api/gitea/repos/${t}/${a}/pulls/${s}`)).json();if(o!==Xe.current)return;Y(g),((n=g==null?void 0:g.pull)==null?void 0:n.mergeable)===!1?xe({prNumber:s,message:"PR is not mergeable with current base. Update branch from base and retry."}):xe(h=>(h==null?void 0:h.prNumber)===s?null:h);const S=((c=(l=g==null?void 0:g.pull)==null?void 0:l.head)==null?void 0:c.sha)||((f=(d=g==null?void 0:g.pull)==null?void 0:d.head)==null?void 0:f.ref)||"";ma(t,a,S)}catch(p){if(console.error("[CICD] fetchPRDetail failed:",p),o!==Xe.current)return;Y(null),G("unknown"),J([])}finally{o===Xe.current&&Es(!1)}},[ma]),pe=i.useCallback(async(t,a,s)=>{zs(!0);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/pulls/${s}/activity`)).json();ce(Array.isArray(n.comments)?n.comments:[]),de(Array.isArray(n.reviews)?n.reviews:[]),Mt(Array.isArray(n.inline_comments)?n.inline_comments:[])}catch(o){console.error("[CICD] fetchPRActivity failed:",o),ce([]),de([]),Mt([])}finally{zs(!1)}},[]),Q=i.useCallback(async(t,a,s="",o)=>{try{const n=o?`&ref=${encodeURIComponent(o)}`:"",c=await(await fetch(`/api/gitea/repos/${t}/${a}/tree?path=${encodeURIComponent(s)}${n}`)).json();Ee(d=>({...d,[s||"/"]:c.entries||[]}))}catch(n){console.error("[CICD] fetchTree failed:",n),Ee(l=>({...l,[s||"/"]:[]}))}},[]),Xt=i.useCallback(async(t,a,s,o)=>{const n=++_e.current;De(!0),O(s),Fe(!1);try{const l=o?`&ref=${encodeURIComponent(o)}`:"",c=await fetch(`/api/gitea/repos/${t}/${a}/file?path=${encodeURIComponent(s)}${l}`);if(!c.ok){const p=await c.json().catch(()=>({}));if(n!==_e.current)return;console.error("[CICD] fetchFileContent error:",c.status,p),z(`// Error ${c.status}: Could not load file "${s}"
// ${(p==null?void 0:p.detail)||"Unknown error"}`),_s("");return}const d=await c.json();if(n!==_e.current)return;const f=d.content??"";console.log("[CICD] File loaded:",s,"length:",f.length),z(f),_s(d.sha||"")}catch(l){if(n!==_e.current)return;console.error("[CICD] fetchFileContent exception:",l),z(`// Error loading file "${s}"`)}finally{n===_e.current&&De(!1)}},[]),Qn=i.useCallback(async(t,a,s)=>{Ps(!0);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/commits/${s}`)).json();oe(n),$t(new Set)}catch(o){console.error("[CICD] fetchCommitDetail failed:",o),oe(null)}finally{Ps(!1)}},[]),ua=i.useCallback(async(t,a)=>{try{const s=await fetch(`/api/gitea/repos/${t}/${a}/languages`);if(s.ok){const o=await s.json();Jt(o||{})}}catch(s){console.error("[CICD] fetchLanguages failed:",s),Jt({})}},[]),pa=i.useCallback(async(t,a)=>{try{const s=await fetch(`/api/gitea/repos/${t}/${a}/topics`);if(s.ok){const o=await s.json();Vt((o==null?void 0:o.topics)||[])}}catch(s){console.error("[CICD] fetchTopics failed:",s),Vt([])}},[]),ha=i.useCallback(async t=>{const a=t.default_branch||"main";pt(t),ht("files"),bs(!0),Ae(""),O(null),z(""),oe(null),Ee({}),Jt({}),Vt([]),fs(a),gs(!1),He(null),Y(null),ce([]),de([]),Mt([]),ve(null),xe(null),G("unknown"),J([]),Ys("open"),Ft([]),Ht([]),bt(1),js(1),Zs(1),ta(1),Ls(1),xs(1),Be(!1),vt(!1),It(!1),qt(!1),Pt(!1),wt(!1),ge(null),se([]);const[s,o]=t.full_name.split("/");try{await Promise.all([Q(s,o,"",a),Se(s,o),U(s,o,a,{page:1}),K(s,o,"all",{page:1}),ue(s,o,{page:1}),Kt(s,o,{page:1}),et(s,o,"open",{page:1}),Qt(s,o,{page:1}),ua(s,o),pa(s,o)])}finally{bs(!1)}},[Q,Se,U,K,ue,Kt,et,Qt,ua,pa]),st=i.useCallback(async t=>{if(!r)return;const[a,s]=r.full_name.split("/");fs(t),gs(!1),Ae(""),O(null),z(""),Ee({}),bt(1),Be(!1),oe(null),await Promise.all([Q(a,s,"",t),U(a,s,t,{page:1})])},[r,Q,U]),Xn=i.useCallback(async t=>{if(!r)return;const[a,s]=r.full_name.split("/");console.log("Deleting branch:",a,s,t),ra(t);try{const o=await fetch(`/api/gitea/repos/${a}/${s}/branches?branch=${encodeURIComponent(t)}`,{method:"DELETE"});if(!o.ok){const n=await o.json().catch(()=>({detail:o.statusText}));A({tone:"error",message:`Failed to delete branch: ${n.detail||o.statusText}`});return}N===t&&await st(r.default_branch||"main"),Se(a,s),A({tone:"success",message:`Branch "${t}" deleted`})}catch(o){console.error("[CICD] handleDeleteBranch failed:",o),A({tone:"error",message:`Failed to delete branch: ${o instanceof Error?o.message:"Unknown error"}`})}finally{ra(o=>o===t?null:o)}},[r,N,st,Se]),Yn=i.useCallback(async()=>{if(!r||!$||!we)return;const[t,a]=r.full_name.split("/");$s(!0);try{const s=await fetch(`/api/gitea/repos/${t}/${a}/file`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:$,content:jn(St),message:we,sha:Ie,branch:N})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to save: ${o.detail||s.statusText}`);return}Fe(!1),Cs(""),await Xt(t,a,$,N),await U(t,a,N)}catch(s){y(`Failed to save: ${s instanceof Error?s.message:"Unknown error"}`)}finally{$s(!1)}},[r,$,St,we,Ie,N,Xt,U,y]),Zn=i.useCallback(async()=>{if(!r||!$||!confirm(`Delete file "${$}"? This cannot be undone.`))return;const[t,a]=r.full_name.split("/");De(!0);try{const s=await fetch(`/api/gitea/repos/${t}/${a}/file`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:$,message:`Delete ${$}`,sha:Ie,branch:N})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to delete file: ${o.detail||s.statusText}`);return}O(null),z(""),await Q(t,a,"",N),await U(t,a,N)}catch(s){y(`Failed to delete file: ${s instanceof Error?s.message:"Unknown error"}`)}finally{De(!1)}},[r,$,Ie,N,Q,U,y]);i.useEffect(()=>{Ye(),Ze()},[Ye,Ze]),i.useEffect(()=>{if(!_&&x!=="checking")return;const t=window.setTimeout(()=>{Te(!1),m(a=>a==="checking"?"offline":a),ut(a=>a??"Request timeout while loading repositories")},12e3);return()=>window.clearTimeout(t)},[_,x]),i.useEffect(()=>{const t=a=>{const s=a.detail;if(s!=null&&s.repo){const o=b.find(n=>n.full_name===s.repo);o&&ha(o)}};return window.addEventListener("openclaw:select-repo",t),()=>window.removeEventListener("openclaw:select-repo",t)},[b,ha]),i.useEffect(()=>{if(!r)return;const[t,a]=r.full_name.split("/"),s=setInterval(()=>ue(t,a,{page:1}),15e3);return()=>clearInterval(s)},[r,ue]);const at=async t=>{if(r&&(Ae(t),O(null),!ne[t])){const[a,s]=r.full_name.split("/");await Q(a,s,t,N)}},eo=t=>{if(!r)return;const[a,s]=r.full_name.split("/");Xt(a,s,t,N)},to=t=>{if(!r)return;const[a,s]=r.full_name.split("/");Qn(a,s,t)},so=t=>{if(!r)return;const[a,s]=r.full_name.split("/"),o=le===t?null:t;He(o),Y(null),ce([]),de([]),G("unknown"),J([]),o!==null&&(tt(a,s,o),pe(a,s,o))},ao=async()=>{if(!r||!ke)return;const[t,a]=r.full_name.split("/");try{const s=await fetch(`/api/gitea/repos/${t}/${a}/branches`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({new_branch_name:ke,old_branch_name:ia||r.default_branch})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to create branch: ${o.detail||s.statusText}`);return}oa(""),na(!1),ee(`Branch '${ke}' created`),Se(t,a)}catch(s){y(`Failed to create branch: ${s instanceof Error?s.message:"Unknown error"}`)}},no=async()=>{if(!r||!qe||!Oe||!ze)return;const[t,a]=r.full_name.split("/");try{const s=await fetch(`/api/gitea/repos/${t}/${a}/pulls`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:qe,body:Ds,head:Oe,base:ze})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to create PR: ${o.detail||s.statusText}`);return}As(""),Fs(""),Is(""),Us(""),Tt(!1),ee("Pull request created"),K(t,a,re,{page:1})}catch(s){y(`Failed to create PR: ${s instanceof Error?s.message:"Unknown error"}`)}},Yt=async(t,a="merge")=>{if(!r)return;const[s,o]=r.full_name.split("/"),n=a.charAt(0).toUpperCase()+a.slice(1);if(window.confirm(`Merge PR #${t} using "${n}" strategy?`))try{const l=await fetch(`/api/gitea/repos/${s}/${o}/pulls/${t}/merge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({merge_message_field_style:a,delete_branch_after_merge:!1})});if(!l.ok){const c=await l.json().catch(()=>({detail:l.statusText})),d=String(c.detail||l.statusText||"merge failed"),f=d.toLowerCase();(l.status===409||f.includes("conflict")||f.includes("not mergeable"))&&xe({prNumber:t,message:d}),y(`Failed to merge PR: ${d}`);return}xe(null),ee(`PR #${t} merged successfully`),tt(s,o,t),pe(s,o,t),K(s,o,re,{page:1})}catch(l){y(`Failed to merge PR: ${l instanceof Error?l.message:"Unknown error"}`)}},oo=async t=>{if(!r)return;const[a,s]=r.full_name.split("/");if(window.confirm(`Close PR #${t}?`))try{const o=await fetch(`/api/gitea/repos/${a}/${s}/pulls/${t}/close`,{method:"PATCH"});if(!o.ok){const l=await o.json().catch(()=>({detail:o.statusText}));y(`Failed to close PR: ${l.detail||o.statusText}`);return}const n=await o.json();ee(`PR #${t} closed`),Y(l=>l?{...l,pull:n.pull}:null),pe(a,s,t),K(a,s,re,{page:1})}catch(o){y(`Failed to close PR: ${o instanceof Error?o.message:"Unknown error"}`)}},ba=async(t,a,s)=>{if(!r)return;const[o,n]=r.full_name.split("/");try{const l=await fetch(`/api/gitea/repos/${o}/${n}/pulls/${t}/reviews`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:a,body:s})});if(!l.ok){const d=await l.json().catch(()=>({detail:l.statusText||"unknown error"}));y(`Failed to submit review: ${d.detail||l.statusText}`);return}ee(`PR #${t} ${a==="APPROVED"?"approved":a==="REQUEST_CHANGES"?"requested changes on":"commented on"}`),tt(o,n,t),pe(o,n,t)}catch(l){y(`Failed to submit review: ${l instanceof Error?l.message:"Unknown error"}`)}},fa=async(t,a)=>{if(!r)return;const[s,o]=r.full_name.split("/");Ws(!0);try{const n=await fetch(`/api/gitea/repos/${s}/${o}/pulls/${t}/update?style=${a}`,{method:"POST"});if(!n.ok){const l=await n.json().catch(()=>({detail:n.statusText}));y(`Failed to update PR branch: ${l.detail||n.statusText}`);return}xe(null),A({tone:"success",message:`PR #${t} branch updated with ${a}`}),tt(s,o,t),pe(s,o,t),K(s,o,re,{page:1})}catch(n){y(`Failed to update PR branch: ${n instanceof Error?n.message:"Unknown error"}`)}finally{Ws(!1)}},io=async t=>{var n,l;if(!r||!T)return;const[a,s]=r.full_name.split("/"),o=T.body.trim();if(o){Gs(!0);try{const c=await fetch(`/api/gitea/repos/${a}/${s}/pulls/${t}/inline-comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:T.path,new_position:T.newPosition,old_position:T.oldPosition,body:o,commit_id:((l=(n=E==null?void 0:E.pull)==null?void 0:n.head)==null?void 0:l.sha)||""})});if(!c.ok){const d=await c.json().catch(()=>({detail:c.statusText}));y(`Failed to add inline comment: ${d.detail||c.statusText}`);return}A({tone:"success",message:"Inline comment added"}),ve(null),pe(a,s,t)}catch(c){y(`Failed to add inline comment: ${c instanceof Error?c.message:"Unknown error"}`)}finally{Gs(!1)}}},ga=async(t,a)=>{if(!r)return;const[s,o]=r.full_name.split("/");hs({runId:t,action:a});try{const n=await fetch(`/api/gitea/repos/${s}/${o}/actions/runs/${t}/${a}`,{method:"POST"});if(!n.ok){const l=await n.json().catch(()=>({detail:n.statusText}));y(`Failed to ${a} run #${t}: ${l.detail||n.statusText}`);return}A({tone:"success",message:a==="rerun"?`Run #${t} rerun dispatched`:`Run #${t} cancelled`}),ue(s,o,{page:1})}catch(n){y(`Failed to ${a} run #${t}: ${n instanceof Error?n.message:"Unknown error"}`)}finally{hs(null)}},ro=async t=>{await ba(t,"APPROVED","LGTM ✅")},lo=async t=>{Qe({prNumber:t,event:"REQUEST_CHANGES",title:`Request changes on PR #${t}`,placeholder:"Please address review feedback."}),Ce("Please address review feedback.")},co=async t=>{Qe({prNumber:t,event:"COMMENT",title:`Add review comment to PR #${t}`,placeholder:"Write a comment..."}),Ce("")},xo=async()=>{if(!Z)return;const t=la.trim();if(Z.event==="COMMENT"&&!t){y("Comment cannot be empty");return}await ba(Z.prNumber,Z.event,t),Qe(null),Ce("")},$e=i.useCallback(async(t,a,s)=>{Js(!0),V(null);try{const n=await(await fetch(`/api/gitea/repos/${t}/${a}/branch-protections`)).json(),c=(Array.isArray(n.protections)?n.protections:[]).find(d=>d.rule_name===s||d.branch_name===s);if(!c){Ke(!1),D({branch_name:s,rule_name:s,enable_status_check:!0,status_check_contexts:[],required_approvals:1,dismiss_stale_approvals:!0,block_on_rejected_reviews:!0,block_on_outdated_branch:!0,block_on_official_review_requests:!1,enable_force_push:!1,require_signed_commits:!1}),Dt("");return}Ke(!0),D({branch_name:s,rule_name:c.rule_name||c.branch_name||s,enable_status_check:!!c.enable_status_check,status_check_contexts:Array.isArray(c.status_check_contexts)?c.status_check_contexts:[],required_approvals:Number(c.required_approvals??1),dismiss_stale_approvals:!!c.dismiss_stale_approvals,block_on_rejected_reviews:!!c.block_on_rejected_reviews,block_on_outdated_branch:!!c.block_on_outdated_branch,block_on_official_review_requests:!!c.block_on_official_review_requests,enable_force_push:!!c.enable_force_push,require_signed_commits:!!c.require_signed_commits}),Dt((Array.isArray(c.status_check_contexts)?c.status_check_contexts:[]).join(", "))}catch(o){V(o instanceof Error?o.message:"Failed to load branch protection")}finally{Js(!1)}},[]),mo=async()=>{if(!r)return;const[t,a]=r.full_name.split("/"),s=r.default_branch||"main",o=Qs.split(",").map(n=>n.trim()).filter(Boolean);Ve(!0),V(null);try{const n={branch_name:s,rule_name:P.rule_name||s,enable_status_check:!!P.enable_status_check,status_check_contexts:o,required_approvals:Math.max(0,Number(P.required_approvals??0)),dismiss_stale_approvals:!!P.dismiss_stale_approvals,block_on_rejected_reviews:!!P.block_on_rejected_reviews,block_on_outdated_branch:!!P.block_on_outdated_branch,block_on_official_review_requests:!!P.block_on_official_review_requests,enable_force_push:!!P.enable_force_push,require_signed_commits:!!P.require_signed_commits},l=await fetch(`/api/gitea/repos/${t}/${a}/branch-protections/${encodeURIComponent(s)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!l.ok){const c=await l.json().catch(()=>({detail:l.statusText}));V(c.detail||l.statusText);return}Ke(!0),A({tone:"success",message:`Branch protection saved for ${s}`}),await $e(t,a,s)}catch(n){V(n instanceof Error?n.message:"Failed to save branch protection")}finally{Ve(!1)}},uo=async()=>{if(!r)return;const[t,a]=r.full_name.split("/"),s=r.default_branch||"main";Ve(!0),V(null);try{const o=await fetch(`/api/gitea/repos/${t}/${a}/branch-protections/${encodeURIComponent(s)}`,{method:"DELETE"});if(!o.ok){const n=await o.json().catch(()=>({detail:o.statusText}));V(n.detail||o.statusText);return}Ke(!1),ee(`Branch protection removed for ${s}`),await $e(t,a,s)}catch(o){V(o instanceof Error?o.message:"Failed to delete branch protection")}finally{Ve(!1)}};i.useEffect(()=>{if(!r||L!=="security")return;const[t,a]=r.full_name.split("/"),s=r.default_branch||"main";$e(t,a,s)},[r,L,$e]);const wa=b.filter(t=>!Le||t.full_name.toLowerCase().includes(Le.toLowerCase())||(t.description||"").toLowerCase().includes(Le.toLowerCase()));i.useEffect(()=>{(async()=>{if(!r)return;const s=(ne[q||"/"]||[]).find(o=>o.name.toLowerCase()==="readme.md"&&o.type==="file");if(s){const[o,n]=r.full_name.split("/"),l=N?`&ref=${encodeURIComponent(N)}`:"";try{const d=await(await fetch(`/api/gitea/repos/${o}/${n}/file?path=${encodeURIComponent(s.path)}${l}`)).json();Nt(d.content||"")}catch(c){console.error("[CICD] README load failed:",c),Nt(null)}}else Nt(null)})()},[ne,q,r,N]);const po=[{key:"files",label:"Files",icon:Xa},{key:"commits",label:"Commits",icon:ts,count:M.length},{key:"pulls",label:"PRs",icon:X,count:Ue.length},{key:"issues",label:"Issues",icon:fe,count:ye.length},{key:"branches",label:"Branches",icon:be,count:F.length},{key:"tags",label:"Tags",icon:rt,count:ae.length},{key:"releases",label:"Releases",icon:mn,count:Ne.length},{key:"actions",label:"Actions",icon:Ya,count:gt.length},{key:"security",label:"Security",icon:un},{key:"insights",label:"Insights",icon:Za}],[ja,nt]=i.useState(!1),[he,va]=i.useState(""),ya=async()=>{if(!r||!he)return;const[t,a]=r.full_name.split("/");try{const s=await fetch(`/api/gitea/repos/${t}/${a}/file`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:he,content:jn(""),message:`Create ${he}`,sha:"",branch:N})});if(!s.ok){const o=await s.json().catch(()=>({detail:s.statusText}));y(`Failed to create file: ${o.detail||s.statusText}`);return}ee(`File '${he}' created`),nt(!1),va(""),await Q(t,a,"",N)}catch(s){y(`Failed to create file: ${s instanceof Error?s.message:"Unknown error"}`)}};return e.jsxs("div",{className:"flex h-screen bg-[#09090b] text-foreground font-sans overflow-hidden relative",style:{fontFamily:"'Inter', -apple-system, sans-serif"},children:[e.jsx("div",{className:"absolute top-0 left-0 w-[800px] h-[800px] bg-purple-500/5 rounded-full blur-[120px] pointer-events-none -translate-x-1/4 -translate-y-1/4 z-0"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[600px] h-[600px] bg-sky-500/5 rounded-full blur-[100px] pointer-events-none translate-x-1/4 -translate-y-1/4 z-0"}),e.jsx("div",{className:"relative z-10 shrink-0",children:e.jsx(ho,{})}),e.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-transparent relative z-10",children:[e.jsxs("header",{className:"flex items-center px-4 justify-between h-12 bg-black/40 backdrop-blur-md border-b border-white/5 shrink-0 z-20",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-obsidian-info/30 to-transparent opacity-50"}),e.jsxs("div",{className:"flex items-center gap-3 text-[12px]",children:[e.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("openclaw:toggle-sidebar")),className:"p-1.5 hover:bg-white/10 rounded-md text-obsidian-muted hover:text-white transition-all active:scale-95 border border-transparent hover:border-obsidian-border/50",title:"Toggle Explorer",children:e.jsx(jo,{className:"w-4 h-4 drop-shadow-[0_0_8px_rgba(255,255,255,0.2)]"})}),e.jsx("div",{className:"w-[1px] h-4 bg-obsidian-border/50"}),e.jsx(X,{className:"w-3.5 h-3.5",style:{color:"#a78bfa"}}),e.jsx("span",{className:"text-foreground font-medium",children:"Source Control"}),e.jsx("span",{className:"text-obsidian-muted",children:"·"}),e.jsxs("span",{className:"text-obsidian-muted",children:["Gitea ",u&&`v${u}`]}),e.jsx("span",{className:"text-obsidian-muted",children:"·"}),e.jsx(Uo,{status:x}),e.jsx("span",{className:"text-obsidian-muted",children:"·"}),e.jsxs("span",{className:"text-[10px] text-obsidian-muted",children:[b.length," repos"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>{Ye(),Ze()},className:"p-1 hover:bg-obsidian-border-active rounded text-obsidian-muted hover:text-foreground transition-colors",title:"Refresh",children:e.jsx(an,{className:v("w-3.5 h-3.5",_&&"animate-spin")})}),e.jsx("button",{onClick:()=>Cn(!is),className:"p-1 hover:bg-obsidian-border-active rounded text-obsidian-muted hover:text-foreground transition-colors",children:is?e.jsx(nn,{className:"w-3.5 h-3.5"}):e.jsx(bo,{className:"w-3.5 h-3.5"})}),e.jsx("a",{href:xt,target:"_blank",rel:"noopener noreferrer",className:"p-1 hover:bg-obsidian-border-active rounded text-obsidian-muted hover:text-foreground transition-colors",title:"Open Gitea",children:e.jsx(on,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden bg-transparent",children:[e.jsxs("div",{className:v("w-80 flex flex-col border-r border-white/5 bg-black/20 backdrop-blur-xl shrink-0 transition-all",r?"hidden md:flex":"flex"),children:[e.jsx("div",{className:"p-3 border-b border-white/5",children:e.jsxs("div",{className:"relative",children:[e.jsx(fo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-obsidian-muted"}),e.jsx("input",{type:"text",placeholder:"Search repositories...",className:"w-full bg-black/20 border border-white/10 focus:border-obsidian-info shadow-sm rounded-md pl-9 pr-3 py-1.5 text-[12px] text-foreground placeholder-obsidian-muted outline-none transition-all",value:Le,onChange:t=>kn(t.target.value)})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:_?e.jsx("div",{className:"p-4 text-center text-obsidian-muted text-[11px]",children:"Loading repositories..."}):wa.length===0?e.jsx("div",{className:"p-4 text-center text-obsidian-muted text-[11px]",children:"No repositories found."}):wa.map(t=>e.jsxs("div",{className:v("flex flex-col gap-1 px-4 py-2.5 border-b border-white/5 cursor-pointer transition-colors",(r==null?void 0:r.id)===t.id?"bg-white/[0.04]":"hover:bg-white/[0.02]"),onClick:()=>{pt(t),ht("files"),O(null),z(""),oe(null),He(null),Y(null),ce([]),de([]),G("unknown"),J([]),ge(null),se([]),Ae("")},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-3.5 h-3.5 text-obsidian-info shrink-0"}),e.jsx("span",{className:"text-[12px] text-foreground font-medium truncate",children:t.full_name})]}),t.description&&e.jsx("p",{className:"text-[10px] text-obsidian-muted line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-obsidian-muted mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(rt,{className:"w-2.5 h-2.5"}),t.stars_count]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-2.5 h-2.5"}),t.default_branch]}),e.jsx("span",{className:"ml-auto",children:H(t.updated_at)})]})]},t.id))})]}),e.jsx("div",{className:v("flex-1 flex flex-col min-w-0 bg-transparent",r?"flex":"hidden md:flex"),children:r?e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-transparent",children:[e.jsxs("div",{className:"bg-black/20 backdrop-blur-md border-b border-white/5 shrink-0 flex flex-col pt-4",children:[e.jsxs("div",{className:"flex items-start justify-between px-6 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(X,{className:"w-5 h-5 shrink-0",style:{color:"#a78bfa"}}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[18px] text-foreground truncate",children:[e.jsx("span",{className:"text-obsidian-info hover:underline cursor-pointer",children:r.owner.login}),e.jsx("span",{className:"text-obsidian-muted",children:"/"}),e.jsx("span",{className:"font-bold text-obsidian-info hover:underline cursor-pointer",children:r.name})]}),e.jsx("span",{className:"border border-obsidian-border text-obsidian-muted text-[10px] px-2 py-0.5 rounded-full font-medium ml-2",children:"Public"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r.html_url+".git")},className:"p-1.5 hover:bg-obsidian-border-active rounded-md text-obsidian-muted hover:text-foreground transition-colors",title:"Copy clone URL",children:e.jsx(Zt,{className:"w-3.5 h-3.5"})}),e.jsx("a",{href:r.html_url,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 hover:bg-obsidian-border-active rounded-md text-obsidian-muted hover:text-foreground transition-colors",children:e.jsx(on,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>{pt(null),O(null),z(""),oe(null)},className:"p-1.5 hover:bg-obsidian-danger/20 rounded-md text-obsidian-muted hover:text-obsidian-danger transition-colors ml-1",children:e.jsx(rn,{className:"w-4 h-4"})})]})})]}),e.jsx("div",{className:"flex px-4 overflow-x-auto no-scrollbar",children:po.map(t=>e.jsxs("button",{onClick:()=>ht(t.key),className:v("flex items-center gap-1.5 px-4 py-2.5 text-[12px] font-medium transition-colors border-b-2 whitespace-nowrap",L===t.key?"text-foreground border-obsidian-info bg-white/[0.04]":"text-obsidian-muted border-transparent hover:text-foreground hover:bg-white/[0.02] hover:border-white/5"),children:[e.jsx(t.icon,{className:"w-4 h-4"}),t.label,t.count!==void 0&&t.count>0&&e.jsx("span",{className:"text-[10px] bg-white/5 rounded-full px-2 py-0.5 text-obsidian-muted font-semibold transition-all active:scale-95",children:t.count})]},t.key))})]}),e.jsx("div",{className:"flex-1 flex overflow-hidden",children:Tn?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(C,{className:"w-6 h-6 text-obsidian-info animate-spin"})}):L==="files"?e.jsx("div",{className:"flex-1 flex flex-col overflow-auto items-center py-6 backdrop-blur-sm",children:e.jsx("div",{className:"w-full max-w-[1240px] px-6",children:$?e.jsx("div",{className:"flex flex-col border border-white/5 shadow-sm rounded-lg bg-black/20 backdrop-blur-md overflow-hidden",style:{minHeight:"calc(100vh - 120px)"},children:Mn?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(C,{className:"w-6 h-6 text-obsidian-info animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-black/20 border-b border-white/5 flex items-center px-4 py-2.5 justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"flex items-center gap-1.5 border border-white/10 shadow-sm rounded-md bg-white/[0.02] hover:bg-white/[0.05] px-2.5 py-1 text-[11px] font-medium text-obsidian-muted hover:text-foreground transition-colors",onClick:()=>O(null),children:[e.jsx(it,{className:"w-3.5 h-3.5 rotate-180"})," Back"]}),e.jsx("div",{className:"w-px h-4 bg-white/10 mx-1"}),e.jsx(ct,{className:"w-4 h-4 ml-1",style:{color:gn($)}}),e.jsx("div",{className:"text-[13px] font-mono font-medium text-foreground",children:$.split("/").pop()}),e.jsx("span",{className:"text-[9px] text-obsidian-muted font-bold font-mono uppercase bg-white/5 px-1.5 py-0.5 rounded ml-2 border border-white/5",children:as($)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[fn($)&&!_t&&e.jsxs("div",{className:"flex rounded-md overflow-hidden bg-black/20 border border-white/10 text-[11px] font-medium transition-colors mr-2",children:[e.jsx("button",{onClick:()=>Ns(!0),className:v("px-3 py-1.5 transition-colors",Ct?"bg-white/10 text-foreground":"text-obsidian-muted hover:text-foreground"),children:"Preview"}),e.jsx("div",{className:"w-px bg-white/10"}),e.jsxs("button",{onClick:()=>Ns(!1),className:v("px-3 py-1.5 transition-colors flex items-center gap-1",Ct?"text-obsidian-muted hover:text-foreground":"bg-white/10 text-foreground"),children:[e.jsx(Zt,{className:"w-3.5 h-3.5"})," Source"]})]}),N===((r==null?void 0:r.default_branch)||"main")?e.jsx("span",{className:"text-[10px] text-obsidian-muted bg-white/[0.02] border border-white/10 px-2.5 py-1.5 rounded-md font-medium",children:"🔒 Protected Branch"}):_t?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-[11px] mr-2 text-obsidian-warning font-medium flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-obsidian-warning animate-pulse"}),"Editing"]}),e.jsx("button",{onClick:()=>Fe(!1),className:"text-[11px] font-medium border border-obsidian-border bg-obsidian-bg text-obsidian-muted hover:text-foreground px-3 py-1.5 rounded-md shadow-sm hover:bg-obsidian-border-active transition-colors active:scale-95",children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{ks(kt),Fe(!0)},className:"flex items-center gap-2 px-3 py-1.5 text-[11px] font-medium border border-white/10 bg-white/[0.02] text-foreground rounded-md shadow-sm hover:bg-white/[0.05] transition-colors active:scale-95",children:"✏️ Edit"}),e.jsx("button",{onClick:Zn,className:"flex items-center gap-1 p-1.5 border border-white/10 text-[11px] font-medium bg-white/[0.02] text-obsidian-danger rounded-md shadow-sm hover:bg-obsidian-danger/20 transition-colors active:scale-95",title:"Delete file",children:e.jsx(No,{className:"w-3.5 h-3.5"})})]})]})]}),_t?e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("div",{style:{height:"calc(100vh - 260px)",minHeight:"400px"},children:e.jsx(tn,{height:"100%",width:"100%",language:as($),value:St,theme:"obsidian",onChange:t=>ks(t||""),onMount:Rs,options:{readOnly:!1,domReadOnly:!1,minimap:{enabled:!1},fontSize:14,fontFamily:"JetBrains Mono, Fira Code, DM Mono, Menlo, monospace",fontLigatures:!0,lineHeight:24,scrollBeyondLastLine:!1,automaticLayout:!0,padding:{top:16,bottom:16},renderLineHighlight:"all"}})}),e.jsxs("div",{className:"border-t border-white/5 bg-black/40 p-3.5 flex items-center gap-3 shrink-0",children:[e.jsx("input",{type:"text",placeholder:"Commit message...",value:we,onChange:t=>Cs(t.target.value),className:"flex-1 bg-black/20 border border-white/10 focus:border-obsidian-info shadow-sm rounded-md px-3 py-2 text-[12px] text-foreground placeholder-obsidian-muted outline-none transition-all"}),e.jsxs("button",{onClick:Yn,disabled:!we||Ss,className:"px-4 py-2 bg-[#238636] border border-[rgba(240,246,252,0.1)] text-white rounded-md text-[12px] font-bold hover:bg-[#2ea043] shadow-sm disabled:opacity-40 flex items-center gap-1.5 transition-all active:scale-95",children:[Ss&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Commit changes"]})]})]}):e.jsx("div",{className:"flex-1 flex flex-col overflow-auto bg-transparent",children:fn($)&&Ct?e.jsx("div",{className:"px-10 py-10 max-w-[900px] mx-auto prose prose-invert max-w-none prose-a:text-obsidian-info hover:prose-a:underline prose-headings:border-b prose-headings:border-obsidian-border prose-headings:pb-2",children:e.jsx(ln,{remarkPlugins:[cn],components:{code({node:t,inline:a,className:s,children:o,...n}){const l=/language-(\w+)/.exec(s||"");return!a&&l?e.jsxs("div",{className:"not-prose rounded-md overflow-hidden my-6 border border-white/10 shadow-[0_4px_24px_rgba(0,0,0,0.2)]",children:[e.jsxs("div",{className:"bg-black/40 px-4 py-2 text-[11px] font-mono text-obsidian-muted border-b border-white/5 flex items-center justify-between",children:[e.jsx("span",{children:l[1]}),e.jsx("button",{className:"hover:text-foreground transition-colors",onClick:()=>navigator.clipboard.writeText(String(o).replace(/\n$/,"")),children:e.jsx(en,{className:"w-3.5 h-3.5"})})]}),e.jsx(dn,{...n,style:pn,language:l[1],PreTag:"div",className:"!m-0 !bg-[#0b0c0f] !text-[13px] !p-4 !overflow-x-auto",children:String(o).replace(/\n$/,"")})]}):e.jsx("code",{...n,className:v(s,"bg-white/[0.04] px-1.5 py-0.5 rounded text-[13px] font-mono border border-white/5 text-obsidian-info before:content-hidden after:content-hidden"),children:o})}},children:kt})}):Do($)?e.jsx("div",{className:"flex items-center justify-center h-full p-8 bg-[#0d1117]",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] text-obsidian-muted mb-3",children:"Image preview not available via API"})})}):e.jsx("div",{style:{height:"calc(100vh - 200px)",minHeight:"500px"},children:e.jsx(tn,{height:"100%",width:"100%",language:as($),value:kt,theme:"obsidian",onMount:Rs,options:{readOnly:!0,domReadOnly:!0,minimap:{enabled:!1},fontSize:14,fontFamily:"JetBrains Mono, Fira Code, DM Mono, Menlo, monospace",fontLigatures:!0,lineHeight:24,scrollBeyondLastLine:!1,automaticLayout:!0,padding:{top:16,bottom:16},renderLineHighlight:"none"}})})})]})}):e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center text-[14px] font-bold text-obsidian-info",children:[e.jsx("span",{className:"hover:underline cursor-pointer",onClick:()=>at(""),children:r.name}),q.split("/").filter(Boolean).map((t,a,s)=>{const o=s.slice(0,a+1).join("/");return e.jsxs(Qa.Fragment,{children:[e.jsx("span",{className:"text-obsidian-muted px-1.5 font-normal",children:"/"}),e.jsx("span",{className:"hover:underline cursor-pointer",onClick:()=>at(o),children:t})]},o)})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex items-center bg-white/[0.02] border border-white/10 rounded-md px-3 py-1.5 transition-colors shadow-sm hover:border-obsidian-info/50 group",children:[e.jsx(be,{className:"w-3.5 h-3.5 text-obsidian-muted mr-2 group-hover:text-obsidian-info transition-colors"}),e.jsx("select",{className:"bg-transparent text-[11px] font-medium text-foreground outline-none cursor-pointer appearance-none pr-5 min-w-[70px]",value:N||"",onChange:t=>st(t.target.value),children:F.map(t=>e.jsx("option",{value:t.name,className:"bg-obsidian-panel",children:t.name},t.name))}),e.jsx(es,{className:"w-3 h-3 text-obsidian-muted absolute right-2.5 pointer-events-none group-hover:text-obsidian-info transition-colors"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>nt(!ja),className:"px-3 py-1.5 text-[11px] font-medium text-foreground bg-white/[0.02] border border-white/10 rounded-md hover:bg-white/[0.05] transition-all active:scale-95 flex items-center gap-1.5 shadow-sm",children:["Add file ",e.jsx(es,{className:"w-3 h-3 opacity-60 ml-0.5"})]}),ja&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 w-[240px] bg-[#1a1b1e]/90 backdrop-blur-xl border border-white/10 shadow-2xl rounded-md z-20 p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-black/20 border border-obsidian-info/50 rounded px-1.5 py-1 mb-2",children:[e.jsx(ns,{className:"w-3.5 h-3.5 text-obsidian-muted shrink-0"}),e.jsx("input",{autoFocus:!0,type:"text",placeholder:"name.txt",className:"w-full bg-transparent text-[11px] outline-none text-foreground",value:he,onChange:t=>va(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ya(),t.key==="Escape"&&nt(!1)}})]}),e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx("button",{onClick:()=>nt(!1),className:"text-[10px] px-2 py-1 text-obsidian-muted hover:text-foreground rounded hover:bg-obsidian-border-active transition-colors",children:"Cancel"}),e.jsx("button",{onClick:ya,disabled:!he,className:"text-[10px] px-2 py-1 bg-obsidian-info/20 text-obsidian-info rounded hover:bg-obsidian-info/30 disabled:opacity-50 transition-colors",children:"Create"})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>Jn(!da),className:"px-3 py-1.5 bg-obsidian-success text-white rounded-md text-[11px] font-medium hover:bg-obsidian-success/90 transition-all active:scale-95 flex items-center gap-1.5",children:[e.jsx(Zt,{className:"w-3.5 h-3.5"}),"Code",e.jsx(es,{className:"w-3 h-3 opacity-60 ml-0.5"})]}),da&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-[340px] bg-[#1a1b1e]/90 backdrop-blur-xl border border-white/10 rounded-lg shadow-2xl z-50 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2.5 border-b border-white/5",children:e.jsx("span",{className:"text-[12px] font-semibold text-foreground",children:"Clone"})}),["HTTPS","SSH"].map(t=>{const a=t==="HTTPS"?`${xt}/${r.full_name}.git`:bn===22?`git@${hn}:${r.full_name}.git`:`ssh://git@${hn}:${bn}/${r.full_name}.git`;return e.jsxs("div",{className:"px-3 py-2 border-b border-white/5 last:border-b-0",children:[e.jsx("div",{className:"text-[11px] font-medium text-obsidian-muted mb-1.5",children:t}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{readOnly:!0,value:a,className:"flex-1 bg-black/20 border border-white/10 rounded px-2 py-1.5 text-[11px] font-mono text-obsidian-muted outline-none select-all"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(a),xa(t),setTimeout(()=>xa(null),2e3)},className:"p-1.5 border border-white/10 rounded hover:bg-white/[0.05] transition-colors",children:Vn===t?e.jsx(wo,{className:"w-3.5 h-3.5 text-obsidian-success"}):e.jsx(Co,{className:"w-3.5 h-3.5 text-obsidian-muted"})})]})]},t)})]})]})]})]}),e.jsxs("div",{className:"border border-white/5 rounded-lg bg-black/20 backdrop-blur-md overflow-hidden mt-4 shadow-sm",children:[e.jsxs("div",{className:"bg-black/20 px-4 py-2.5 flex items-center justify-between border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2.5 min-w-0",children:[e.jsx("img",{src:((ka=(Na=M[0])==null?void 0:Na.author)==null?void 0:ka.avatar_url)||`https://ui-avatars.com/api/?name=${((Sa=(_a=(Ca=M[0])==null?void 0:Ca.commit)==null?void 0:_a.author)==null?void 0:Sa.name)||"U"}&background=1a1a2e&color=58a6ff&size=24&font-size=0.45&bold=true`,alt:"",className:"w-5 h-5 rounded-full border border-white/10 shrink-0"}),e.jsx("span",{className:"text-[12px] font-semibold text-foreground shrink-0",children:((Ra=(Pa=($a=M[0])==null?void 0:$a.commit)==null?void 0:Pa.author)==null?void 0:Ra.name)||"admin"}),e.jsx("span",{className:"text-[12px] text-obsidian-muted truncate hover:text-obsidian-info hover:underline transition-colors cursor-pointer",children:((Ba=(La=(Ta=M[0])==null?void 0:Ta.commit)==null?void 0:La.message)==null?void 0:Ba.split(`
`)[0])||"Initial commit"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-[12px] text-obsidian-muted shrink-0 ml-4",children:[e.jsx("code",{className:"text-[11px] font-mono font-medium text-obsidian-info hover:underline cursor-pointer bg-obsidian-info/10 px-1.5 py-0.5 rounded",children:((Ea=(Ma=M[0])==null?void 0:Ma.sha)==null?void 0:Ea.slice(0,7))||"0000000"}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Nn,{className:"w-3 h-3 opacity-60"}),H((Fa=(Da=(Aa=M[0])==null?void 0:Aa.commit)==null?void 0:Da.author)==null?void 0:Fa.date)]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-obsidian-muted border border-white/5 rounded-md px-2 py-0.5 text-[11px] font-medium hover:text-foreground hover:border-white/20 cursor-pointer transition-colors",children:[e.jsx(ts,{className:"w-3 h-3"}),M.length," commits"]})]})]}),e.jsx("table",{className:"w-full text-left border-collapse",children:e.jsxs("tbody",{children:[q!==""&&e.jsx("tr",{className:"border-t border-white/5 hover:bg-white/[0.02] transition-colors group",children:e.jsx("td",{colSpan:3,className:"px-4 py-2.5",children:e.jsxs("div",{className:"text-[12px] text-obsidian-info font-bold cursor-pointer hover:text-white transition-colors flex items-center gap-2 w-fit px-2 py-0.5 rounded-md hover:bg-obsidian-info/20",onClick:()=>{const t=q.split("/");t.pop(),at(t.join("/"))},children:[e.jsx(it,{className:"w-4 h-4 rotate-180"}),e.jsx("span",{className:"tracking-widest",children:".."})]})})}),(ne[q||"/"]||[]).sort((t,a)=>t.type!==a.type?t.type==="dir"?-1:1:t.name.localeCompare(a.name)).map(t=>{const a=t.type==="dir",s=a?Xa:Ao(t.name),o=a?"#6895a8":gn(t.name);return e.jsxs("tr",{className:"border-t border-white/5 hover:bg-white/[0.02] transition-colors group cursor-pointer",onClick:()=>a?at(t.path):eo(t.path),children:[e.jsx("td",{className:"px-4 py-3 w-8",children:e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center group-hover:bg-white/5 transition-colors border border-transparent group-hover:border-white/10",children:e.jsx(s,{className:"w-4 h-4",style:{color:o}})})}),e.jsx("td",{className:"px-1 py-3",children:e.jsx("span",{className:v("text-[13px] transition-colors",a?"font-medium text-foreground group-hover:text-obsidian-info":"text-obsidian-muted group-hover:text-foreground"),children:t.name})}),e.jsx("td",{className:"px-5 py-3 text-right w-24",children:!a&&t.size>0&&e.jsx("span",{className:"text-[11px] text-obsidian-muted font-mono",children:Fo(t.size)})})]},t.path)}),(!ne[q||"/"]||ne[q||"/"].length===0)&&e.jsx("tr",{className:"border-t border-white/5",children:e.jsxs("td",{colSpan:3,className:"px-4 py-12 text-center flex flex-col items-center justify-center gap-3",children:[e.jsx(go,{className:"w-10 h-10 text-obsidian-muted opacity-30"}),e.jsx("span",{className:"text-[13px] text-obsidian-muted font-medium",children:"This directory is empty"})]})})]})})]}),ys&&e.jsxs("div",{className:"border border-white/5 rounded-lg bg-black/20 backdrop-blur-md mt-6 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"bg-black/20 border-b border-white/5 px-4 py-3 flex items-center gap-2",children:[e.jsx(yn,{className:"w-4 h-4 text-obsidian-muted"}),e.jsx("span",{className:"text-[13px] font-semibold text-foreground",children:"README.md"})]}),e.jsx("div",{className:"p-8 prose prose-invert prose-obsidian max-w-none prose-a:text-obsidian-info hover:prose-a:underline prose-headings:border-b prose-headings:border-white/10 prose-headings:pb-2 prose-img:inline prose-img:m-0.5 prose-p:leading-relaxed [&_p:has(img)]:text-center [&_p:has(img)]:leading-loose",children:e.jsx(ln,{remarkPlugins:[cn],components:{code({node:t,inline:a,className:s,children:o,...n}){const l=/language-(\w+)/.exec(s||"");return!a&&l?e.jsxs("div",{className:"not-prose rounded-md overflow-hidden my-6 border border-white/10 shadow-[0_4px_24px_rgba(0,0,0,0.2)]",children:[e.jsxs("div",{className:"bg-black/40 px-4 py-2 text-[11px] font-mono text-obsidian-muted border-b border-white/5 flex items-center justify-between",children:[e.jsx("span",{children:l[1]}),e.jsx("button",{className:"hover:text-foreground transition-colors",onClick:()=>navigator.clipboard.writeText(String(o).replace(/\n$/,"")),children:e.jsx(en,{className:"w-3.5 h-3.5"})})]}),e.jsx(dn,{...n,style:pn,language:l[1],PreTag:"div",className:"!m-0 !bg-obsidian-bg !text-[13px] !p-4 !overflow-x-auto",children:String(o).replace(/\n$/,"")})]}):e.jsx("code",{...n,className:v(s,"bg-obsidian-panel px-1.5 py-0.5 rounded text-[13px] font-mono border border-obsidian-border text-obsidian-info before:content-hidden after:content-hidden"),children:o})}},children:ys})})]})]}),e.jsx("div",{className:"w-[280px] shrink-0 hidden xl:block",children:e.jsxs("div",{className:"sticky top-6 flex flex-col gap-5 bg-black/20 backdrop-blur-md border border-white/5 rounded-lg p-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-[12px] font-semibold text-foreground mb-3",children:"About"}),r.description?e.jsx("p",{className:"text-[13px] text-obsidian-muted leading-relaxed mb-3",children:r.description}):e.jsx("p",{className:"text-[12px] text-obsidian-muted/50 italic mb-3",children:"No description provided."}),ca.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:ca.map(t=>e.jsx("span",{className:"text-[11px] font-medium text-obsidian-info bg-obsidian-info/15 px-2.5 py-0.5 rounded-full hover:bg-obsidian-info/25 cursor-pointer transition-colors",children:t},t))}),e.jsxs("div",{className:"flex flex-col gap-2 text-[12px] text-obsidian-muted",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rt,{className:"w-3.5 h-3.5"})," ",r.stars_count," stars"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vo,{className:"w-3.5 h-3.5"})," ",r.forks_count," forks"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-3.5 h-3.5"})," ",F.length," branches"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yo,{className:"w-3.5 h-3.5"})," ",ae.length," tags"]})]})]}),e.jsx("div",{className:"border-t border-white/5"}),Object.keys(Gt).length>0&&(()=>{const t=Object.values(Gt).reduce((s,o)=>s+o,0),a=Object.entries(Gt).sort((s,o)=>o[1]-s[1]).map(([s,o])=>({name:s,bytes:o,pct:o/t*100,color:Io[s]||"#6c707e"}));return e.jsxs("div",{children:[e.jsx("h3",{className:"text-[12px] font-semibold text-foreground mb-3",children:"Languages"}),e.jsx("div",{className:"flex h-2 rounded-full overflow-hidden mb-3",children:a.map(s=>e.jsx("div",{style:{width:`${s.pct}%`,backgroundColor:s.color},title:`${s.name} ${s.pct.toFixed(1)}%`},s.name))}),e.jsx("div",{className:"flex flex-wrap gap-x-4 gap-y-1.5",children:a.map(s=>e.jsxs("div",{className:"flex items-center gap-1.5 text-[11px]",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:s.color}}),e.jsx("span",{className:"font-medium text-foreground",children:s.name}),e.jsxs("span",{className:"text-obsidian-muted",children:[s.pct.toFixed(1),"%"]})]},s.name))})]})})()]})})]})})}):L==="commits"?e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:v("overflow-auto shrink-0 py-1",R?"w-[300px] border-r border-white/5":"flex-1"),children:[M.length===0?e.jsx("div",{className:"text-center py-8 text-obsidian-muted text-[11px]",children:"No commits"}):M.map(t=>{var a,s,o,n,l,c,d;return e.jsx("div",{onClick:()=>to(t.sha),className:v("px-4 py-2.5 cursor-pointer transition-colors border-b border-white/5",(R==null?void 0:R.sha)===t.sha?"bg-white/[0.04]":"hover:bg-white/[0.02]"),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ts,{className:"w-3.5 h-3.5 text-obsidian-info shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[11px] text-foreground truncate leading-relaxed",children:(s=(a=t.commit)==null?void 0:a.message)==null?void 0:s.split(`
`)[0]}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 text-[10px] text-obsidian-muted",children:[e.jsx("code",{className:"text-obsidian-danger font-mono",children:(o=t.sha)==null?void 0:o.slice(0,7)}),e.jsx("span",{children:(l=(n=t.commit)==null?void 0:n.author)==null?void 0:l.name}),e.jsx("span",{className:"ml-auto",children:H((d=(c=t.commit)==null?void 0:c.author)==null?void 0:d.date)})]})]})]})},t.sha)}),Sn&&e.jsx("div",{className:"px-4 py-3 flex justify-center border-b border-white/5",children:e.jsxs("button",{onClick:()=>{if(!r||ft)return;const[t,a]=r.full_name.split("/");U(t,a,N,{page:_n+1,append:!0})},disabled:ft,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[ft&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more commits"]})})]}),R&&e.jsx("div",{className:"flex-1 overflow-y-auto px-2 py-2 space-y-1 custom-scrollbar",children:En?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(C,{className:"w-5 h-5 text-obsidian-info animate-spin"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 bg-black/20 backdrop-blur-md transition-all active:scale-95",children:[e.jsx("p",{className:"text-[13px] text-foreground font-medium mb-2",children:(Ua=(Ia=R.commit)==null?void 0:Ia.message)==null?void 0:Ua.split(`
`)[0]}),((qa=(Ha=R.commit)==null?void 0:Ha.message)==null?void 0:qa.split(`
`).slice(1).join(`
`).trim())&&e.jsx("p",{className:"text-[11px] text-obsidian-muted mb-2 whitespace-pre-wrap",children:R.commit.message.split(`
`).slice(1).join(`
`).trim()}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-obsidian-muted",children:[e.jsx("code",{className:"text-obsidian-danger font-mono",children:(Oa=R.sha)==null?void 0:Oa.slice(0,7)}),e.jsx("span",{children:(Wa=(za=R.commit)==null?void 0:za.author)==null?void 0:Wa.name}),e.jsx("span",{children:H((Ja=(Ga=R.commit)==null?void 0:Ga.author)==null?void 0:Ja.date)})]}),R.stats&&e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-[10px]",children:[e.jsxs("span",{className:"text-obsidian-success",children:["+",R.stats.additions]}),e.jsxs("span",{className:"text-obsidian-danger",children:["-",R.stats.deletions]}),e.jsxs("span",{className:"text-obsidian-muted",children:[((Va=R.files)==null?void 0:Va.length)||0," files changed"]})]})]}),(Ka=R.files)==null?void 0:Ka.map(t=>{var a;return e.jsxs("div",{className:"border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-white/[0.01] cursor-pointer hover:bg-white/[0.03] transition-all active:scale-95",onClick:()=>{const s=new Set(ie);s.has(t.filename)?s.delete(t.filename):s.add(t.filename),$t(s)},children:[e.jsx(it,{className:v("w-3 h-3 text-obsidian-muted transition-transform",ie.has(t.filename)&&"rotate-90")}),e.jsx("span",{className:v("text-[9px] px-1 py-0.5 rounded font-semibold uppercase",t.status==="added"?"bg-obsidian-success/15 text-obsidian-success":t.status==="removed"?"bg-obsidian-danger/15 text-obsidian-danger":"bg-obsidian-warning/15 text-obsidian-warning"),children:((a=t.status)==null?void 0:a[0])||"M"}),e.jsx("span",{className:"text-[11px] text-foreground font-mono truncate",children:t.filename}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] shrink-0",children:[t.additions>0&&e.jsxs("span",{className:"text-obsidian-success",children:["+",t.additions]}),t.deletions>0&&e.jsxs("span",{className:"text-obsidian-danger",children:["-",t.deletions]})]})]}),ie.has(t.filename)&&e.jsx(qo,{patch:t.patch||"",filename:t.filename})]},t.filename)})]})})]}):L==="pulls"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-md transition-all active:scale-95",children:[["all","open","closed"].map(t=>e.jsx("button",{onClick:()=>{if(Dn(t),He(null),Y(null),ce([]),de([]),G("unknown"),J([]),r){const[a,s]=r.full_name.split("/");K(a,s,t,{page:1})}},className:v("px-2 py-1 rounded text-[10px] font-medium transition-all",re===t?"bg-obsidian-info/20 text-obsidian-info":"text-obsidian-muted hover:text-foreground"),children:t.charAt(0).toUpperCase()+t.slice(1)},t)),e.jsxs("button",{onClick:()=>Tt(!Ms),className:"ml-auto flex items-center gap-1 px-2 py-1 bg-obsidian-success/15 text-obsidian-success rounded text-[10px] font-medium hover:bg-obsidian-success/25 transition-all active:scale-95",children:[e.jsx(sn,{className:"w-3.5 h-3.5"})," New PR"]})]}),Ms&&e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 bg-black/40 backdrop-blur-md space-y-2 transition-all active:scale-95",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:Oe,onChange:t=>Is(t.target.value),className:"flex-1 bg-black/20 border border-white/10 rounded px-2 py-1 text-[11px] text-foreground outline-none transition-all active:scale-95",children:[e.jsx("option",{value:"",children:"Head branch..."}),F.map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))]}),e.jsx(xn,{className:"w-4 h-4 text-obsidian-muted shrink-0 self-center"}),e.jsxs("select",{value:ze,onChange:t=>Us(t.target.value),className:"flex-1 bg-black/20 border border-white/10 rounded px-2 py-1 text-[11px] text-foreground outline-none transition-all active:scale-95",children:[e.jsx("option",{value:"",children:"Base branch..."}),F.map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))]})]}),e.jsx("input",{type:"text",placeholder:"PR title...",value:qe,onChange:t=>As(t.target.value),className:"w-full bg-black/20 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground placeholder-obsidian-muted outline-none transition-all active:scale-95"}),e.jsx("textarea",{placeholder:"Description (optional)...",value:Ds,onChange:t=>Fs(t.target.value),rows:3,className:"w-full bg-black/20 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground placeholder-obsidian-muted outline-none resize-none transition-all active:scale-95"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:no,disabled:!qe||!Oe||!ze,className:"px-3 py-1 bg-obsidian-success text-white rounded text-[10px] font-medium hover:bg-obsidian-success disabled:opacity-40 transition-all active:scale-95",children:"Create"}),e.jsx("button",{onClick:()=>Tt(!1),className:"px-3 py-1 text-obsidian-muted text-[10px] hover:text-foreground transition-all active:scale-95",children:"Cancel"})]})]}),Ue.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-obsidian-muted gap-2",children:[e.jsx(X,{className:"w-8 h-8 opacity-30"}),e.jsx("span",{className:"text-[12px]",children:"No pull requests"}),e.jsx("span",{className:"text-[10px]",children:"Create a PR to merge changes between branches"})]}):Ue.map(t=>{var a,s,o;return e.jsxs("div",{className:"border-b border-white/5",children:[e.jsx("div",{onClick:()=>so(t.number),className:v("px-4 py-3 cursor-pointer transition-colors",le===t.number?"bg-white/[0.04]":"hover:bg-white/[0.02]"),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ho,{pr:t}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[12px] text-foreground font-medium truncate",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-obsidian-muted",children:[e.jsxs("span",{children:["#",t.number]}),e.jsx("span",{children:(a=t.user)==null?void 0:a.login}),e.jsx("span",{className:"font-mono text-obsidian-info",children:(s=t.head)==null?void 0:s.ref}),e.jsx(xn,{className:"w-2.5 h-2.5"}),e.jsx("span",{className:"font-mono text-obsidian-success",children:(o=t.base)==null?void 0:o.ref}),e.jsx("span",{className:"ml-auto",children:H(t.updated_at)})]})]}),t.comments>0&&e.jsxs("div",{className:"flex items-center gap-0.5 text-[10px] text-obsidian-muted shrink-0",children:[e.jsx(ss,{className:"w-3.5 h-3.5"}),t.comments]})]})}),le===t.number&&e.jsxs("div",{className:"px-4 pb-3 pt-2 bg-white/[0.01] flex items-center gap-2 flex-wrap border-b border-white/5",children:[e.jsxs("div",{className:"w-full mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[e.jsx("span",{className:"text-obsidian-muted font-medium",children:"Checks"}),e.jsx("span",{className:v("px-2 py-0.5 rounded border font-medium",lt(W).bg,lt(W).text,lt(W).border),children:Lt?"loading...":W}),!Lt&&je.length>0&&e.jsxs("span",{className:"text-obsidian-muted",children:[je.length," context",je.length!==1?"s":""]}),Pe(W)&&e.jsx("span",{className:"text-obsidian-danger ml-auto",children:"Merge is blocked by failing checks"})]}),!Lt&&je.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5",children:je.slice(0,8).map((n,l)=>{const c=lt(n.state),d=n.context||`check-${l+1}`,f=e.jsxs("span",{className:v("px-2 py-0.5 rounded border text-[9px] font-medium",c.bg,c.text,c.border),children:[d,": ",mt(n.state)]});return n.target_url?e.jsx("a",{href:n.target_url,target:"_blank",rel:"noopener noreferrer",onClick:p=>p.stopPropagation(),children:f},`${d}-${l}`):e.jsx("span",{children:f},`${d}-${l}`)})})]}),(We==null?void 0:We.prNumber)===t.number&&e.jsxs("div",{className:"w-full mb-2 rounded-md border border-obsidian-warning/30 bg-obsidian-warning/10 px-3 py-2 text-[10px] text-obsidian-warning",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Merge conflict detected"}),e.jsx("div",{className:"text-obsidian-muted mb-2",children:We.message}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),fa(t.number,"rebase")},disabled:Et,className:"px-2 py-1 rounded border border-obsidian-info/30 bg-obsidian-info/10 text-obsidian-info hover:bg-obsidian-info/20 disabled:opacity-50",children:Et?"Updating...":"Update Branch (Rebase)"}),e.jsx("button",{onClick:n=>{n.stopPropagation(),fa(t.number,"merge")},disabled:Et,className:"px-2 py-1 rounded border border-white/20 bg-white/[0.05] text-foreground hover:bg-white/[0.1] disabled:opacity-50",children:"Update Branch (Merge)"})]})]}),!t.merged&&t.state==="open"?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:n=>{n.stopPropagation(),ro(t.number)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-success/10 text-obsidian-success border border-obsidian-success/20 rounded-md text-[11px] font-medium hover:bg-obsidian-success/20 transition-colors active:scale-95",children:[e.jsx(dt,{className:"w-3.5 h-3.5"})," Approve"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),lo(t.number)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-warning/10 text-obsidian-warning border border-obsidian-warning/20 rounded-md text-[11px] font-medium hover:bg-obsidian-warning/20 transition-colors active:scale-95",children:[e.jsx(fe,{className:"w-3.5 h-3.5"})," Request changes"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),co(t.number)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-white/[0.02] text-foreground border border-white/10 rounded-md text-[11px] font-medium hover:bg-white/[0.06] transition-colors active:scale-95",children:[e.jsx(ss,{className:"w-3.5 h-3.5"})," Comment"]}),e.jsx("div",{className:"w-px h-4 bg-obsidian-border-active/50 mx-1"}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),Yt(t.number,"merge")},disabled:Pe(W),className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-info/10 text-obsidian-info border border-obsidian-info/20 rounded-md text-[11px] font-medium hover:bg-obsidian-info/20 transition-colors active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed",children:[e.jsx(os,{className:"w-3.5 h-3.5"})," Merge"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),Yt(t.number,"squash")},disabled:Pe(W),className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-warning/10 text-obsidian-warning border border-obsidian-warning/20 rounded-md text-[11px] font-medium hover:bg-obsidian-warning/20 transition-colors active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed",children:[e.jsx(nn,{className:"w-3.5 h-3.5"})," Squash"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),Yt(t.number,"rebase")},disabled:Pe(W),title:"Rebase and Merge",className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-warning/10 text-obsidian-warning border border-obsidian-warning/20 rounded-md text-[11px] font-medium hover:bg-obsidian-warning/20 transition-colors active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed",children:[e.jsx(an,{className:"w-3.5 h-3.5"})," Rebase"]}),e.jsxs("button",{onClick:n=>{n.stopPropagation(),oo(t.number)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-obsidian-danger/10 text-obsidian-danger border border-obsidian-danger/20 rounded-md text-[11px] font-medium hover:bg-obsidian-danger/20 transition-colors ml-auto active:scale-95",children:[e.jsx(Re,{className:"w-3.5 h-3.5"})," Close"]})]}):e.jsxs("div",{className:v("flex items-center gap-2 px-3 py-1.5 rounded-md border text-[11px] font-medium",t.merged?"bg-obsidian-primary/10 text-obsidian-primary border-obsidian-primary/20":"bg-obsidian-border-active/30 text-obsidian-muted border-obsidian-border/50"),children:[t.merged?e.jsx(os,{className:"w-3.5 h-3.5"}):e.jsx(Re,{className:"w-3.5 h-3.5"}),t.merged?"Merged":"Closed"]})]}),le===t.number&&Un&&e.jsxs("div",{className:"px-4 py-3 flex items-center gap-2 text-obsidian-muted text-[11px]",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin text-obsidian-info"}),"Loading changed files..."]}),le===t.number&&E&&E.files&&E.files.length>0&&e.jsxs("div",{className:"border-t border-obsidian-border/50",children:[e.jsxs("div",{className:"px-4 py-2 text-[10px] text-obsidian-muted font-medium border-b border-obsidian-border/30 flex items-center gap-2 bg-obsidian-panel/40 transition-all active:scale-95",children:[e.jsx(ct,{className:"w-3.5 h-3.5"}),E.files.length," changed file",E.files.length!==1?"s":"",e.jsxs("span",{className:"text-obsidian-success ml-auto",children:["+",E.files.reduce((n,l)=>n+(l.additions||0),0)]}),e.jsxs("span",{className:"text-obsidian-danger ml-1",children:["-",E.files.reduce((n,l)=>n+(l.deletions||0),0)]})]}),E.files.map((n,l)=>{const c=Bt.filter(d=>d.path===n.filename);return e.jsxs("div",{className:"border-b border-obsidian-border/20",children:[e.jsxs("div",{className:"px-4 py-1.5 flex items-center gap-2 cursor-pointer hover:bg-obsidian-panel/60 bg-obsidian-bg/30 transition-all active:scale-95",onClick:d=>{d.stopPropagation(),$t(f=>{const p=new Set(f);return p.has(n.filename)?p.delete(n.filename):p.add(n.filename),p})},children:[e.jsx(it,{className:"w-3 h-3 text-obsidian-muted shrink-0 transition-transform"+(ie.has(n.filename)?" rotate-90":"")}),e.jsx("span",{className:"text-[9px] px-1 rounded font-mono shrink-0 "+(n.status==="added"?"bg-obsidian-success/15 text-obsidian-success":n.status==="removed"?"bg-obsidian-danger/15 text-obsidian-danger":"bg-obsidian-warning/15 text-obsidian-warning"),children:(n.status||"M").slice(0,1).toUpperCase()}),e.jsx("span",{className:"font-mono text-[11px] text-foreground truncate flex-1",children:n.filename}),c.length>0&&e.jsxs("span",{className:"text-[9px] text-obsidian-info shrink-0",children:[c.length," inline comment",c.length===1?"":"s"]}),e.jsxs("span",{className:"text-[9px] text-obsidian-success shrink-0",children:["+",n.additions||0]}),e.jsxs("span",{className:"text-[9px] text-obsidian-danger shrink-0 ml-1",children:["-",n.deletions||0]})]}),ie.has(n.filename)&&n.patch&&e.jsx("div",{className:"overflow-x-auto text-[11px] font-mono leading-5",style:{fontFamily:"JetBrains Mono,Menlo,Monaco,Consolas,monospace"},children:Eo(n.patch).map((d,f)=>{let p="transparent",g="#bcbec4";d.kind==="add"?(p="#1a3a2a",g="#6aab73"):d.kind==="del"?(p="#3a1a1a",g="#ff5261"):d.kind==="hunk"&&(p="#1a2a3a",g="#3574f0");const S=c.filter(h=>d.newPosition>0&&h.new_position===d.newPosition||d.oldPosition>0&&h.old_position===d.oldPosition);return e.jsxs("div",{children:[e.jsxs("div",{className:"px-2 py-0 whitespace-pre flex items-center gap-2",style:{backgroundColor:p,color:g},children:[e.jsx("span",{className:"w-10 text-right text-[9px] text-obsidian-muted/80",children:d.oldPosition>0?d.oldPosition:""}),e.jsx("span",{className:"w-10 text-right text-[9px] text-obsidian-muted/80",children:d.newPosition>0?d.newPosition:""}),e.jsx("span",{className:"flex-1",children:d.text}),(d.newPosition>0||d.oldPosition>0)&&e.jsx("button",{onClick:h=>{h.stopPropagation(),ve({path:n.filename,newPosition:d.newPosition,oldPosition:d.oldPosition,body:""})},className:"px-1.5 py-0.5 rounded border border-obsidian-info/30 bg-obsidian-info/10 text-obsidian-info text-[9px] hover:bg-obsidian-info/20",children:"Comment"})]}),S.length>0&&e.jsx("div",{className:"px-4 py-1.5 bg-black/20 border-t border-white/5 space-y-1",children:S.map(h=>{var k;return e.jsxs("div",{className:"text-[10px] text-foreground/90",children:[e.jsx("span",{className:"text-obsidian-info",children:((k=h.user)==null?void 0:k.login)||"unknown"}),e.jsxs("span",{className:"text-obsidian-muted",children:[" · line ",h.new_position||h.old_position||"-"]}),e.jsx("div",{className:"text-[11px] mt-0.5 whitespace-pre-wrap",children:h.body||""})]},`${h.id}-${h.review_id||0}`)})})]},`${n.filename}-${f}`)})}),ie.has(n.filename)&&(T==null?void 0:T.path)===n.filename&&e.jsxs("div",{className:"px-4 py-3 bg-black/20 border-t border-white/10 space-y-2",children:[e.jsxs("div",{className:"text-[10px] text-obsidian-muted",children:["Inline comment on ",e.jsx("span",{className:"font-mono text-foreground",children:T.path})," ","line ",e.jsx("span",{className:"text-obsidian-info",children:T.newPosition||T.oldPosition})]}),e.jsx("textarea",{rows:3,value:T.body,onChange:d=>ve(f=>f&&{...f,body:d.target.value}),placeholder:"Write inline review comment...",className:"w-full bg-black/30 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground placeholder-obsidian-muted outline-none resize-y"}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>ve(null),disabled:At,className:"px-3 py-1.5 rounded text-[10px] border border-white/10 text-obsidian-muted hover:text-foreground",children:"Cancel"}),e.jsxs("button",{onClick:()=>io(t.number),disabled:At||!T.body.trim(),className:"px-3 py-1.5 rounded text-[10px] border border-obsidian-info/30 bg-obsidian-info/20 text-obsidian-info hover:bg-obsidian-info/30 disabled:opacity-50 inline-flex items-center gap-1.5",children:[At&&e.jsx(C,{className:"w-3 h-3 animate-spin"}),"Submit Comment"]})]})]})]},l)})]}),le===t.number&&e.jsxs("div",{className:"border-t border-white/5 bg-black/10 px-4 py-3",children:[e.jsx("div",{className:"text-[11px] font-semibold text-foreground mb-2",children:"Conversation"}),Hn?e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-obsidian-muted",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin text-obsidian-info"}),"Loading comments and reviews..."]}):qs.length===0&&Os.length===0&&Bt.length===0?e.jsx("div",{className:"text-[11px] text-obsidian-muted",children:"No comments or reviews yet."}):e.jsx("div",{className:"space-y-2",children:[...qs.map(n=>{var l;return{kind:"comment",at:n.created_at||"",by:((l=n.user)==null?void 0:l.login)||"unknown",body:n.body||""}}),...Os.map(n=>{var l;return{kind:"review",at:n.submitted_at||"",by:((l=n.user)==null?void 0:l.login)||"unknown",body:n.body||"",state:n.state||"REVIEWED"}}),...Bt.map(n=>{var l;return{kind:"inline",at:n.created_at||"",by:((l=n.user)==null?void 0:l.login)||"unknown",body:n.body||"",state:`INLINE ${n.path||""}:${n.new_position||n.old_position||"-"}`.trim()}})].sort((n,l)=>new Date(n.at).getTime()-new Date(l.at).getTime()).map((n,l)=>e.jsxs("div",{className:"rounded-md border border-white/10 bg-white/[0.02] p-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-obsidian-muted mb-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:n.by}),e.jsx("span",{children:n.kind==="review"?n.state||"REVIEWED":n.kind==="inline"?n.state||"INLINE":"COMMENTED"}),e.jsx("span",{className:"ml-auto",children:H(n.at)})]}),n.body?e.jsx("div",{className:"text-[11px] text-foreground/90 whitespace-pre-wrap",children:n.body}):e.jsx("div",{className:"text-[11px] text-obsidian-muted italic",children:"No message"})]},`${n.kind}-${l}`))})]})]},t.id)}),In&&e.jsx("div",{className:"px-4 py-3 flex justify-center border-b border-white/5",children:e.jsxs("button",{onClick:()=>{if(!r||Rt)return;const[t,a]=r.full_name.split("/");K(t,a,re,{page:Fn+1,append:!0})},disabled:Rt,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[Rt&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more PRs"]})})]}):L==="issues"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-md",children:[["open","closed","all"].map(t=>e.jsx("button",{onClick:()=>{if(Ys(t),!r)return;const[a,s]=r.full_name.split("/");et(a,s,t,{page:1})},className:v("px-2 py-1 rounded text-[10px] font-medium transition-all",Xs===t?"bg-obsidian-info/20 text-obsidian-info":"text-obsidian-muted hover:text-foreground"),children:t.charAt(0).toUpperCase()+t.slice(1)},t)),e.jsxs("span",{className:"ml-auto text-[11px] text-obsidian-muted",children:[ye.length," issues"]})]}),ye.length===0?e.jsx("div",{className:"text-center py-10 text-obsidian-muted text-[11px]",children:"No issues"}):e.jsxs(e.Fragment,{children:[ye.map(t=>{var a;return e.jsx("div",{className:"px-4 py-3 border-b border-white/5 hover:bg-white/[0.02] transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:v("w-4 h-4 mt-0.5",t.state==="open"?"text-obsidian-success":"text-obsidian-muted")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-[12px] font-medium text-foreground truncate",children:["#",t.number," ",t.title]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-obsidian-muted",children:[e.jsx("span",{children:t.state}),e.jsx("span",{children:((a=t.user)==null?void 0:a.login)||"unknown"}),e.jsx("span",{children:H(t.updated_at||t.created_at)}),(t.comments||0)>0&&e.jsxs("span",{className:"ml-auto flex items-center gap-1",children:[e.jsx(ss,{className:"w-3 h-3"}),t.comments]})]}),Array.isArray(t.labels)&&t.labels.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.labels.slice(0,4).map(s=>e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded font-medium",style:{backgroundColor:`#${s.color||"6c707e"}33`,color:`#${s.color||"6c707e"}`},children:s.name},s.id))})]})]})},t.id)}),On&&e.jsx("div",{className:"px-4 py-3 flex justify-center",children:e.jsxs("button",{onClick:()=>{if(!r||Ut)return;const[t,a]=r.full_name.split("/");et(t,a,Xs,{page:qn+1,append:!0})},disabled:Ut,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[Ut&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more issues"]})})]})]}):L==="releases"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-md text-[11px] text-obsidian-muted",children:[Ne.length," release",Ne.length!==1?"s":""]}),Ne.length===0?e.jsx("div",{className:"text-center py-10 text-obsidian-muted text-[11px]",children:"No releases"}):e.jsxs(e.Fragment,{children:[Ne.map(t=>e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 hover:bg-white/[0.02] transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mn,{className:"w-4 h-4 text-obsidian-info"}),e.jsx("span",{className:"text-[12px] font-medium text-foreground",children:t.name||t.tag_name}),e.jsx("span",{className:"text-[10px] text-obsidian-muted font-mono",children:t.tag_name}),t.prerelease&&e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-obsidian-warning/15 text-obsidian-warning",children:"prerelease"}),t.draft&&e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-obsidian-border-active/30 text-obsidian-muted",children:"draft"}),e.jsx("span",{className:"ml-auto text-[10px] text-obsidian-muted",children:H(t.published_at||t.created_at||null)})]}),t.body&&e.jsx("p",{className:"mt-2 text-[11px] text-obsidian-muted whitespace-pre-wrap line-clamp-3",children:t.body})]},t.id)),Wn&&e.jsx("div",{className:"px-4 py-3 flex justify-center",children:e.jsxs("button",{onClick:()=>{if(!r||Ot)return;const[t,a]=r.full_name.split("/");Qt(t,a,{page:zn+1,append:!0})},disabled:Ot,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[Ot&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more releases"]})})]})]}):L==="branches"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-md transition-all active:scale-95",children:[e.jsxs("span",{className:"text-[11px] text-obsidian-muted",children:[F.length," branches"]}),e.jsxs("button",{onClick:()=>na(!aa),className:"ml-auto flex items-center gap-1 px-2 py-1 bg-obsidian-info/15 text-obsidian-info rounded text-[10px] font-medium hover:bg-obsidian-info/25 transition-all active:scale-95",children:[e.jsx(sn,{className:"w-3.5 h-3.5"})," New Branch"]})]}),aa&&e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 bg-black/40 backdrop-blur-md space-y-2 transition-all active:scale-95",children:[e.jsx("input",{type:"text",placeholder:"Branch name...",value:ke,onChange:t=>oa(t.target.value),className:"w-full bg-black/20 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground placeholder-obsidian-muted outline-none transition-all active:scale-95"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-obsidian-muted",children:"from"}),e.jsxs("select",{value:ia,onChange:t=>Gn(t.target.value),className:"flex-1 bg-black/20 border border-white/10 rounded px-2 py-1 text-[11px] text-foreground outline-none transition-all active:scale-95",children:[e.jsx("option",{value:"",children:(r==null?void 0:r.default_branch)||"main"}),F.map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))]}),e.jsx("button",{onClick:ao,disabled:!ke,className:"px-3 py-1 bg-obsidian-info text-white rounded text-[10px] font-medium hover:bg-obsidian-info disabled:opacity-40 transition-all active:scale-95",children:"Create"})]})]}),F.length===0?e.jsx("div",{className:"text-center py-8 text-obsidian-muted text-[11px]",children:"No branches"}):F.map(t=>{var a,s,o,n;return e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 hover:bg-white/[0.02] transition-all active:scale-95",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-3.5 h-3.5 text-obsidian-success shrink-0"}),e.jsx("span",{className:"text-[12px] text-foreground font-mono",children:t.name}),t.name===(r==null?void 0:r.default_branch)&&e.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded bg-obsidian-info/15 text-obsidian-info font-semibold uppercase transition-all active:scale-95",children:"default"}),t.protected&&e.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded bg-obsidian-warning/15 text-obsidian-warning font-semibold uppercase transition-all active:scale-95",children:"protected"})]}),e.jsxs("div",{className:"mt-1 text-[10px] text-obsidian-muted pl-5 truncate",children:[(s=(a=t.commit)==null?void 0:a.id)==null?void 0:s.slice(0,7)," — ",(n=(o=t.commit)==null?void 0:o.message)==null?void 0:n.split(`
`)[0]]}),e.jsxs("div",{className:"mt-1.5 flex items-center gap-1.5 pl-5",children:[e.jsx("button",{onClick:()=>st(t.name),disabled:N===t.name,className:"flex items-center gap-1 px-2 py-0.5 text-[9px] bg-obsidian-border-active text-foreground rounded hover:bg-obsidian-info/20 hover:text-obsidian-info disabled:opacity-40 disabled:cursor-default transition-colors active:scale-95",children:N===t.name?"✓ Active":"⇄ Switch"}),t.name!==(r==null?void 0:r.default_branch)&&!t.protected&&e.jsx("button",{onClick:()=>zt(t.name),className:"flex items-center gap-1 px-2 py-0.5 text-[9px] bg-obsidian-danger/10 text-obsidian-danger rounded hover:bg-obsidian-danger/20 transition-colors active:scale-95",children:"🗑 Delete"})]})]},t.name)})]}):L==="tags"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-white/5 bg-black/20 backdrop-blur-xl flex items-center justify-between shrink-0 overflow-x-auto custom-scrollbar",children:[ae.length," tag",ae.length!==1?"s":""]}),ae.length===0?e.jsx("div",{className:"text-center py-8 text-obsidian-muted text-[11px]",children:"No tags"}):ae.map(t=>{var a,s;return e.jsxs("div",{className:"px-4 py-3 border-b border-white/5 hover:bg-white/[0.02] flex items-center gap-2 transition-all active:scale-95",children:[e.jsx(rt,{className:"w-3.5 h-3.5 text-obsidian-warning shrink-0"}),e.jsx("span",{className:"text-[12px] font-mono text-foreground",children:t.name}),e.jsx("span",{className:"ml-2 text-[10px] text-obsidian-muted font-mono",children:(s=(a=t.commit)==null?void 0:a.sha)==null?void 0:s.slice(0,7)}),t.tarball_url&&e.jsx("a",{href:t.tarball_url,className:"ml-auto text-[9px] text-obsidian-info hover:underline",download:!0,children:"↓ tarball"})]},t.name)}),Bn&&e.jsx("div",{className:"px-4 py-3 flex justify-center border-b border-white/5",children:e.jsxs("button",{onClick:()=>{if(!r||yt)return;const[t,a]=r.full_name.split("/");Kt(t,a,{page:Ln+1,append:!0})},disabled:yt,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[yt&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more tags"]})})]}):L==="actions"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[gt.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-obsidian-muted gap-2",children:[e.jsx(Ya,{className:"w-8 h-8 opacity-30"}),e.jsx("span",{className:"text-[12px]",children:"No workflow runs"})]}):gt.map(t=>e.jsxs("div",{className:"border-b border-white/5",children:[e.jsxs("div",{className:v("px-4 py-2.5 hover:bg-white/[0.02] transition-all active:scale-95 cursor-pointer",Me===t.id&&"bg-white/[0.03]"),onClick:()=>{if(!r)return;const[a,s]=r.full_name.split("/");if(Me===t.id){ge(null),se([]);return}ge(t.id),Kn(a,s,t.id)},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(vn,{status:t.status||"unknown",conclusion:t.conclusion}),e.jsx("span",{className:"text-[11px] text-foreground font-medium truncate",children:t.name||`Run #${t.id}`})]}),e.jsx("span",{className:"text-[10px] text-obsidian-muted shrink-0 ml-2",children:H(t.updated_at||t.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-obsidian-muted pl-1",children:[t.head_branch&&e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx(be,{className:"w-2.5 h-2.5"}),t.head_branch]}),t.run_number&&e.jsxs("span",{children:["#",t.run_number]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1.5",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),ga(t.id,"rerun")},disabled:!!(B&&B.runId===t.id),className:"px-2 py-0.5 rounded border border-obsidian-info/30 bg-obsidian-info/10 text-obsidian-info hover:bg-obsidian-info/20 disabled:opacity-50 text-[9px]",children:(B==null?void 0:B.runId)===t.id&&B.action==="rerun"?"Running...":"Re-run"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),ga(t.id,"cancel")},disabled:!!(B&&B.runId===t.id),className:"px-2 py-0.5 rounded border border-obsidian-danger/30 bg-obsidian-danger/10 text-obsidian-danger hover:bg-obsidian-danger/20 disabled:opacity-50 text-[9px]",children:(B==null?void 0:B.runId)===t.id&&B.action==="cancel"?"Cancelling...":"Cancel"}),e.jsx("span",{className:"text-[9px] text-obsidian-info",children:Me===t.id?"Hide details":"View details"})]})]})]}),Me===t.id&&e.jsx("div",{className:"px-4 pb-3 bg-white/[0.01] border-t border-white/5",children:Rn?e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-obsidian-muted py-2",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin text-obsidian-info"}),"Loading run details..."]}):us.length===0?e.jsx("div",{className:"text-[11px] text-obsidian-muted py-2",children:"No job details returned by Gitea for this run."}):e.jsx("div",{className:"space-y-2 pt-2",children:us.map((a,s)=>e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsx("span",{className:"font-medium text-foreground",children:a.name||`Job ${s+1}`}),e.jsx(vn,{status:a.status||"unknown",conclusion:a.conclusion}),a.runner_name&&e.jsx("span",{className:"ml-auto text-[10px] text-obsidian-muted",children:a.runner_name})]}),Array.isArray(a.steps)&&a.steps.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:a.steps.map((o,n)=>e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-obsidian-muted",children:[e.jsx("span",{className:"w-4 text-right",children:o.number??n+1}),e.jsx("span",{className:"text-foreground/90",children:o.name||`Step ${n+1}`}),e.jsx("span",{className:"ml-auto",children:o.conclusion||o.status||"unknown"})]},`${o.number||n}`))})]},`${a.id||s}`))})})]},t.id)),Pn&&e.jsx("div",{className:"px-4 py-3 flex justify-center",children:e.jsxs("button",{onClick:()=>{if(!r||jt)return;const[t,a]=r.full_name.split("/");ue(t,a,{page:$n+1,append:!0})},disabled:jt,className:"px-3 py-1.5 rounded-md text-[11px] font-medium border border-white/10 bg-white/[0.02] hover:bg-white/[0.05] disabled:opacity-50 flex items-center gap-1.5",children:[jt&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Load more runs"]})})]}):L==="security"?e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"px-4 py-3 border-b border-white/5 bg-black/20 backdrop-blur-md",children:e.jsxs("div",{className:"text-[12px] font-semibold text-foreground flex items-center gap-2",children:[e.jsx(un,{className:"w-4 h-4 text-obsidian-warning"}),"Branch Protection"]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[12px] text-foreground font-medium mb-1",children:"Target Branch"}),e.jsxs("div",{className:"text-[11px] text-obsidian-muted",children:["Default branch:",e.jsx("span",{className:"font-mono text-foreground ml-1",children:(r==null?void 0:r.default_branch)||"main"}),e.jsx("span",{className:"ml-2 text-obsidian-info",children:Vs?"(existing rule)":"(new rule)"})]})]}),Ge?e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4 text-[11px] text-obsidian-muted flex items-center gap-2",children:[e.jsx(C,{className:"w-3.5 h-3.5 animate-spin text-obsidian-info"}),"Loading branch protection..."]}):e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4 space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!P.enable_status_check,onChange:t=>D(a=>({...a,enable_status_check:t.target.checked}))}),"Enable required status checks"]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted",children:"Status check contexts (comma separated)"}),e.jsx("input",{value:Qs,onChange:t=>Dt(t.target.value),placeholder:"build, test, lint",className:"w-full bg-black/30 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"space-y-1",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted",children:"Required approvals"}),e.jsx("input",{type:"number",min:0,value:P.required_approvals??1,onChange:t=>D(a=>({...a,required_approvals:Number(t.target.value||0)})),className:"w-full bg-black/30 border border-white/10 rounded px-2 py-1.5 text-[11px] text-foreground outline-none"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground mt-5",children:[e.jsx("input",{type:"checkbox",checked:!!P.dismiss_stale_approvals,onChange:t=>D(a=>({...a,dismiss_stale_approvals:t.target.checked}))}),"Dismiss stale approvals"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!P.block_on_rejected_reviews,onChange:t=>D(a=>({...a,block_on_rejected_reviews:t.target.checked}))}),"Block on rejected reviews"]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!P.block_on_outdated_branch,onChange:t=>D(a=>({...a,block_on_outdated_branch:t.target.checked}))}),"Block on outdated branch"]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!P.enable_force_push,onChange:t=>D(a=>({...a,enable_force_push:t.target.checked}))}),"Allow force push"]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!P.require_signed_commits,onChange:t=>D(a=>({...a,require_signed_commits:t.target.checked}))}),"Require signed commits"]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-foreground",children:[e.jsx("input",{type:"checkbox",checked:!!P.block_on_official_review_requests,onChange:t=>D(a=>({...a,block_on_official_review_requests:t.target.checked}))}),"Block on official review requests"]})]}),Ks&&e.jsx("div",{className:"rounded border border-obsidian-danger/30 bg-obsidian-danger/10 px-2 py-1.5 text-[11px] text-obsidian-danger",children:Ks}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-1",children:[e.jsx("button",{onClick:()=>{if(!r)return;const[t,a]=r.full_name.split("/");$e(t,a,r.default_branch||"main")},disabled:Ge||Je,className:"px-3 py-1.5 rounded-md text-[11px] border border-white/10 text-obsidian-muted hover:text-foreground hover:bg-white/[0.04] disabled:opacity-50",children:"Reload"}),Vs&&e.jsx("button",{onClick:uo,disabled:Ge||Je,className:"px-3 py-1.5 rounded-md text-[11px] border border-obsidian-danger/30 bg-obsidian-danger/10 text-obsidian-danger hover:bg-obsidian-danger/20 disabled:opacity-50",children:"Delete Rule"}),e.jsxs("button",{onClick:mo,disabled:Ge||Je,className:"px-3 py-1.5 rounded-md text-[11px] border border-obsidian-info/30 bg-obsidian-info/20 text-obsidian-info hover:bg-obsidian-info/30 disabled:opacity-50 inline-flex items-center gap-1.5",children:[Je&&e.jsx(C,{className:"w-3.5 h-3.5 animate-spin"}),"Save Rules"]})]})]}),e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[12px] text-foreground font-medium mb-1",children:"PR Conflict Handling"}),e.jsx("div",{className:"text-[11px] text-obsidian-muted",children:'PR detayında merge conflict olursa "Update Branch (rebase/merge)" aksiyonları aktif.'})]})]})]}):e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"px-4 py-3 border-b border-white/5 bg-black/20 backdrop-blur-md",children:e.jsxs("div",{className:"text-[12px] font-semibold text-foreground flex items-center gap-2",children:[e.jsx(Za,{className:"w-4 h-4 text-obsidian-info"}),"Repository Insights"]})}),e.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted mb-1",children:"COMMITS (LOADED)"}),e.jsx("div",{className:"text-[20px] font-semibold text-foreground",children:M.length})]}),e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted mb-1",children:"OPEN PRs"}),e.jsx("div",{className:"text-[20px] font-semibold text-foreground",children:Ue.filter(t=>t.state==="open"&&!t.merged).length})]}),e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 p-4",children:[e.jsx("div",{className:"text-[10px] text-obsidian-muted mb-1",children:"OPEN ISSUES"}),e.jsx("div",{className:"text-[20px] font-semibold text-foreground",children:ye.filter(t=>t.state==="open").length})]})]})]})})]}):e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center gap-4 text-obsidian-muted",children:x==="offline"?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(X,{className:"w-12 h-12 opacity-40",style:{color:"#a78bfa"}}),e.jsx("p",{className:"text-[13px] text-obsidian-muted",children:"Gitea is not running"}),e.jsx("code",{className:"text-[10px] text-obsidian-danger font-mono bg-obsidian-panel rounded px-3 py-1.5 transition-all active:scale-95",children:"docker compose up -d gitea"}),e.jsx("button",{onClick:()=>{Ye(),Ze()},className:"px-4 py-1.5 bg-obsidian-danger/15 text-obsidian-danger rounded text-[11px] font-medium hover:bg-obsidian-danger/25 transition-all active:scale-95",children:"Retry"})]}):_?e.jsx(C,{className:"w-6 h-6 text-obsidian-danger animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-12 h-12 opacity-20"}),e.jsx("p",{className:"text-[14px] text-obsidian-muted font-medium",children:"Select a repository"}),e.jsx("p",{className:"text-[11px] max-w-[280px] text-center leading-relaxed",children:"Choose a repository from the sidebar to browse files, view commits, manage branches, and track CI/CD runs."})]})})})]})]}),me&&e.jsx("div",{className:"absolute inset-0 z-[120] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-xl border border-white/10 bg-[#101114] shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-white/10",children:[e.jsx("div",{className:"text-[13px] font-semibold text-foreground",children:"Delete branch?"}),e.jsxs("div",{className:"text-[11px] text-obsidian-muted mt-1",children:["Branch ",e.jsx("span",{className:"font-mono text-foreground",children:me})," kalici olarak silinecek."]})]}),e.jsxs("div",{className:"px-4 py-3 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>zt(null),disabled:Wt===me,className:"px-3 py-1.5 rounded-md text-[11px] border border-white/10 text-obsidian-muted hover:text-foreground hover:bg-white/[0.04] disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{onClick:async()=>{const t=me;zt(null),t&&await Xn(t)},disabled:Wt===me,className:"px-3 py-1.5 rounded-md text-[11px] border border-obsidian-danger/40 bg-obsidian-danger/20 text-obsidian-danger hover:bg-obsidian-danger/30 disabled:opacity-50 inline-flex items-center gap-1.5",children:[Wt===me&&e.jsx(C,{className:"w-3 h-3 animate-spin"}),"Delete Branch"]})]})]})}),Z&&e.jsx("div",{className:"absolute inset-0 z-[125] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-lg rounded-xl border border-white/10 bg-[#101114] shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-white/10",children:e.jsx("div",{className:"text-[13px] font-semibold text-foreground",children:Z.title})}),e.jsx("div",{className:"p-4",children:e.jsx("textarea",{value:la,onChange:t=>Ce(t.target.value),placeholder:Z.placeholder,className:"w-full h-36 bg-black/30 border border-white/10 rounded px-3 py-2 text-[11px] text-foreground outline-none resize-none"})}),e.jsxs("div",{className:"px-4 py-3 border-t border-white/10 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>{Qe(null),Ce("")},className:"px-3 py-1.5 rounded-md text-[11px] border border-white/10 text-obsidian-muted hover:text-foreground hover:bg-white/[0.04]",children:"Cancel"}),e.jsx("button",{onClick:xo,className:"px-3 py-1.5 rounded-md text-[11px] border border-obsidian-info/30 bg-obsidian-info/20 text-obsidian-info hover:bg-obsidian-info/30",children:"Submit Review"})]})]})}),I&&e.jsx("div",{className:"absolute right-4 bottom-4 z-[130] max-w-md",children:e.jsxs("div",{className:v("flex items-start gap-2 rounded-lg border px-3 py-2 shadow-2xl backdrop-blur-md",I.tone==="success"&&"border-obsidian-success/40 bg-obsidian-success/15 text-obsidian-success",I.tone==="error"&&"border-obsidian-danger/40 bg-obsidian-danger/15 text-obsidian-danger",I.tone==="info"&&"border-obsidian-info/40 bg-obsidian-info/15 text-obsidian-info"),children:[I.tone==="success"?e.jsx(dt,{className:"w-4 h-4 mt-0.5 shrink-0"}):I.tone==="error"?e.jsx(fe,{className:"w-4 h-4 mt-0.5 shrink-0"}):e.jsx(fe,{className:"w-4 h-4 mt-0.5 shrink-0"}),e.jsx("div",{className:"text-[11px] leading-5",children:I.message}),e.jsx("button",{onClick:()=>A(null),className:"ml-1 text-current/80 hover:text-current","aria-label":"Dismiss notification",children:e.jsx(rn,{className:"w-3.5 h-3.5"})})]})})]})}export{mi as default};
