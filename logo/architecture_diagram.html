<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airflow Agentic AI â€” Architecture v4.2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #050505;
            color: #e4e4e7;
            overflow: hidden;
            margin: 0;
            padding: 0;
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        .font-display {
            font-family: 'Inter', sans-serif;
        }

        /* Grid Pattern */
        .circuit-grid {
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        .radial-glow {
            background: radial-gradient(circle at 50% 0%, rgba(255, 255, 255, 0.03), transparent 70%);
        }

        /* SVG Node Styles - Dark Mode */
        .node-rect {
            fill: #0A0A0A;
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 1;
            transition: all 0.3s ease;
        }

        /* Specific override for sub-zone backgrounds to be subtle */
        .subzone-rect {
            transition: all 0.3s ease;
        }

        .node-group {
            cursor: pointer;
            transition: all 0.5s ease;
        }

        /* Active/Hover State handled via JS for color injection */
        .node-group.active .node-rect {
            stroke-width: 2;
        }

        .node-group.dimmed {
            opacity: 0.2;
            filter: blur(1px);
        }

        .node-title {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            font-size: 14px;
            fill: #ffffff;
            text-anchor: middle;
            pointer-events: none;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
        }

        .node-badge-rect {
            fill: rgba(255, 255, 255, 0.03);
            stroke: rgba(255, 255, 255, 0.08);
            stroke-width: 1;
        }

        .node-badge-text {
            font-family: 'JetBrains Mono', monospace;
            font-size: 9px;
            fill: rgba(255, 255, 255, 0.5);
            text-anchor: middle;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            pointer-events: none;
            font-weight: 600;
        }

        /* Zone Styles */
        .zone-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            text-anchor: middle;
            letter-spacing: 0.15em;
            font-weight: 800;
            text-transform: uppercase;
            fill: rgba(255, 255, 255, 0.4);
        }

        .zone-rect {
            fill: rgba(255, 255, 255, 0.01);
            stroke: rgba(255, 255, 255, 0.05);
            stroke-width: 1;
            stroke-dasharray: 4 4;
            rx: 16;
        }

        /* Connection Styles */
        .connection {
            fill: none;
            stroke: rgba(255, 255, 255, 0.6);
            stroke-width: 1.5;
            transition: stroke 0.3s, opacity 0.3s, stroke-width 0.3s;
        }

        .connection-dash {
            stroke-dasharray: 4 4;
        }

        .connection.active {
            stroke-width: 2;
            filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.5));
        }

        .connection.dimmed {
            opacity: 0.1;
        }

        .connection-trino {
            stroke: #ec4899;
            stroke-width: 2;
            stroke-dasharray: 6 6;
            opacity: 0.6;
            fill: none;
            animation: dash 30s linear infinite;
        }

        /* Tooltip */
        #tooltip {
            position: fixed;
            z-index: 100;
            width: 320px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 24px;
            pointer-events: none;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
            opacity: 0;
            transition: opacity 0.2s, transform 0.2s;
            border-radius: 0;
            /* Angular */
            transform: translateY(10px) scale(0.95);
        }

        #tooltip.visible {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .chart-title {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            font-size: 24px;
            fill: #ffffff;
            letter-spacing: -0.02em;
        }

        .chart-subtitle {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            fill: rgba(255, 255, 255, 0.4);
            font-weight: 700;
        }
    </style>
</head>

<body class="flex items-center justify-center min-h-screen relative" style="background-color: #050505;">

    <div
        class="relative w-full max-w-[1700px] aspect-[16/9] bg-[#050505] border border-white/10 shadow-2xl overflow-hidden rounded-none group/container">

        <!-- Backgrounds -->
        <div class="absolute inset-0 radial-glow pointer-events-none"></div>
        <div class="absolute inset-0 circuit-grid pointer-events-none opacity-20"></div>

        <!-- Header -->
        <div class="absolute top-8 left-12 z-20 pointer-events-none">
            <!-- (SVG Header used instead below) -->
        </div>

        <svg viewBox="0 0 1600 900" class="w-full h-full relative z-10" id="main-svg">
            <defs>
                <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="rgba(255, 255, 255, 0.6)" />
                </marker>
                <!-- Active Arrow (Generic) -->
                <marker id="arrow-active" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#e4e4e7" />
                </marker>

                <!-- Filter to force White Color (for Black logos) -->
                <filter id="force-white" color-interpolation-filters="sRGB">
                    <feColorMatrix type="matrix" values="0 0 0 0 1
                                       0 0 0 0 1
                                       0 0 0 0 1
                                       0 0 0 1 0" />
                </filter>

                <!-- MCP Icon removed -->

            </defs>

            <!-- Header -->
            <g transform="translate(50, 40)">
                <text x="0" y="40" class="chart-title">Airflow Agentic Platform</text>
                <text x="5" y="65" class="chart-subtitle" style="letter-spacing: 0.2em;">AUTONOMOUS DATA ENGINEERING
                </text>
            </g>

            <!-- ================================================ -->
            <!-- ZONES -->
            <!-- ================================================ -->

            <!-- Docker Context (Matched to Grid) -->
            <rect x="20" y="90" width="1560" height="790" fill="none" stroke="rgba(59, 130, 246, 0.3)" stroke-width="1"
                stroke-dasharray="8 8" rx="0" opacity="0.4" />

            <!-- Docker Logo (Top Right) -->
            <image href="docker-mark-blue.png" x="1520" y="100" width="40" height="40" opacity="0.8" />

            <text x="800" y="70" class="zone-label"
                style="fill: #3b82f6; font-weight: 700; opacity: 1; stroke: none;">LOCAL
                DOCKER ENVIRONMENT</text>

            <!-- 1. Agentic Control Plane (Top Left) -->
            <rect x="50" y="110" width="850" height="220" class="zone-rect" rx="0" />
            <text x="475" y="95" class="zone-label" style="opacity: 0.7;">AGENTIC INTELLIGENCE</text>

            <!-- 2. Orchestration (Top Right) -->
            <rect x="950" y="110" width="600" height="220" class="zone-rect" rx="0" />
            <text x="1250" y="95" class="zone-label" style="opacity: 0.7;">ORCHESTRATION</text>

            <!-- 3. ICEBERG DATA LAKEHOUSE (Consolidated Middle) -->
            <!-- Outer Boundary -->
            <rect x="300" y="380" width="1050" height="300" class="zone-rect" rx="0"
                style="fill: rgba(59, 130, 246, 0.02); stroke: rgba(59, 130, 246, 0.2);" />

            <text x="825" y="365" class="node-title"
                style="fill: #3b82f6; font-size: 14px; font-weight: 800; text-transform: uppercase; letter-spacing: 2px;">ICEBERG
                DATA LAKEHOUSE</text>

            <!-- INNER ARCHITECTURE: Metadata vs Data Separation -->

            <!-- Metadata Layer (Top Half of Lakehouse) -->
            <rect x="320" y="400" width="1010" height="120" rx="0"
                style="fill: rgba(59, 130, 246, 0.03); stroke: rgba(59, 130, 246, 0.1); stroke-dasharray: 4 4;" />
            <text x="340" y="420" class="zone-label" style="text-anchor: start; font-size: 9px; fill: #60a5fa;">METADATA
                LAYER (JSON/AVRO)</text>

            <!-- Data Layer (Bottom Half of Lakehouse) -->
            <rect x="320" y="530" width="1010" height="130" rx="0"
                style="fill: rgba(59, 130, 246, 0.03); stroke: rgba(59, 130, 246, 0.1); stroke-dasharray: 4 4;" />
            <text x="340" y="650" class="zone-label" style="text-anchor: start; font-size: 9px; fill: #60a5fa;">DATA
                LAYER (PARQUET)</text>

            <!-- Branding -->
            <image href="MinIO-Logo-Black.png" x="330" y="350" width="100" height="30" opacity="1"
                filter="url(#force-white)" />
            <image href="iceberg-logo-icon.png" x="1280" y="350" width="40" height="40" opacity="0.9" />


            <!-- NODES INSIDE LAYERS -->

            <!-- Bronze (Raw) -->
            <!-- Metadata Part -->
            <rect x="350" y="430" width="280" height="80" rx="0" class="subzone-rect"
                style="fill: rgba(249, 115, 22, 0.1); stroke: rgba(249, 115, 22, 0.3);" />
            <text x="490" y="460" class="node-title" style="font-size: 12px;">Bronze Metadata</text>
            <text x="490" y="480" class="node-badge-text" style="fill: #ea580c;">SNAPSHOTS</text>

            <!-- Data Part -->
            <rect x="350" y="550" width="280" height="90" rx="0" class="subzone-rect"
                style="fill: rgba(249, 115, 22, 0.05); stroke: rgba(249, 115, 22, 0.2);" />
            <text x="490" y="580" class="node-title" style="font-size: 12px;">Bronze Files</text>
            <text x="490" y="600" class="node-badge-text" style="fill: #ea580c;">PARQUET</text>

            <!-- Link Metadata to Data -->
            <path d="M 490 510 L 490 550" class="connection connection-dash" marker-end="url(#arrow)"
                style="opacity: 0.5" />


            <!-- Silver (Clean) -->
            <!-- Metadata Part -->
            <rect x="685" y="430" width="280" height="80" rx="0" class="subzone-rect"
                style="fill: rgba(148, 163, 184, 0.1); stroke: rgba(148, 163, 184, 0.3);" />
            <text x="825" y="460" class="node-title" style="font-size: 12px;">Silver Metadata</text>
            <text x="825" y="480" class="node-badge-text" style="fill: #94a3b8;">SCHEMAS</text>

            <!-- Data Part -->
            <rect x="685" y="550" width="280" height="90" rx="0" class="subzone-rect"
                style="fill: rgba(148, 163, 184, 0.05); stroke: rgba(148, 163, 184, 0.2);" />
            <text x="825" y="580" class="node-title" style="font-size: 12px;">Silver Files</text>
            <text x="825" y="600" class="node-badge-text" style="fill: #94a3b8;">PARQUET</text>

            <!-- Link Metadata to Data -->
            <path d="M 825 510 L 825 550" class="connection connection-dash" marker-end="url(#arrow)"
                style="opacity: 0.5" />


            <!-- Gold (Business) -->
            <!-- Metadata Part -->
            <rect x="1020" y="430" width="280" height="80" rx="0" class="subzone-rect"
                style="fill: rgba(234, 179, 8, 0.1); stroke: rgba(234, 179, 8, 0.3);" />
            <text x="1160" y="460" class="node-title" style="font-size: 12px;">Gold Metadata</text>
            <text x="1160" y="480" class="node-badge-text" style="fill: #eab308;">AGGREGATES</text>

            <!-- Data Part -->
            <rect x="1020" y="550" width="280" height="90" rx="0" class="subzone-rect"
                style="fill: rgba(234, 179, 8, 0.05); stroke: rgba(234, 179, 8, 0.2);" />
            <text x="1160" y="580" class="node-title" style="font-size: 12px;">Gold Files</text>
            <text x="1160" y="600" class="node-badge-text" style="fill: #eab308;">PARQUET</text>

            <!-- Link Metadata to Data -->
            <path d="M 1160 510 L 1160 550" class="connection connection-dash" marker-end="url(#arrow)"
                style="opacity: 0.5" />


            <!-- 4. Observability & Serving (Bottom) -->
            <rect x="50" y="720" width="1500" height="140" class="zone-rect" rx="0" />
            <text x="800" y="890" class="zone-label">OBSERVABILITY & SERVING LAYERS</text>


            <!-- ================================================ -->
            <!-- NODES (Rects Changed to rx=0 for Angular Look) -->
            <!-- ================================================ -->

            <!-- --- CONTROL PLANE --- -->

            <!-- Chat UI -->
            <g id="node-chat" class="node-group" transform="translate(100, 170)" data-color="#3b82f6"
                data-title="Chat Interface" data-tech="React/Next.js"
                data-desc="Natural language interface for pipeline control.">
                <rect width="180" height="100" class="node-rect" rx="0" />
                <!-- Icon removed -->

                <text x="90" y="60" class="node-title">Chat UI</text>
                <rect x="40" y="70" width="100" height="16" class="node-badge-rect" rx="0" />
                <text x="90" y="82" class="node-badge-text">INTERFACE</text>
            </g>

            <!-- AI Agent -->
            <g id="node-agent" class="node-group" transform="translate(380, 170)" data-color="#8b5cf6"
                data-title="AI Agent" data-tech="ReAct Loop" data-desc="Planning and reasoning engine.">
                <rect width="180" height="100" class="node-rect" rx="0" />
                <!-- Icon removed -->

                <text x="90" y="60" class="node-title">AI Agent</text>
                <rect x="40" y="70" width="100" height="16" class="node-badge-rect" rx="0" />
                <text x="90" y="82" class="node-badge-text">PLANNER</text>
            </g>

            <!-- MCP Server -->
            <g id="node-mcp" class="node-group" transform="translate(660, 170)" data-color="#10b981"
                data-title="MCP Server" data-tech="FastMCP" data-desc="Tool execution layer.">
                <rect width="180" height="100" class="node-rect" rx="0" />
                <svg x="70" y="15" width="40" height="40" viewBox="0 0 24 24" fill="#ffffff">
                    <path
                        d="M15.688 2.343a2.588 2.588 0 00-3.61 0l-9.626 9.44a.863.863 0 01-1.203 0 .823.823 0 010-1.18l9.626-9.44a4.313 4.313 0 016.016 0 4.116 4.116 0 011.204 3.54 4.3 4.3 0 013.609 1.18l.05.05a4.115 4.115 0 010 5.9l-8.706 8.537a.274.274 0 000 .393l1.788 1.754a.823.823 0 010 1.18.863.863 0 01-1.203 0l-1.788-1.753a1.92 1.92 0 010-2.754l8.706-8.538a2.47 2.47 0 000-3.54l-.05-.049a2.588 2.588 0 00-3.607-.003l-7.172 7.034-.002.002-.098.097a.863.863 0 01-1.204 0 .823.823 0 010-1.18l7.273-7.133a2.47 2.47 0 00-.003-3.537z">
                    </path>
                    <path
                        d="M14.485 4.703a.823.823 0 000-1.18.863.863 0 00-1.204 0l-7.119 6.982a4.115 4.115 0 000 5.9 4.314 4.314 0 006.016 0l7.12-6.982a.823.823 0 000-1.18.863.863 0 00-1.204 0l-7.119 6.982a2.588 2.588 0 01-3.61 0 2.47 2.47 0 010-3.54l7.12-6.982z">
                    </path>
                </svg>

                <text x="90" y="60" class="node-title">MCP Server</text>
                <rect x="40" y="70" width="100" height="16" class="node-badge-rect" rx="0" />
                <text x="90" y="82" class="node-badge-text">TOOL HOST</text>
            </g>

            <!-- --- ORCHESTRATION --- -->

            <!-- Airflow -->
            <g id="node-airflow" class="node-group" transform="translate(1000, 170)" data-color="#f59e0b"
                data-title="Airflow 3.1" data-tech="DAGs" data-desc="Workflow orchestration and scheduling.">
                <rect width="200" height="100" class="node-rect" rx="0" />
                <image href="Apache Airflow.png" x="80" y="13" width="40" height="40" />
                <text x="100" y="60" class="node-title">Airflow 3.0</text>
                <rect x="50" y="70" width="100" height="16" class="node-badge-rect" rx="0" />
                <text x="100" y="82" class="node-badge-text">SCHEDULER</text>
            </g>

            <!-- YAML Config -->
            <g id="node-yaml" class="node-group" transform="translate(1250, 170)" data-color="#f97316"
                data-title="Configuration" data-tech="YAML/Git" data-desc="Declarative pipeline definitions.">
                <rect width="180" height="100" class="node-rect" rx="0" />
                <!-- Icon removed -->

                <text x="90" y="60" class="node-title">Pipelines.yml</text>
                <rect x="40" y="70" width="100" height="16" class="node-badge-rect" rx="0" />
                <text x="90" y="82" class="node-badge-text">CONFIG CODE</text>
            </g>


            <!-- --- DATA PIPELINE NOEDS (Inside Iceberg) --- -->

            <!-- High Level Sources (Left of Lakehouse) -->
            <g id="node-sources" class="node-group" transform="translate(60, 480)" data-color="#64748b"
                data-title="High Level Sources" data-tech="Varied" data-desc="Databases, APIs, Files.">
                <rect width="180" height="100" class="node-rect" rx="0" />
                <svg x="76" y="18" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#64748b"
                    stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                    <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path>
                    <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
                </svg>
                <text x="90" y="60" class="node-title">Sources</text>
                <rect x="40" y="70" width="100" height="16" class="node-badge-rect" rx="0" />
                <text x="90" y="82" class="node-badge-text">INGESTION</text>
            </g>

            <!-- Bronze/Silver/Gold Nodes are now VISUALLY INSIDE the Layers defined above -->
            <!-- We just need logical hit areas for the mouse, but visually they are the subzone-rects above -->
            <!-- To keep the hover effect working, we will place transparent 'node-group' rects over the visual areas -->

            <g id="node-bronze" class="node-group" transform="translate(350, 430)" data-color="#ea580c"
                data-title="Bronze Layer" data-tech="Spark/Parquet"
                data-desc="Raw data ingestion. Metadata snapshot created.">
                <rect width="280" height="210" class="node-rect" rx="0" style="opacity: 0; fill: white" />
                <!-- Invisible hit area covering both metadata and data visually -->
            </g>

            <g id="node-silver" class="node-group" transform="translate(685, 430)" data-color="#94a3b8"
                data-title="Silver Layer" data-tech="Iceberg/Spark"
                data-desc="Cleaned data. Schema evolution and partition management in metadata.">
                <rect width="280" height="210" class="node-rect" rx="0" style="opacity: 0; fill: white" />
            </g>

            <g id="node-gold" class="node-group" transform="translate(1020, 430)" data-color="#ca8a04"
                data-title="Gold Layer" data-tech="Iceberg/Trino"
                data-desc="Aggregated business logic. Queryable via Trino.">
                <rect width="280" height="210" class="node-rect" rx="0" style="opacity: 0; fill: white" />
            </g>


            <!-- --- OBSERVABILITY & SERVING (Bottom) --- -->
            <g id="node-marquez" class="node-group" transform="translate(250, 740)" data-color="#64748b"
                data-title="Marquez" data-tech="OpenLineage" data-desc="Data lineage server.">
                <rect width="200" height="100" class="node-rect" rx="0" />
                <image href="marquez-lineage.png" x="80" y="13" width="40" height="40" filter="url(#force-white)" />
                <text x="100" y="60" class="node-title">Marquez</text>
                <rect x="50" y="70" width="100" height="16" class="node-badge-rect" rx="0" />
                <text x="100" y="82" class="node-badge-text">LINEAGE</text>
            </g>

            <g id="node-pg" class="node-group" transform="translate(680, 740)" data-color="#8b5cf6"
                data-title="Postgres AI" data-tech="Vector Store" data-desc="Agent memory and audit logs.">
                <rect width="200" height="100" class="node-rect" rx="0" />
                <image href="Postgresql_elephant.png" x="80" y="13" width="40" height="40" />
                <text x="100" y="60" class="node-title">Postgres (AI)</text>
                <rect x="50" y="70" width="100" height="16" class="node-badge-rect" rx="0" />
                <text x="100" y="82" class="node-badge-text">MEMORY</text>
            </g>

            <!-- Trino Node (New Serving Layer) -->
            <g id="node-trino" class="node-group" transform="translate(1120, 740)" data-color="#ec4899"
                data-title="Trino" data-tech="SQL Engine" data-desc="Interactive SQL Analytics.">
                <rect width="250" height="110" class="node-rect" rx="0"
                    style="stroke-width: 2px; stroke: rgba(236, 72, 153, 0.5);" />
                <image href="Trino-logo-w-bk.svg.png" x="105" y="13" width="40" height="40" />
                <text x="125" y="65" class="node-title" style="font-size: 16px;">Trino SQL</text>
                <rect x="75" y="78" width="100" height="16" class="node-badge-rect" rx="0"
                    style="fill: rgba(236, 72, 153, 0.2); stroke: rgba(236, 72, 153, 0.5);" />
                <text x="125" y="89" class="node-badge-text" style="fill: #ec4899; font-weight: 800;">SERVING
                    LAYER</text>
            </g>


            <!-- ================================================ -->
            <!-- ROUTES -->
            <!-- ================================================ -->

            <!-- Chat -> Agent -->
            <path id="link-chat-agent" d="M 280 220 L 380 220" class="connection" marker-end="url(#arrow)" />

            <!-- Agent -> MCP -->
            <path id="link-agent-mcp" d="M 560 220 L 660 220" class="connection" marker-end="url(#arrow)" />

            <!-- MCP -> Airflow -->
            <path id="link-mcp-airflow" d="M 840 220 L 1000 220" class="connection" marker-end="url(#arrow)" />

            <!-- MCP -> Config -->
            <path id="link-mcp-config" d="M 840 220 L 895 220 L 895 130 L 1340 130 L 1340 170"
                class="connection connection-dash" marker-end="url(#arrow)" />

            <!-- Airflow -> Iceberg Center (Updated Trigger) -->
            <!-- x=1100 (Airflow center) to x=825 (Lakehouse center) y=380 (top of Lakehouse) -->
            <path id="link-airflow-trigger" d="M 1100 270 L 1100 340 L 825 340 L 825 380"
                class="connection connection-dash" marker-end="url(#arrow)" />

            <!-- Sources -> Bronze -->
            <path id="link-ingest" d="M 240 530 L 390 530" class="connection" marker-end="url(#arrow)" />

            <!-- Bronze -> Silver -->
            <path id="link-transform-silver" d="M 570 520 L 735 520" class="connection" marker-end="url(#arrow)" />

            <!-- Silver -> Gold -->
            <path id="link-transform-gold" d="M 915 520 L 1080 520" class="connection" marker-end="url(#arrow)" />

            <!-- Trino serving link: Silver/Gold -> Trino -->
            <!-- Link from Gold (existing) -->
            <path id="link-trino-query-gold" d="M 1220 740 L 1220 570" class="connection-trino" />

            <!-- Link from Silver (new - Professional Routing) -->
            <!-- Route through the channel between Data Layer (bottom y=660) and Observability (top y=720) -->
            <!-- Path: Silver(825,620) -> Down(690) -> Right(1180) -> Down(740) -->
            <path id="link-trino-query-silver" d="M 825 620 L 825 690 L 1180 690 L 1180 740" class="connection-trino" />


            <!-- Observability Lines (Telemetry Bus Layout) -->
            <!-- Horizontal Bus -->
            <path id="bus-horiz" d="M 350 660 L 1170 660" class="connection connection-dash connection-dimmed" />

            <!-- Drops from Layers to Bus -->
            <path id="bus-drop-bronze" d="M 480 570 L 480 660" class="connection connection-dash connection-dimmed" />
            <!-- Bronze -->
            <path id="bus-drop-silver" d="M 825 570 L 825 660" class="connection connection-dash connection-dimmed" />
            <!-- Silver -->
            <path id="bus-drop-gold" d="M 1170 570 L 1170 660" class="connection connection-dash connection-dimmed" />
            <!-- Gold -->

            <!-- Drop from Bus to Marquez (Center of Marquez is x=350) -->
            <path id="bus-drop-marquez" d="M 350 660 L 350 740" class="connection connection-dash connection-dimmed"
                marker-end="url(#arrow)" />

            <!-- Memory Link (Cleaner) -->
            <!-- Rerouted to avoid Bronze layer overlap: Left side gutter -->
            <path id="link-memory" d="M 470 270 L 470 320 L 280 320 L 280 700 L 780 700 L 780 740"
                class="connection connection-dash connection-dimmed" />

            <!-- Docker Logo (Moved to Top Right) -->
            <!-- Logo removed -->


        </svg>

    </div>

    <div id="tooltip">
        <div class="flex items-center gap-3 mb-4 border-b border-white/10 pb-4">
            <div id="tt-color" class="w-2 h-2 rounded-none bg-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.5)]"></div>
            <h3 id="tt-title" class="text-lg font-bold text-white font-display tracking-tight">Title</h3>
        </div>
        <p id="tt-desc" class="text-white/60 text-sm mb-6 leading-relaxed font-light">Description.</p>
        <div class="flex justify-between items-center">
            <span class="text-[10px] text-white/30 uppercase tracking-widest font-bold">Technology</span>
            <span id="tt-tech"
                class="text-xs bg-white/5 text-white/80 px-3 py-1.5 rounded-none font-mono border border-white/10">Tech</span>
        </div>
    </div>

    <script>
        const container = document.querySelector('.group\\/container');
        const nodes = document.querySelectorAll('.node-group');
        const connections = document.querySelectorAll('.connection');
        const tooltip = document.getElementById('tooltip');

        const ttTitle = document.getElementById('tt-title');
        const ttDesc = document.getElementById('tt-desc');
        const ttTech = document.getElementById('tt-tech');
        const ttColor = document.getElementById('tt-color');

        // Logic Dependencies
        const dependencies = {
            'node-chat': ['link-chat-agent', 'node-agent'],
            'node-agent': ['link-chat-agent', 'link-agent-mcp', 'link-memory', 'node-chat', 'node-mcp', 'node-pg'],
            'node-mcp': ['link-agent-mcp', 'link-mcp-airflow', 'link-mcp-config', 'node-agent', 'node-airflow', 'node-yaml'],
            'node-airflow': ['link-mcp-airflow', 'link-airflow-trigger', 'node-mcp', 'node-bronze', 'node-silver', 'node-gold'],
            'node-yaml': ['link-mcp-config', 'node-mcp'],
            'node-sources': ['link-ingest', 'node-bronze'],
            'node-bronze': ['link-ingest', 'link-transform-silver', 'bus-drop-bronze', 'node-sources', 'node-silver'],
            'node-silver': ['link-transform-silver', 'link-transform-gold', 'bus-drop-silver', 'node-bronze', 'node-gold', 'link-trino-query-silver'],
            'node-gold': ['link-transform-gold', 'bus-drop-gold', 'node-silver', 'link-trino-query-gold'],
            'node-marquez': ['bus-drop-marquez', 'bus-horiz', 'bus-drop-bronze', 'bus-drop-silver', 'bus-drop-gold', 'node-bronze', 'node-silver', 'node-gold'],
            'node-pg': ['link-memory', 'node-agent'],
            'node-trino': ['link-trino-query-silver', 'link-trino-query-gold', 'node-silver', 'node-gold']
        };


        document.addEventListener('mousemove', (e) => {
            if (tooltip.classList.contains('visible')) {
                // Fixed pos
                tooltip.style.left = (e.clientX + 20) + 'px';
                tooltip.style.top = (e.clientY + 20) + 'px';
            }
        });

        nodes.forEach(node => {
            node.addEventListener('mouseenter', () => {
                const id = node.id;
                const color = node.dataset.color || '#ffffff';

                // Tooltip
                ttTitle.innerText = node.dataset.title;
                ttDesc.innerText = node.dataset.desc;
                ttTech.innerText = node.dataset.tech;

                ttColor.style.backgroundColor = color;
                ttColor.style.boxShadow = `0 0 10px ${color}`;
                tooltip.classList.add('visible');

                // Highlight Node
                node.classList.add('active');
                node.querySelector('.node-rect').style.stroke = color;
                node.querySelector('.node-rect').style.filter = `drop-shadow(0 0 15px ${color}40)`;

                // Highlight Dependencies
                const relevant = dependencies[id] || [];

                // Dim others
                nodes.forEach(n => {
                    if (n !== node && !relevant.includes(n.id)) {
                        n.classList.add('dimmed');
                    }
                });

                connections.forEach(conn => {
                    if (relevant.includes(conn.id)) {
                        conn.classList.add('active');
                        conn.style.stroke = color;
                        conn.style.filter = `drop-shadow(0 0 5px ${color})`;
                    } else {
                        conn.classList.add('dimmed');
                    }
                });
            });

            node.addEventListener('mouseleave', () => {
                tooltip.classList.remove('visible');

                // Reset
                nodes.forEach(n => {
                    n.classList.remove('active');
                    n.classList.remove('dimmed');
                    n.querySelector('.node-rect').style.stroke = 'rgba(255, 255, 255, 0.1)';
                    n.querySelector('.node-rect').style.filter = '';
                });

                connections.forEach(conn => {
                    conn.classList.remove('active');
                    conn.classList.remove('dimmed');
                    conn.style.stroke = '#334155';
                    conn.style.filter = '';
                });
            });
        });
    </script>
</body>

</html>